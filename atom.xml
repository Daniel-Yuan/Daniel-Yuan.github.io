<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">
  <title>Daniel_yuan&#39;s Blog</title>
  
  <subtitle>芙卡米天下第一可爱 n(*≧▽≦*)n</subtitle>
  <link href="http://example.com/atom.xml" rel="self"/>
  
  <link href="http://example.com/"/>
  <updated>2021-04-22T06:57:03.458Z</updated>
  <id>http://example.com/</id>
  
  <author>
    <name>Daniel_yuan</name>
    
  </author>
  
  <generator uri="https://hexo.io/">Hexo</generator>
  
  <entry>
    <title>HNOI2021 游记</title>
    <link href="http://example.com/2021/04/12/HNOI2021-%E6%B8%B8%E8%AE%B0/"/>
    <id>http://example.com/2021/04/12/HNOI2021-%E6%B8%B8%E8%AE%B0/</id>
    <published>2021-04-12T13:50:19.000Z</published>
    <updated>2021-04-22T06:57:03.458Z</updated>
    
    <content type="html"><![CDATA[<h3 id="前言">前言</h3><a id="more"></a><p>时间总是流逝得很快，这已经是 Daniel_yuan 经历的第三次省选了。</p><p>这也是 Daniel_yuan 所能参加的最后一次省选了。</p><p>从懵懂、激动到沉稳，改变的是心态，不变的是实力。（划掉</p><h3 id="day--inf">Day -INF</h3><p>不知为啥明明活得挺开心的晚上睡眠质量还是不好。</p><p>要么就是睡不着要么就是做一些奇奇怪怪的梦。</p><p>每天早上都睡到考勤前，然后急急忙忙跑到学校。</p><h3 id="day--1">Day -1</h3><p>去某新开发的公园散心。</p><p>因为主路十分崎岖，而选择了一条大公路。结果就围着公园绕了半圈，啥都没看到 :(。</p><p>途中发现了一串楼梯就往上爬，越爬越离谱，到了山顶就变成泥泞小路了<del>（甚至怀疑走到了山顶洞人老家）</del>。</p><p>为了激励士气，教练和班主任一拍即合，决定让我们喊山。</p><p>然而因为大家都觉得谁喊谁尴尬，就没人打算喊。结果被教练教育了一顿（大概是因为教练尴尬 :)）</p><h3 id="day-0">Day 0</h3><p>早上强制要求制定计划，决定复习一波网络流+差分约束（要素察觉</p><p>但实际上效率并不高，算是半颓半学吧。</p><h3 id="day-1">Day 1</h3><p>紧张得 5 点多就醒了，迷迷糊糊睡到了出发时间。</p><p>到了考场，发现下载文件只有 <code>.vimrc</code>，用 <code>emacs</code> 的我在一瞬间有那么小慌，后来猛然发现配置文件就在主目录下……</p><p>T1 的保证 <span class="math inline">\(a_i\)</span> 有序感觉很有问题，直接 rush 线性做法，缝缝补补肝出来个，对上拍就没管了。</p><p>T2 发现一个数的约束只有三个，但是没什么想法，手玩了 <span class="math inline">\(m=2\)</span> 后发现 <span class="math inline">\(n,m\leq 3\)</span> 都不会手玩，只能自闭。</p><p>T3 随手转化一下就有 44 分了，发现是个动态图强连通性，感觉是个不会的模板，只能自闭。</p><p>然后……就这么以 <span class="math inline">\(100+30+44\)</span> 离场了。很是自闭。</p><p>考完之后吃完饭就在机房睡觉，回家之后也是半睡半醒，迷迷糊糊地一天就这么过去了。</p><h3 id="day-2">Day 2</h3><p>在家睡觉果然就是不一样，差点就睡过头了。</p><p>雨下得很大，颇有壮士一去兮不复返之势。</p><p>T1 sb 数据结构，脑抽用 <code>map</code> 存了个东西写了个 <span class="math inline">\(\log^3\)</span> 的做法。</p><p>T2 sb 状压 DP，但是更加 sb 的我写完搜索的部分分之后就死活肝不出来。</p><p>T3 压位暴力似乎显然，然后就直接 rush 了。</p><p>写完感觉很无聊，想也想不动，颓也不敢颓，就开始想下午回家怎么 happy。</p><p>考完自爆 <span class="math inline">\(100+60+75\)</span>。很是自闭。</p><p>下午和小伙伴们胡吃海喝、把酒言欢，紧张而又平淡的 HNOI 就这么结束了。</p><h3 id="day-3">Day 3</h3><p>没测民间数据，也没上你谷，感觉考完之后整个人都置身于 OI 之外了。</p><p>考后在机房整了好几次活。</p><h3 id="day-inf">Day INF</h3><p>成绩出了，<span class="math inline">\(100+30+44+95+60+40\)</span>，很是拉胯，但是靠着 NOIP 的发挥苟进了 A 队。</p><p>Daniel_yuan 的 OI 生涯又被续上了一命（+1s</p><link rel="stylesheet" href="/css/spoiler.css" type="text/css"><script src="/js/spoiler.js" type="text/javascript" async></script>]]></content>
    
    
    <summary type="html">&lt;h3 id=&quot;前言&quot;&gt;前言&lt;/h3&gt;</summary>
    
    
    
    
    <category term="游记" scheme="http://example.com/tags/%E6%B8%B8%E8%AE%B0/"/>
    
  </entry>
  
  <entry>
    <title>trick 合集</title>
    <link href="http://example.com/2021/03/18/trick-%E5%90%88%E9%9B%86/"/>
    <id>http://example.com/2021/03/18/trick-%E5%90%88%E9%9B%86/</id>
    <published>2021-03-18T13:46:48.000Z</published>
    <updated>2021-04-22T02:57:06.571Z</updated>
    
    <content type="html"><![CDATA[<div class="hbe hbe-container" id="hexo-blog-encrypt" data-wpm="你的魔法咒语太弱了。" data-whm="博主的魔法失效了。">  <script id="hbeData" type="hbeData" data-hmacdigest="54e9305394a4030a2ab817c791d744b75c4134bd135e94ef2fb79d0944be2e87">0727ca26dac557ab7adbdc3438587b320df941d073f515bc7e9a849f3c31563021b46d4ee48d91a2c03e7e11e976c4164dd0f89a2b697f256ab4e36783219242ad8c81300718661c59ccd3302159ad17d2fc3aa795817b2dcbd888995d643f1fe2dd21a25c813b0a7f434fd394d6dd8bbbc78b1cc9f50d12a7c52e7eb4a3cee23a63d0885600495aef3ee3a52d0f7f2619bec793acdafcc074ef06a1dad30f24e96f2a36f19c282364a2b7bb09b3899b3b4890ed0dd52a123dfcf4fcf063c20cd44699ddca56eb06bc0302e2a92be3e5d7cb0f01c2f5a0bde916c84ccb21d9ade1ca0887c9f43afb12fd290f659f674bd821c0fcc8e71a65163820711e750b01de672a5c4b7a9529cf3fa664344bea450764c81995f0291c666a3e6a8f5f6fff8fc56642aad75b6136e7ac092215073b50e9e2cfa361b4811ecbdcd8c1d05ed4bfbd3cf26225b618ec8b41d1aef542ffe4b4e81326190518c793122d5f099d2d5520264588bad6f09feb1742f57449ba7a1d1dfa7d923eeec82f06e07ebd2d0c436d8bcbecb7effff58a20864defd9c8288d5d0b499f75d1d0a3a6f32824be87c946164dba1d468f79e437effbfd967a87d635be89485d973089c945036e4a7439cf7cadcb5e9d32ed46642fd1fc904dc301b5a561af8651b4f51783626e60ed614cc3ffa70c5e11ba132feb7bea5bb842c21197ed8f4a87aaebbe859501e25b189e8c0579086528733746d8ab0304d0cecfac96998088a5d5f05ffb03efd081bea01c5396211c373a50af78349820d5425e26ca16ab525787d7981403793bba9d2011869e6bc190e33c966297f4caa665eb954c2c2e07426f836c322e5a0b7558ba30a9dda84ddc4294fd8ec0c2e7e83458b1a070dc3df89c8a5789cce03c757debdceda3f45c2c00248fdff5c0bfcf2f7dd9fc6b638767056ca143f91aa329e78c45198fae3503a6e4ddad9e3551ed7497111af23a4830bee8aacf26845e5f5f06f91a381d1b932aef540a8edf137d46a93b37fcaf2227dd2a6266a161bda422c60e77cbf0f916760d677be288ad509d84c5818ac7d7bee2c7e4d8422a28045f6251b9a2880166207dbd0c11002d6ef2ba71839f1efaef7525fbe5c183b2e9f114678179ebc4b85ec112be083888120ed1b134dc31f37ed978c337abe57f89e83c2d12efce9de543ebfa7fa2837485e9bedfb05c7c6be431539c52ce8a812d6cc09231c3c8e107e92117a5a86917ec141b37a717414050cf28b3d0ef717c5af821d54f0ae35c26cb7f91107dbbe580a20f962f2b763a58e2bf6dd1e235c35479d35a95a36cf75b06ee79eb39852aebb37d1b51fba067647a041b80dcb578d59b6ebcc21498afdb50138900336427cbb19a20bc247702a9e59bba9f5603464fe1a60b5a62741d62b039be5e8b7525ed138f37c06f7c4dbc0fc47e5b312b262872dd077292d0d0839c59e663d1a881f16e9a7f5f4d7648bb49196f607b087597b7b8f77abacfccea4658ccb24eabbc7b17d4a64976888b575065796a3580c6dd527572374bea299c3565162fcd69b43105292d60fc07b029e87c4502b7c60d8d4cbdde214f6ff7e150c1fc271903cd9db56aa5f3b210e1d6ccd2bacaf3a5f0584b32591ebd2a16151a8019042867f29cc5aa7c964ceaa221358d9b9e894d678020bf03df6e8f1600125137b6dd9fdf12fe128b1d2d030aaab0f843b9e31bee181196063d4336b0a063f0523efeadb99d9cc05f6dbe4f162bdcaab8bf2a5728f90748ecff10a1ad2948c7adafe1bfd1999ab12901d10c14d86d9aa357cba0f6e1fd1046836ae407df3261e36d7857cb080810d57f1abdc899e8579fd5da0a0dd191d6e270eb6085ac0032573d5765efb014da19a81d8aaaf619dae06c3c4edce32afc61b3259c2392df87f28d702a1e65609d60430a1ec1ee7c67353d4100f4307abdb714ddb26d1c2fc5e68db230901ff9db90282d243d98bd3f7d08c088d803c3b8ef6c033ead94313eddd96d21dbb558e5abdf0b6919ff78ebe7de131aede91b44a13daaeff30f012196debac66308871e7decbbd347ab4043a05de6aae2b94602aadff566080c51a11796ef46a5ec0ebe3de6421565ea795805009278371d2c101bf990190a2eee10f2964aba960fc98cd83bebbeaefec3bd87d635333d17ddd18c5a2654a7e8fc3e4756c64ca7fb2fee3142cac826752a5abcde168b5baf1fe703ee449fb06ab3ee89635158dc4be6f260828c4448383f82bc318298e56b9debdd7d1532640e420e481008af004b769a290e07db33382a55b42fcb2b4629de5f0a705891b622bea4f8b9ad597507023d9bd6c21360402e1ee4427865b7a34c099190120f3c58edcf7a6ac18032e82c9cfdd2de480755c451f5ff7dd46853f1cb868171cddad433b80935400ffb7575d48d342b9ed5d4fdcfe6da2f380eadf768cf5409230334e49d74d5b6979680316cc7f3733252958ecf37831a0cdaffd390107eab3438e729ee561b57b20d7732488b5ed282ebcb8f3706e7453173831e129635ce90ad68c4b690209128ad69bc0730950086094112de2ab09d605207cea3d8335af9d494c8fd20340793297f09363630509b88191e770b64062a0d030e354ac42dfb68971b44719d23027e415b15300651389fc33470abb16eac165ea409bcb20f57c2d9c053cae41b44b391a8559e6a97b5d92265537e757dd0f37b88f1aff0f6c39de1a694ac229cdf255ccb8a08e29b4eb64fb32ac73ba96c59a9f9b74a6bc16955a4d398ec6562decd82d379f6f48150b78794d563f2bc19b4ae8e27a262f8fce8ca75122e8a4937dff167f58fa3a289268d75ad3e5a03f7d3606755e8990ded259c964c0d72e722167278ecf0c61d9573e978cd739012def3200d3641632f5e0f040f2d9cb3f41e12b6bdfd56cb06d1724e337d0a168cfb721f1e191fb4334df9efe24d3e18bdcfcd784ef9a680ec2f0b0835be38ef6109c1cef0a085eac1ab9fd3fed2253914ddca51e2adf124473adb6393e0fa403b3032dd2276bb0c0d98fd0ef5d2e13d357f5e50df134e6fa817f7fbd551e1842d75bd7686809bc7cb55a70abf365c4f354af30440603dd907318229bed58ec18fa8143a326b8b54dbe1b7da95ce9ae04a20d2e2a5e92c2e9c98afa64fdf80e67d53454051f7255a561bc7f1c25071279a5c7393a3a463b9fe54cd8c414bd2f38d583dc948c57249d2dfe73abec8804856eaaaeef736b2cce0a8e2bcaac16e4feeeb1ff03f60ea4ffc93befabf5da7d5f8839992bad20863a355ebdfbcdfb5bc9a5220fd11e26385febdf3d2952a3af7d72019c7df03238158a242e1e596cc6686c0e99c17df7b3a01944251495b784932de41d1ae240a44c8a0bc1cf38df2bf41838a55aa49e4f092f1340574ecd35aa1ec05a8c80c23315836f1c494e8214dbf156fb92d986a820cb5be620671456ec34ab7ac39a1485c3002c75166bb1254a6e3e0a5fcba62ecafd8635947b8c7836c34b1eb5faffe07983080e101675174a14bf0a690513a58d15d9e9dd8bf88efd004eb2f38806844bf05b3caaffe724592837d59fabf86c202bab63f5079f830178ce555c9ed3c4d4f0473ec31bb26a3e3fec14783c200f12b61f5ad9a116fc35c869798ffee5a6f92ab7fdd5df679a605e742fe677fa3c3a88214b43bcd4a70b3227685ea084a9f82ed7d32256088c58340e9a78cf3a7bd9c8b31dfebc202bbdde70657220bcf32a3b612c948b048efcb66dbebfbcf1f5b5d9db493082cd97ae853403625e27bfa2b1c68969ad5b31a1dac7734cb5f3fa931afaf6a3dcd8895243c53857b5a8a8ef81a36f5f1ce530f51149879d3741092e5ebb082aae1eb5da7637a5683d0c65bf10a1c3549e66874b348c3238b3750bd8ebd30cfd4092fc37ac9ec46f58ebbbf1207c1d971ac7070a50f697bf1564fa6ecc469dd869ac4273b04ded330c686f80ccae11c3a20baabd1901e19bedb0bc5f2fa7c314e9dee12ed42ae33fb4a74df1cf9cf7b7a8c66a6aff03a461d802e701c02439671bc635ca087a3ec7b7ab9c161fd3952e969822f5abb35a9bd4d0521a2a7d31243ad036c6d26cd0ff8574349dbb8d04caa605476c2a5370780d1ddcd0bee5eae9f255d23a3f2f2aab1b9c44fc83b204cd1292e662a2185cd8bc19212fee1e66d8bcba0bbcc01ee5f3f1772af4a1c3389e4f820125fc627532890ce2b2c6c80829d6874f9de09f3d492f52aae671997a08372a1dca0e2b1fe2e1ea9f10619bf35998b9b3edb673757dd0c10be7b06356174cbd9a5f45f947d7b3a5e4fde3c2195910e3ee7abc468e72b4d44196d1e772a0e50f851f946dcf336861b2ad6819302766037adb024f9f548d48126ebcdc7fc63a322c2bc3f2af9547af95385ca504ba60ad5db4f45d6f641fb58851ebe1ef4fdeb3ce8b4bff835bd749b19481c24f77c7ff0cd81086f104b813cba4cb9e5f2c14d5a3044c5c9eb56a0e7096f6bb98a4f381d0c3dc83a00f166337e88b7233b11353968b888f9a08135bd50a3ba1e70dd9b4927b6db120f32815d83a1b451a91059656b0e6f353daf0c0e6af90592cc41962a96ee94b3afe576fdb03841be614b01b7490c994d83d67da78d0d7d32d70ef19023877f7fb661a6b936b8a0f83a56de7cf08f5d389f5f0efbd4578b8d1fde009f95b78ec10cf791e8584014aa80add84e84a9c53a39a6c09f92d792eb35960284ecb6325d501e499aa7e43c7280037d136c5dac0c9fd60c4ec4172343c034c370fec80e5069aef26a795874f48b63f957c5680fe25f0c50bf4e95c1cd95c47d6dc0f4315576ef3e63c4f0aa21551cdfafa459b9d0f5dd09fd7382d3eadd472018ddd55c0dd207fadefa7a3ce9c2d58a409156fbbd6b4095be725b36bd362f1bb8b1a6a91d345d05d256c330ddd56a34d70fd898e42e84127ace51f1e672c667ab97827c235655caae5583e099d1419f9a144e4c84f564a4a1c130293b82730ad7a3baddf1d122b6703f1c88dc756b65585fba2c8c6191f65afdcdd65185bb9df48bc2e47f6846ae855c99e3ac9ad82fcb9a8d06b49efe9299174d6ad413ba16e98197c0be97317f54e31761e4dca0ddfc962c94faf90e82cf0ef08e929c7066be3fd0795bc49a3a152a52a93a2baea68053698d9eb32e7874afa15685832fad4d314fc45e3d4e79d40550bfc28d3a2447e162481d90bc4fdf4e8c4fee1deb8dfbe6bbf8d6f5a308633db400732676e7553affdacc39a232c268f201c840fbb14548ffbd4425109b1febc94851df1504bd7aea15e6179ef4e31cac835759e7322fc8f5294af2045c5113df54aba54ec7a47f365e13286ada7a359e403ffba91c905fef63e210ebd515a6ad0c809a300d170026155772a815e2f8c528f5b885ec7f2af7085ebc2a66547b726c124f850c688001e9bb5f5abff4e443e505328798b2e49f56397f3f6fe033f009de8b97a4cd5b9da7399508f847cc3a00b0a9836e19cf98565c293b4d192c9370fc360c63c3637ead43d2c27b61e1eb32b0dcfee6ebb74a6ca5dd91df669608c64209fdc02e4b8fa2f21f7d9017f092dc3f863cdd4c8ac4b311db1a67210771c49ae000b767a526ebf5e13c8a106850a020299b611566e6baa0ca4678a09e3dcfcf6a85a071cd9e631f0ac648d779e1b46246223d3c2126be1a51b2ffa69c790cbfb5c8f7112df6c88b28fbdf06a83d92b6a31af626bcbf01f297462bf986ed6240604779d758704aa1182e475636fde57093b3957688550bc5c9647b263cdc8e387be4825908a9f0f15c44d104af0e862c4d10cd93c6f1fed79bdc08f2adfa75ab88c28d10f3c68859a24d5bff1d46ffba63209cc5ffcd81bef4d9af19a1d02c4c0a17fe80b06c832b6327a0e2220dca8e86a9ec7eb76ad0cb828d4facf5444dc5b332a7dde9bd040ca43daf0cc3144c54930c6f2e73f55abdd9a6e52b379355e70f4f64420212d4bdc9c1a7af054ec98a7fb09a243d421a4653c89457bca093239af21e4896dc4a09b99cb1c340052edb5a00db5c9987d7a8af9670c881a4d0d938fc628893b95bba5cde8e5942e8c86653437f3dab4c7b6cba5ec266ec77241cd263cf1850d18176ca68059ceb4053dab23d0dec78364405368ff920450a67c144b3f4647bca31bddcc092215ce58d0112ae168f5a363596df5f94c19cdc8de046a86acb0b00bd1c0faa9df6ceb9ae2021b89449bc44bd5d6f85d9772cbd0968310992dc9bf270311d77d435c16a93d21a741244eb86ea8829752c4fd1e33d76b7312b857492c6040525c3f5ddb643402bac4742a0a44f9d747cda44b17dc8ec7f6ce52b32b4e8e21168ef6c1e5bd1a06770715679ad9146f7266e0281b3e09616c24031df8bf542da180f127a5441cbd1df45977e98c759a9c198a0a1161886cfbc0d5df6df42b722e04621828a4584dfe7e98c59bd30ccadc55d154f547cfea318734c40d7e56ab97fd330377f12f8e3848de9c9f84c6e9c3acd6ed6b55b86eaa6f155321bca571edf22dfaf126595ddcfb4a17cd0697aa979ff814524788a3efc48f465586ec419bdf62375c6baddbfaa79feba6d1d7577a53ecbb99e5ccfa495dc4389d66945fc9717e54c1b98180f7908b917d2b8cb2384baec4f3805f55185a5747cadb75be22ac0895b3ec64ad569acc3ebdc25b692fb82430acbebd5aebd566aa82d4d051f7a0de07f187bc8d1c2319e2579f5edc29b8a866eb91de2cb8c7205aab7311f1847859392973f39ef83c986086e713c61bf74d00cdddc08ca0eee6604aae21890b4e9565d2ce586f04896efbafe49d899593e504c394acfff145d8d931a1765661b6c351d9bda7795ddcb191924c7bd8ad04da615edb87613aa27eb92822f3c56516d9060d1bd48917143da81885db88c8ed32d19529e7d2692bb8c96be30d1ff7552dd6a7e835905e38a08972e186134c3c22c6724c59e57021d898cb09a83b50d9964ec721d9c20fec6760b1526bfddd1b79fa7e61ab9386758708bad283c9206191b19ecd499e70bdc2adc0718aaa12c005d5407cc64a2744a5af704db2c52730c75a26a288a63b0caaea9c2a500baabf7945a960a888c48fc19cfbc6a5c737fc9ea6b6a1f6a60b87017f389439f473645f399a0ac4091eb2dbd53e41f80b390d0c737fef2c495d390b500efa6d7c0025f1bf1bc08bd39360324aeeeaf4a365e9fc2cd34735df15431e6fe9c031acb61cf671257c76e714753fa7a77125d5f17a73565732a14d005dcd840321895d103660fd53aba3ae6719fb18dcb97e1809b51eb8f499b76847f1e7d788fce9485fac462b5701b20403ec155a5288eb8350d505737dd5780777a256a71888be4325539cd20c858e30f22fd84c46c24e7863f5275c668801394466b1ffdfaa44607d220c6751f3aff48cc7874bbd5295de13b644d2a1357c04487fc2ed6ba4ee20414a25f8877774fe6e7f0876e775bc2b8299b637fd8f3f9ac5d572ea4e000f13fde610e04bab7efffb3291bc04179e83a309532de3a74655ad40aa49a55c81e070679cf3ff7671a49f48bdfc249509486e79353d19b570888c52b1a93b5affaf701bd59463ccf8f6f593bc453cfec0cae35ec7284e6848ad31ca056e3431a570d294ad42973c5788fff032e7f3fd4b8ce0f1168ed2344a89325db2e0fc805ae589edbec19dea82c41bc943326c7f8b2e494f5ee1c602daaf162dd3c35dd2965298b84bb6bc875cc0135f292bea39d96aac38b63b38639e644008df1525bae76b9fdc720732fe7be84c6c3e0d85e7d0a37475667aca1cbdeb11bd6073c18dd7d270c90d574f52f7faf0cd8fe2c2962b59fcafb23ee9c66bb0ac496faff5f40251a4bf0b00dc6e6ae55b0a68c238db7a09b573c599665c69013624dd2ce72dfcf6cfc575139b87f619b114bbc73fa7c5329c432f5d95978b47eedb4e3ecbedcc29d7adf505e91f1db4fa873df18ef8ef46c6ebf4149c78035797088c66a22fb6b7613f5ca818de5583fcb45879369f4b1fadfd9e40b61c724399628a23142f4469c6c1e26e7ab621d0759a69e35563f6d5ac171e7884ce12dfacaf5afaceac668dc56111bda3c3fc3837f360330215ad5cc700ac6d83fd7ee64b3dbfe390b8446d1cd576afec48c0876ceb8f1b4cda9d812c02f09277b90bb37f3e302caced5d85ecfe53940b10d63d9f59df4b2e362f571d94f3b3ce8bca99459d7e799623c264d255c58fdf41d7f4314226483c228d1e915f339d6ce6547aae032cd8950ed3c1a0ed5a22af9374d53988a460028e7fff227b029c1c21151141093ea6af156a089a23f8f5bcb67a65c303b5ab00ba725fc11dcbbed3aedfa502e096fa5ef6299e3db2e263db90bd58dc32757f9047c0b3d99fa6cd2a45f93b7952fe50686b2523906320f55099ee28ee32545af6c36e272878b355963e65096743fae63cbcd7ed02a036796cec5b1a7844a068eb78ca1bd7dd00bea502d1d30b67fcc7519dd787aa3d211103468c326c5915f1f1c521b38bfd344a1cd72dfb9d9af7ca3ab127989fb0d20081dc17aff14295f4d6448ad388827b9ddba1f3001607d716609f15fd9bdb18641751d9e2a0e1a63d77f90542ff66545fcc85e0f6c5c5378aa6094be27b7c8a713fa0b488475ed4d4b4f99f0c51eff150af4b6ff584e61747284a9fd012cb63cd2762f5f38426ce72ee5d7432dce904fca85f7625d59bc81ecb2e3222d44cd7b90b651d8e6264c3aa6df0d729670b286019e73332f510eac9c84ab3749c814532d121a9e695fd821d7e65a708bad024cbdb953499e23744e4130a7e9c8dfd73ae3a19481e07f0fb04cb0c137bbc55daef41cfc7ab77d567ea538370d7e2494b7233b4af404c89aae50e202eb7ce208a1e7b7854317b86278a4a2947a7624430cbad694d29f96135fb3fdc4447945eb620acd4cf48e6c05142e5afabffd79c3b319c675432818b709e84b825d10d18095871fe706ed9e68b4d05d3daa4e99dc4ccc3eba2476858fa8f86765acac5a6b83699bb85a70d4d8d329240c791b0e2b713ff3118d7e70147861d2b0dd292b31fdd0fb07d0aab71fa81eeea3fabf4ca7c1eb55a9efc615ef2df12ec1e50cddd70b9e5df86f4221ed619473dff60fe67accfb1aa5eb0e22472a355196405844bef1fe57863b51f97be6de55cea291deaa8daaa4ea2d20c9614fa3c4e5b785b800188ffa58bad37a1def7a5dbd671df43405ac829fcf5423b298458ba7ae5ae59e316b60bb91bab703d4451e4323e8adedfaac4de176ad6b989e93090e861270df11a597a825c575dc232efb1a1080c22ca8c21fe67ade20f0c9cbb9b10119ef6bcdf8c91add13c142a3a86ae5ed0adce42936a77d49461bc56bbc1fcf7c4b005c30cd358dceea6a991810077febcbd45a479c432e77971f995dd6a99799c2267554d1310f7f02023f2222951eac955471ad5e0f3b84a544af0d0dd04afdcb50ab5af78611fee1076a0daa04bf5f8bc26f30ba42127628464f50f07d9483a03566f98e9bf2209bb4b0896282c3d829ca53e2a642b8fc91cc448d7ec2049affebc4b5049ff4cd4f665eade4a4e2f0a858980907334c86ba6410742ffb1632432da614ddf2711ccd00b73a90f64097b246b7748374dcdfb1100de1b96ef1668e134bddcb4954c9cbcf7c2b3e2f2e188e6aa3b7efe19ef2f8b4eb30ddc04ac3eb05ecc550fd7af6c1ff34088960e44804e7043f598175bb763540d8c902f417faeeb4d832313f3a5cbcd51ad25fb8d23d6f44b1c9ea3787945be3ac3a17fd6aa9abfe02dbb5db8be8b5b761ee3f2158a4ac7a484c59018358aaff290c48a90f4b4112cb937938cc729e1ddef31b7583c40493ed6703b23cd44ff546436a34e4a4f69ee5a42d9c3022d9f89c1ccd506452f61ac611e194170d2fcf38a1bab8a8264199c066f0868068f66e76df81198dfea936dc030bac736ef1cb5d0ece276abdccafbdec025108072ca23026ac1c2cfae7eebd4ee193d74a02d6ca3df050fbaec71220c46ab15236066135caa808ddfeb19d1779bd7c601370f0e0527e12640481ca91ba7645bd0a0288a17f37ec548da717d5ae88fc4f50de48a35bc396702bdb9cfd654e31003a8edefdf363366727272dc5045e7501eb6ee20c9b85e2e5f0b25f49b075b594a369446b460fdff53540f41d7d8903b9c16f75a9952feed771a1487f3d673b5bf9201afcbef9ea675e7ba4c6ed0b27cdb830e3289d1ab5cdc559119251a2b2f0650bfe102c28efff50d4fffca459b580037678640ad14106dd32c7effda3e126de542dd0b22d7248fea1bb2821647ed62d24c0541b6e0a306b93ddc7988de1516b969cc5eaea56356952045ebeefbc974f2f3b6e682f3e00edf25988bd4ba960ab4427a0283c9bc1faa11f7acd3fa3855a1ac99e721f140cccf95d4bc04875f0d3ca2b76848dd5bbad5082d27f5024dfaab453f1f3fb2b5cbe894eebbd6ad12c1eff7327ee1207be9a5391f787c7520161cdc3599fa24fefa64c5de1c87afea2f6137beacec9805019d8d754c7242cf11c2a888263fb93c94b0bd5a5bf68cf53d38b14a5062123bed890919ba6879e0724fdddf144374bb49ad1e21aad9d9b48efbef2bca624d790c4fd73822dcc386fdbf1a31a1e92927af3fec6e12f40939789dfd3d232b5db803b36cd07c82deb7add02c8a4f74edbde8656927f50209e50afa3f0a088ab43a5c6c63c6bbb1fc53eab8e9c4d1fe575c490da526369ef1b18683b153e6b9b4865f5387a0bcd6d8fae1bef649290855f79fb7da6e2484bcc6c9fdd187dedad47df9b3a1acba9cd538a8578654d1f46f9a1d494d76b2c846a3a1bba4c23b61b6fe37f964beafbfdf22c504a5caf5ec6f68d3822f70a1488bb6b7b20d5e1ba6c80dd56987e7715e19cf3cd3fbee128d74f9a1075712076eda2ad807707c6a8b1d2d86c5e5eb054708543d36d39b134c4d973522c808820048da02dc7a6efbadffb2e3efee3900da39eafe7b9b118edb31607264b7061868fc75ee9b7284e43aeaaff0610aa4d762909f71667ecf708c8f649b0c1553e4541d19029926f6a39089a0062800144d15356ab8b81d1747a6732a3eaf83193b7caf2d520a3488b8612fcaa5fc5f50f2de19fdc20f3c127787bd8cc92424299873895c3dfb3fbee1447cbbf643328406c6ef92b2194f5b71dc60ddc4e2b83ce0d5a3f9dc0b5223ac0cdb258917ee9a7ff4bfdacf8212c88a2d71026f73e0695f67f3dc03f5b815b20963bc2fcbef733f50fb1cada22dce38e3db748cb72ef206b06d85f47fac3109a5b53997a86f93d8ce8d16b60ac186f3d6b6c49732c8c2f2e6ab5d641e93ad2a0925fffad47a86fcceb08cba83487e649ab7e47a7e59a1b19715e395af5325214232f21e5b89420327b2afa35d214d1bc0e3a755d30d32da2c3c4d7fdc1da1e1cd339d888e19bd1ab7ae7f0dcd8c5f1a762a2c3049e50ddef65e734cf25d68744fc36ccfd32b2de75f9ea7cf603a731c843d87e81b8f4af8d49482de168f1f2fe51511218677d7302f9c2df1a5f3ab0e00008a39a7463be7d3390f89181f3cddef1a5000733e5c8c5795a9e58c49d8c65f2afcd8c341844e3c627a201f4b6c1124bf36c593fb164d9ccabb5a23408e2d6baa09e96a0a5e1d3059c8106d6c875400cb0ad4cfbafe8a52769f9574cc16a07941347faca6600650903274534cefc37a4035a3660c6f93f666545bbee1faec698b3fc4a286d63d2a5b659bf66011704a67b128ace474fbd10a2cfaa91beb6fd22d19882e60384c97b9e0e4487214262e3a81655dab94a8745b39a4122c41616865acbcdaf54b9b80fc3acb1c10c9e8109d28e2bf837fd4ee9d90e42a7d746e72eb43f65f35ac38d071d7c6f8d2aeaa5db1602a8d2ebb2063f201e7c5753f712baf9791de3e14e91d52ffc276450c77aa596ab0a9f9cade6eed8c866adee637c40de6e48ba72ddc9e0ecad191cb7b8c6c6c0fbc4fa8650a5467d4433d09b5fa1ff50e3d3f76faa45de6a37b5765d9dfe942e025bcf247b562674f9051492d859b84db52d4bf2a01817d8735e4bc937241922cb0eb754ec26f641feec1edd0d14c4a9806cefe28ee0e27c9cb75dc55ef53cc31ee9a04be7f4b78f96dc828f1ae5a8853074bdbec57ab4291085655a5533ab361bf9145641f4077090dc9666c33f09ae51e23877290679d8b577a6990603058c2e2313ed875cd453b8d1ee5e6f658279a3bec2353f1cf5ef2745200bd0b0045dadf3ccc0ffc51d366f1efcc0f1fc6d53d0f9f661a1e70f64851c538867deddb60261d6fabbf71f6c065d2771328a486e26e3e3e2b5b720eee03a39eacb14ffd73cfe4b6b09e67d679f55070f7eb57586eaa6c5757511b1af1fb8be976bdf4c39b5b6aec076a08996cebb74bba39cc17eacd14fc8a522b8920c57a9aa01d42ab710a86d2e2fba412244f8bc4730547a2958488d849cb2d96e3b1c68c32675d896d49c7b31b9810455c32708d45c4216eb1ad53bd5c428a774aeec850c44046f86802a0afbc5173ebf1a20855c7e40ef1a5a03920bbbc695983b178561d9becdff18d9e091b76ecabd6fd43b6aeaa002d2e9ae394b04b74f8f0d78607804fae2bbb5e15362b6064a4700ffd01d1fdd71a8aec9b8e96457c6f374544cc73d9f3da4fa2935ffbd0251ab24de983db623195df2b434d85317e41e5bf4d45826a111601badb50b77ef416b37b4ed86f6bd0ee415c94fb297079110c0d115f38babdd33caa407bbe340e7e3199002aa662ced8bde5e058bff7b8b63c1dc888bddeb548a734aa047819e99097a9f8922b7bede8acb9ad39290e2d68666ec7eba0158c150b7e6464673d3379b601828849cca1e9d4249a6867fa4b21b69765cbe94573b0950608f500478c1b3c3692162f62b93dcac0609c13cb0fdf3962b613774d3014e471743b62c8e1048c05d8509d206aacbd240eb933129d6c0f96a153183fe2859c063b34877402c231a1d23f57a0cf4067e957ae59312f6cbf1acbf7e18dc92b4fb20ca9200a58d54590cf9cc1fa478a68d191f56459ef98ebec2d0311a70324923103f142ed7220f2225ed0c137da7f46f3b90d15ccac39489c94b9d637831b3c8dfdabe74159be70d925ad0bf917c0db65f88b20113942b68d7dd8f3a6d90b07cabb99a2792a9a4536738adabf9d23d0922de5829f53455c48501622127d745df487e7c32ce4bd058d7c1f5c992087dbd4fc0512a7c0b4f3be4d968cf6bfd4cf5b05d1dfa072e44f28dbb425acb88f3c7b578036c43c9ab9e2b4e4744670803e22b7a93a27f8d800140ea3a3a7e1e748b20c4845476da9d646e290ef199e8d110b995cbba60280bbbf849f5e348beffb829c552dbf726d94a9e08909043eb553bb9809029b0a839d1cb81f179cbd3267eed9155bc66686adf787acd24be3958f8b94ef68161204597f592cc9197fe6e0c4ab0f19d9080734db0dc1eaecc109484d48c6cbc5a8018bd27b973f9f5e5ab6ecd9a46ca26035c24655b83f2bd72071a0c846d6978c6713afccdc9e381f1cec54bf37cc5e17b2d7c6260dea10c8d9478f213de2e24571bf61c03b073cbf65e63c817a91204378a62768dc57cba194ebb2602b81da86bb4f05796a6d5554a08a9744aa9bd5327cdbe07b2544714ad46520734bc4608b06208b388e507765b3d0ec31fac4f219ef71e9f4cf44843511ca4fec01064d02fc1cd482176a20ae9fc530a32ef8f1131085dce54ae2edcbfe9107cefca634ff71ed7e3ebae5f2582dd5ead92e0d8c59bf91dd2791a90c7038e75937369ac3a25cf8cd7498569299d5a08ae1a605b538ddd1a73ce8573c3ad5b0981499e4bfbeb33ae14a2a6d5836b4360e4392deb2c773c7c65a3abd8f4ef0ea8c0839350d11fe25f9a1c7b4f46b1115d3b08d9ccb1b5d2e9725f5ae8e1d3da51aa8db1cf25e22a744537bb323dd9b1c14a65aee7d6270ee454fbd1de4abf44c421958f8787ff63eb1ba5459b3f6819fe45d6acf6245278ad52d056a811be94f78659ddaee7e891f8bd2c1748353e505dfd92d166597269c0f0fe503fe984d4c976672d786f0e0e9d473baa187a2f59d4953f0ed7d7194a32442283d090eac6588c4b9b69394e142e140ea77a35fe9e6b4ed0a8ae0d026f27c6e43ad7406887de61d79d866b63a7c4006524716574a59a34a2b14efc1d1620587ba008215c84fd07302bb74650d616cb10123a10043e85970d45185ab64ce65fbbf86bfd99b0e3a744904a046250dc22ac2550214f0f5b4cfac05d15d26e6ccf20d8c998adc5129a4dcb83987881bbf577be312147e3ee0e14517a9ae3750f3a63f3dfad5a86574fbb4e185180559ca441a01162aa7dcf13274c7697ca13506903c6ebbcd2ecb51153f53647df8eb6c8fff440b3933b53bf4f8ca0315fc7910f874156dcc1813b585f191b560a4cf80cfadc78ceb1240e84081201a000d94c21df6410c63a62c1eafa7aa318f50ba6b666572d6cfba15a46fde1310f513116283199184a311e1ac35126ccf945b1195b5ba2599cacaffcb241de020bcfd6b7d9b86e05b22f294a515fa7d1ec500dec1a693f9e8aa62cc7f9a257505c6a3c93f773dd1c83d4bfdb535d12d7f5beb6ec85258aa3ce7f4cc7df021cd9498c7d9897a093964f6ef49915e53d46b7f0276367af0aa6c3cc3e49d1bb4d48390ab70afbe99fa72ce05aca23c651e0d675c3c5fd3362b6cfa01af3bdd80532fade08a553d1378995ac97efecba1c0d7b80f8639348653c7a22db01da8851f521781caf9f725a8b8fd190dd357215105fd069ccaa564d81aed48445d28fb9e31d8be90d12bdfeac7db85d4ea30659908ca9e02e3f1ff5025d873be7f6ff38c9e846e97065098734d71897652f749e1435426131204dfd373637ccec94ee2da9ed51890a7c70e384bccfc4a4f09ac880962730747e1aec0d0637244fd793e0b3e43dc5eb317c438d8f115e675d38cf1f6d7c8a6c0a5aaaaa7027aee654a91e508490b9a7bcd8a38bfdc7f2de08ce64b1d87579256299d9d3d52221fb55d054fe2eb3db63219efe5a4f3beac19de8d2898a62e1cd4933ddca1a4d2483a011e070ace104cb9767b3866c9b08b68f21f9b71c4c849208bb60a9538701679d0dac501c401c3b8326657b4fe7c7d70e74be0e0a671d52b5dfd0fa4725bc74c1c367caa46960a12373b1638be6197fe0312d83596acc5f7aa001bfc54d50c3c4fb6fd2910408f5c52470bdeaaee97062cc677d438e260733cb0523a6ef2ed98375ddbd531f27300d77be123db192b85811048f216ca876abcce3e43afaac62f33e1ccfb0e8e1f27861ee818018e8ab3501b8e10b40e85afe674e7a09d90855ebd7a7f90bac2046bef8267fd9f6f914f91956dde705d48a251058bb904b220292f6d08dd349f5596d999bcc1e088ade948da07b1dad2dd61427dac1f70c9b6b0bc99f5455b7c12c3719af8a69fb34f58fd118377eb71a5297aac86016419e104b30b6a427ee9b2c117a384bc54f7d223208de4f626dc5cb98712d91e6a3cb700c36893e196d17f7de1e4f9a7de0330f2dec8ca8cc8dbe5918283ecd82ceed1e96a64f54c373f8aa1b95c06f1aa83ade763241a2384e99609f0151b0b6e04733dcc1f0103de3a3e83845f2618aa474ad12f2ee4e70fd9dda7c68c071a5e33ae40851e0b8ff5b92bbe90533a25b8f7bd2e8222807d043ce4b9bde5238b71fb022170c08096e916de50057251eb1738e3b65d13038d76a904cd3a25de62a44b65be26d773b25ad8a4e2719ec88d12ef932f9ff9d01b8306c2592544697826179ded7536d060177cbd1cb2842a4b65653a3aececd0e87160be8f48b128a6a051a0279f32de3ff51c28977d6a3eb501bfd189dd35c61002c13ad350629cd2f6660499aeb8a4422927bd02c3a1e28aee54f2f94dbcc6116fd5a5396b4bc9e1c87e68b7ea3703edb9107cab324aabf40998234bd85d4578854a68e4a7897b1c6d047236b259fe5aa1e7984f3f9e7a698a2d00ae0d616fd88e052489e7112377b415dca1749b9e383e8afe0fd0d2db761e5c7ca1e9b5be7f6180c62854d07841c85d6d3506c37f8eaf00e1ca092e560c779fee01ad1e0ff551fb3912b19cf1ad5f1388f8f4968400715161b84dc2404c77e61ef8cdb435997cb59d98feb655e73d51cb32ab7fdd46315da6a1c8a3a52fcabb764a3c73f96ccefc7bd523f17c6dbb38714ff883664cc3c89b5ce49483f1f71dec0dac65c079566324fcb06d3076d44cf236452bdab677504878c888570cd2e5c14a0cd0c2cb91a9e1e5e53018db9cda56ef1fce854746618e59a70ac328eb8655a99b820ea1d060e0b4850c4fbbf7ee73b04b1e965b15fd6753dcd8a67737bff5ea334ef49c02ec75669932d7635c9eb9b461b989fecd655d2807eb0c3af2ad478e251023ee58844b07a2c9acab697f2741119b860481b856bc4014d1fe1cabccb7901d867596ed8c0cbc018f1dfab2d8675fe5274bf835923738acc98a6abd4fdd28eee887840a5299a79dc2676a4c2eb4d809d414edf506100c8a672e3d980980851b82c27fa9f2d918996f4c1dd0d6f073c1917c741810222d47d25a15bb5fa6ddbf9ce7740bd92f1c6eb6b8094ab24e7ac0979412135f3a4796aced3db7915a8d9d9ce760bae86228894f9312cee71b85b0da2f728be8e96582ce943a83f851ec4d8dd8705d0616030ad9704a0827266f0f4e9311f7e9be75d8bbb350a776ec40043a59282af139d3393ac0d9b09770b94a118dd66ef3fe1a3e7864ea98b737763ed150cda1ebe988530a5751f4c79831e57b460a2c6873ac1847e3bd2c50b16052ad1bb79e9dac0565d8f39e8e4508ced6510b591b9c389d7b6e6f8f0ae434add2aff3cb5b290905c9dbcecbdbd9ea9a6bcdc8e1dccdaa410add8f239623310e8c5531dcb47b76f0dc7d4bf7bf22e91d7989b03f6cd7e7c7ba8c69220c7f84561464213d7948de999905b649d5e5fed03234b7d8bf297cb9a6caa958966ff6bb6cb47d2b89e3e3d1daa197ac47f4b5fdd79a765e834fcd06ac9916f9b0d2ecf857a47300aa19e2799bdebcd0b3d89f6987716862b58a4ba0c1a3258c4ed73e58609727b77136c1a2c0da6d24bc29a0439bb0e81bff9eceab8d1633c6cbc5dea1f581187f55b115ccdbc730c1728f0078e110b7ad6401c98f2816b0e5ca63d9651dce27fb3e454ec47afea3ea6ff5cc27f3094b8dc8a016a90282bebc34cfbb52044d3424820e4c9498456ca71ba9f956e48c6ea4a20b616af37c4afd6856c148046372700dc93df82105495b0d96e783450125b15ad7e5c0bfe1f7ebd35e1befe1c5cffb833e84e87d61d44719d3fefd3d0967c5f93cbb022fc45265d5912b8538867767456d25bbbdfb4325d3a520673d0feaca391bf45b95ee667139281d37ec59457be7107813177c5589efb64fd68e05602d6191b59d868f3ca30a303d83a1b6700aad613c5ad2ebf51b1aeb08694e1228671f08c405781e4c6b8ab636f2b908b8e5df555ee0ff4d1251e5ad70fa4cad4e56b2e8c8852ab26430d12614641b55b0b47777a7cda39deeb4dbad559ab19e95458acb5a9f5fa3a9d7aac59b2828768654f3a592c4f1579db418c3dbc18394140089c6f887ed4093bf0a6c699a9c9b5e0ec3861fa4bf6377c95048bfc89ad308f55774cba89fe23e53990c248d7c7bee3024f61405d04aa4bbbde75b51a9e7f3810f59d541794976cb80431d05a04fc81e55dfb27e291d45dbc860e3a4c432f34f05c9e688b89885dba898887d598116e4753bf3a824734d7dad2fbfc069890912500e11bb34a0290d479516ed4c81be12cfb7f9950ef8b5bf7386c86f00c980a90c18f9412afece44822465cae5d274534a8001f97f723415e4c4d1b040cb965ad7fcf9f8c01be07f5f2ac62aeddbcf1b6539c11a2d506d82f6a9fc34ef08d7d4d4d613d986edcd3f08fe3339e06ddd773c01cd7442cce89950b9c05bd998225a80c9f64bc0270025a3693a3c3cfc5409e9ead74659cf26946d6acf742767f33f4e5e9ee8b27c82c7a3404c8392d1c18211deac87b48df8add0b8e7b188e1c0ee9e1d77b5c879da0e2a6c290ce69c8f6b338456bbab14c8f390a3df6c320ef983f18df2f2d48ed96117dc86f3c84ebda9ce3bce4e62a5b44da85fcec572c5125120301b9dba71c05f14ba71896ae206ca786b81f1267e97cec5040ba5305b3e1a152e443fed25134ae758ee6b87ae8a4260862329ce53379e8ff1933f26219afd4708288de1ee119805a0fbcdb4488360cf46da972f37b3098134c98a812f045dabcd19ff68ca9bcc4bc04a8cc188ac5f72ca018626741a4d7696b23f9a080d4ab732149d483105ddae84a92230211c9628b37e960f2d4e897dff75459a17d1e6480c107131748467a73d5e5921b6fe6d097d1772121209a7d30c1085a4048cea1be12ed5605c2c7e4cf5d93974f2f299dbceaebd11fd552852d522caa084a94a5650a40c3b2faf8554b0607e10f66a90ed8732592a08f731eae795e2d8e80ff26ea2a6c6ec41e78c466d47a78ae1f3b3129f0cc1ada4b495ce3c78274de0248e4e6e60dcdc1f650fec66f74765cbba727d6609b786e74bc91d51012a15ce4350c04089200b4c28bec20c83c7eae3557c2c56c5fca8c92ba195c033ca75f005881f7ff99b09dd0c8a3317f7c6a4b2355c71f8ce2865d9fac0278ea8ae398aa2a5896bf672226a3eab7aaf14e4102aac046035d9852e707b46c70072e61ad20c6f9c0bc844f2aa90b0e50b3a02768f98bed8165ef8aeb4c8ce746ff815ce991ab7944b94eb0254783c418de7a5e7297d9dce63c455a27b88aadbf2712b4df2538195d065b750594154b3cd95da6d8ce663f2b44530cd4b0c06ad744541f36db097bde0d154cf5c106dd0203cb3ce796421dc62edd4f91630a8ff4ad1402c36f96c18284c97c386019c06bef82e2a3a8b3374f126d6a35926646a337c532a8c6ba4f494abffe9b5f880b9b4cb6727e2c07d793677ac5d88b2e68b64e3ae999314997868b0fae9033366b050f27bc8748e3a66d0eefd05fb1be1d3fb2731e9a7576f0a781a50bf7d47ad89371115fa312aefeb64263fe5fb5360de158f97d17a28b41a4371c51606b78993d4ce8ddc0edbb318a27f18057bf103cfa810bdcf56f12428ccf8426b9ae6d99697fd2b562816fe32fd8e66e7d53d05d43ea3609b28d3e1b9da2a6b1fc49d309f680e6ca7508c83a2a56446c70b67d1d310ffc3e6533453289c9e2ce257e08a2a3f13e91f2637899272e0d20885b68cd9c280906c470b9ab752eac4893c2ed5504084264de167885674ebe8d88ac8720ebd2ed160bdfbfba2f936242592b6d89ccba8d94596a9c0fe788e1638f177fe5dbf8b35bce1e534f64809d6c7f51569149cb0dfe2f730fc068f8149c381b3a5ca2dfd1df59961aecf8106339686a9d3f9c142e6f10c49ef3271dd863ca41eea4ba1e49482de6ff02f0d2a7f3656dc1cbc44cbb3ffc67364690b2239c923c10725fc8ae9891bb76402681aeaaf858d8f759a5a9bb4916a73fd77a924b7508da4ce08231ea41d138242f2b58f119930fe048e50b24dcdacb597960da786ceaafb817b5e58478fa8dee78bef0ea7ff3a6176cdb1fa1f177ca904ed7fa3e8832dc064798b9c9e25f43bd03e44a01fbfa709f5cac922f03f27ef14b2ee7a288a0ebf2322ba5070d954f745f0388ee26113e65dc2c7f8d03cb0970ce8ff98e24423523bef4177fffef02532631628d331b354e0e0b6d95a5ca99b29a5ec7ec11d1a27005f9e1b6ad63220da1470de89ce728a56cdbebf8077bff3357248c1b4e5e4ffa25e6d971c7a955f733cfc1d4b80bf5f9a90a21fe03754bc95dc9bfbc6f1d30f8a7d13d5315153b37d2fce7c914ed1fb2e7b4e880a7272e5de1a5e7f810d4aa8959c21bc1720e33ea1c308d47e671b955588eafa8023af5e39124d5c4c9cc66d3ceadd7b0424ecbc6ef9692722430874db1cd0463dc09503165017042b46855c7f70c176eac81eac9d4a53f7a1750f09649eca41edae6cc73fabb4ab564dbd81f196f27671e298ad4ab45e98585c20959deeb137005bc1788a5199b7970f10fcbf50fe60967e8e7919f9450f2d8c7e9e5e3bf9ee461bc0c7d1b95e2826fb4548d97205526bbdcd59a8763358349331212a36788cba254d85fa3271cac4f7b22668764a2fe30d6b91c7d5d32abcdb05b19f775f7a00de097d4643c8a5f3588d76f36a0e349b795793d8b31eaa0784a8be144dc9725ff0a343721dd57db02dc74a2d6a84f0e992e21ffdc7077b90217577da3393d83c71e341f04ab8eb485fe3ffa864f693c78c00ce7c2cbb55baa5977391215539669f10ce1fe4bd64e76ca5fb6a5786e3f5270e418f7089b680c5204f243f581e502a616eb3d90ccf3bed9fed6febe6363195506487fd5f24c25c9798ada94d52f5cd0f8bcb01c2150e8ee017b4ae3722b3b53f9d6962d4ad1aef127e2e5f4e251d0d249747fd35897d4e5166b0ade298f5df5b4c9e9370a9339e286e6cd843f093dc5d46eed38f3b5a8276032554d2986e63961fd11f4cd5aa8e6306e1f001923659d2a82f536f09a60f29dca4df56293eac17cd3a0da4dc72a3c9f672f98ca52aa09a61f0c5ba5ee3c67bd09ae4947b76e09aa75eb080f89e2ca4c82f90ee854ed2a7d22400dc635ceae19a242a530aca0a1860014e3d5a0e9cf77bcca5c3d09198e20a108b1798ba17c723a3126f3943cf69fe2d0e18fdecd396cdb917d0dce54d33bd7e83c4b458e8f505c2e487ea1143cc7cc5b7f295ed63b15f051721527c74a0b2918ae3d03a99f0c0684c669b2dd57b30836b23ecb94bd9a4710820fcc74f3098d96d1d4cf01a63ed1b5a7c671aaf3f793d55b39e326c4c275bc2155288ae9c8793ff8492efdaf9e2c7850001d24bee1403e467a951226e6b975caa8570ec2ab5836f19be0b7ab0ec90a8b70c12080bd2599d8f09c351b1bfb1b7b1685d0f1c551a1bb9d964c7d99d0109bbe2c160e533652a94e06c844852c9ef3e2c945f460abb9d2b31c370e7f3249e3374c89e6bf2b9ede4b4dcb15c4661fe5657927963b55b698dc79328e4f8e584034e0e8d39dc13c688046574c800d659c17d6810f7a189e56ef676eed6dbf0f0ea8cd2d6bb1684cc30f10247531f70e0c596b167027cea8b04c9c53328d06afe44ffc3998c594cf2873018f9956e605ef66a844de638b01873351f058418ef0eee61d395c9c3c7b5cd31ebaa9af241f6cf01abe5724b227d32676ee24840ad00968b0363c0e6c6ee7c026b57616214d741c5193e90a825ccfc645a5026e7b3b5af9a819f1e251a4c68b1ef4d924b2ad0adec83d56548a97ae05dd327f1ebc337f3b24c8971179ac0c6e0a67fd6bd72ebc7660e37378fc95802a326a37316289c2c69aec7ae033a24ea36222f33da311b1d38aef4b916b7886586539f5ab6c78bdae340ee07ed39d12c8bb30ad678ce338871a401bb30bddf36f01c5001278c9d9039ad837fb34a27ea3648aa8c310059abf793db5a7b2c8fead26f314e3ec54f4b2b5a85026c4091c7b439b3148c550f68462e459ca431aeda21c8c2dc7b7f05f1ac651ca5f9bffa598ffd422bf7211605d180373720e0ffd613f0c6feb9b269716d54267c59d667229ad62df57ba55f9f76fffd24f8f036d18a0debc07fc95038cf71d7daba187723eeef0eab5797ba467ed39c3f262291720dd955c88ed45a69cf1d808903bbca6e60c6919d3d5b9c9b80078d4e64e0089b40d6a1a2403014bed995cc47e586893ab0af33954593a85b3a16c8dcb6db41ec97ebc022290a5c1ffbd3234aa5de0fbb20e34fdb9bb842728b203a881a4a5f6c8940af745f8bb7b28b3d6a18f1ee47efc98aada4346a6d1aef0e93cd55e6ef978981df79211000ecaf79558db7aae9ba1f56afb16230401af96d0ea3ecf0c7905fe89563ddb03139fcdb7e59b770502ce60ef07a1c70dda808960620ce8ac74d05a8c0dac4d0d4b9380b4c55291aa937021824e7e9d38f83f13c981496801a46ecdd8c45712512d8526cde2f7f7009be669350e65792127941e8d59cea07670a435f63dadec91e3986740112ecef1675ec4d7283eba36f51ac60c8f5477092a3221ed4037475e0d41f6c833a85c75a712ba426aabae89d353d4f0baa7c32d14715d34dac1a3dc6a6efd362e345aad39aa59ba668a410d3f737183d6daca4d9633c53a9f86dceaf60870f18213e2e58bbed265f272290272650572e27c52f292bba460332009b5ddcc4643ed55d2faa68c60fbef6823fb8a186ceac5e95c7878c2b53f417a023484ee3c39cb3f82f80f4f67fc552607d11c7b8ad84f39f3a23f9b2c6838c84f0a46de5fc7eb3fddc8a8e2dfe94bc739786d41f587ace601b95d770d8955154ab8b67c4b7dfe3a28ac4b0a4c964ba70fb2219e8f2b41c1435edf8e9d902da20eb52a4120e08dc359b7e01c26f302ffcc300345cbf74c1a64f9acad620a4cdabacdc08cd93cd77d4adac3598ecf361898e42b8b2ee3d64b65ee9019d414b817af11b02ed803c3a57d1b1fb3aeaaf2795e4053660e342443f13d31e5056e41aa36096fbf937ca0a1919c6e4371ac56ccac6bcc2d7ba0ec0c1ac42ea988368ce07c8dd58f08449884b0e65193da061a482e3f645c3a94dbab3c06e51d349839cab5546c9aaa5a1cb7260eafbb295261a1fe68e6699a0804c46e854446bb22d64e5f0b74f4d134a0d5e67df8ea2762d49199f45897f5be59d36d187f32b2343b6fc71279a126326e7cc59ee39cab99eddffcabb4693968025aa2ebed05cb8e98ff7f35d5887005a14a1b053729f53d4f6a6ac3156efbcf5a3e2919df075bee93193ab84bf458a31e3e6352892dddce650a87313697832fbc8a771924c0fb3d06e23f5b0d29457c152ed235607cc3879cd6347d242b8ab91bb00d210f865c0b18baa0401df50c8708b1c7a76048ffb8d76f85b083cb084ed4b7b46efa195b2eabf0a9bc52182b6b01b633596c0b5bd9ea1d47eaaedd77a0ff9fe13f539288e46bcc05177ded025817f320247ee91de5003021ed2a47cde679ba29759ca7241933ddb5b3418be63c2b4a2650a17502c1eeca72c50b3969f97ae9c4dba6cfcc7fa0275e4703ab782f575e1bdfdaf6b8d255ef6b60e0042e1d82a97d177eaf13608e78c1d63b2b01e8949ea986ad3ada19c6111c45a2b566dbd879a83174086fc45c18936ebaacb1d270a590252a1409bcb220acf8c7e5847743e76d55f91fdb9fa40b3e8b7c7fa09248b01f8228ffd6f3ed756e5da0e1a1be1f3c33adaac8695d2a13fd1f7aa3538f30281cf360162b8ef1451ba5047674aace0be770991cfc6b910599f4c15e403744d1a8e2db137e52ba7dcdb681540d8d02fca8e6d8fa86b8c69dab2e4027be1c39a7b0671175565c376b5d515d5b92b5fc4cd104bc0972f6cd3b67d9087673da41cffcfcf2c4e2589458ba380770faa739d290ee91243ac37cde021a8ad407b6134a9201580d80c3cb60b1327453c7058fa00ff324fb34480790029c850f224cca29c08ce03345b7712da9adacbdaf3fe6f442a4bc16661d479f924560fcd4c75861f4c3381133cedf16595058f306ce65471a8ea48460d1ebd00898d327ae14616df73887fdecf03da832f95033b1a8a0267f64943f84429097ba15480615fd564e373c0e962ce436fef34db735cab2e3f59c8dcd8cd8fa49d3d0d7ba890214f05b7d1787e59b3ea1e85cba83305c66b0e10c682236fb155f91df07a918f7e3f047fdc5281f76b3b2c25eaa730127e12c8a919b0f009766a3e370d7771896ed8d25f57eaa336f4dd746ac3a4757d5ad274067310b27d6839fec9204f69c3857108296eca5f0932d0124193f970917aa2f2afceb26f96205d92dbf3e7182b73b4c4dc3bcc6047150c4720e8fe920aae21df055b99e55d8919e938153cf9915d4b988986c26f935ae57dd429787e3114d344d7a42aa97cd4784f3e7cab6d22588e4cf5a567c7827de45baac6c50f6950ea3b82075f91d75481ac87d17194a6d15da6f13d79618e9ea9010fbb791b18060428d919b092645ba8ac5e09b5f226828602190e1ed18259a469114014c95902649b623f72733b0e88f1fffe36d4bcb602a406331fa0ee93b0f4c3857c53108d040d92387ccda3482746b64386db439ade82d452fab6b04f7b181858417163992341656b3a329e028b71567fcf17956bdc274f3ead9e1de498b295f30cb2299f48336168e198ff29c76aed49570da747c1e1bec44ec22ac08a5c49ca5f9811e4f68fd95762304ed6c81b357c9958396e46e70f052aaa444c19a83337240b3e4202d67c67fb340f7f009eb5ec79c57dc3c59a539420d8d0f6c8143647534124ad421d09ff7db3ca66ded177b4ea1d0fd260267357a6ff7ff10bc4f508dfb9e4decd77d533d10a8560e77b20ef04a6117ce0f4c0f06cdad2892c200414d310de5d28d541feda8d8de41eac2adf321f4d9934245115679bdc4a52a695c5e93cdd5df36a90bbaa369fe7d834b6c63e58109e1bf009015a82b71a5e067fe55de4871f466f67279488026547c4d37c0d52928c704268750c378a05053f713f11a82a01cea135afc3549a5a64158f708e196f502ad42fe54c750f47c3b347a8518ca78f593220a71a1d29c73c1b6f63e732b5c5ab68c26a23e577f3fbdd58c51f25c95f11c3677bb5736819c261950abe5c0d30b493d3ae60f0c2cfbcec0862812d34585d381fe608510130b1b53b38f4923513aa10367808518f232feb0d310718016f0724d3d42528257fa50769f2b69ad708e3eaa7d79d360b7a3d0bc05300d76b0365bbe39b20aa2512ec9718055821cb61e0c30f6a2758a2b476978d6751598d9f79405898dd7c2ba621ddef994349e2575fa8f5f8f947ce37a5dc9d96ff827b13da8195561b5c5d7bbcb635da7e287eabd3c52740198383599a620aca60923bb603063152af509f96e730e0ca016d237c5221eb67acc0065498892535159f4568ab4d3a8ae605772e361bdbb18ae568a99f070700a959f425f1411dab0b808a8b986fb1f0838aa4029006de4a36404af89a74d4aab451bab944d2c4978e9bfcacd1cba84a68bb7087fe99a80579f7d52d1aa07c301a9699bd84e981c488b991b49bab43c23959a26de4694472c246118cde7b799465d53db52bcdd3dd43409543daa968428c1d8c8f895ff4e85f6b058e9a4938871e24005461351620123db0818ced9f59b63a118c8f392aace99b5ac1967337de65b1e7b12a2066ede193c5042d4444163b6813b59e9167ebd57a06fd5655a98c20344a610e0e99a20ac9dcabbd4b399e85e4fe9a44484b0c70c1ffea4498cb654d683b1321e908d07675d78490d5a4ce71bf687f4ff69acd40ab2ff850414e10ab35060b8145a860c7381d9dbe54b740eb199934b17d64655d61271d37c529163259483a1905f9665dda4ef820d29d22f57943eebd8966294092a38769c0a9f7c5ed84842a9841d8e6b9593a530e2e98007f815127dba9f179eb10fcaa242a0eaa3291f500167a3d2cc584dadcafac66ba050d80079fa335362b74dc9e4f3e9d61c4ad3ead8287a0064b1ef559619abfa6d6fe68ed3190a238d28acfaf48680a832e30c94e75778366566297d7b31c11a6955eddf1ad58e7ca1e9895adb9513865838e98acc624f315c252d5313ae4d01a24861ceef792bd3e52acb913367993c097ddc9303550fba4e2306071face18bc55aaef30b27bbae833a149300114e66eb60ca4b02e9a3054b9c5eba441f89279546587a8f6c9dd44b1599deffde4c407412a6fde462ff4316ec78628c1e868241dc6e1a25775699fbd0f7c8bde3bb2ea5aab524d3fac482bcc8331e512760ec9e937dba73ac855e49e7a92d416d8e4cbb9f275b7313cecc31c7107bcb0415b3a8e6f86668d5db038e68ee880a1ff47675c9cf2e3787f91c023e8e7ddf1bba62a4b2a0610cd0c34f35b816b5b13235b21b7a541601115824436db3098b142bbf5eb93f61b99101678483d2fca3886f536aa70b20da9db6651c786906f5a680d43b0592e876c47383db0e3318c08023e99a43f51b30bf066028d1fcd647e08cf4b7617ad710c1d1245d7f0d022e97e4af2fd756c1408fd974e3a1a35391547bc240ac945bc06af4093c5bc5c33d4b063651aff39505725c681936df664260a318fb075a7e8e26ec29b96f6ad13c284bca652267222912b632b904d5717fd0b74a826a82cce3172501e828afac9cc34848d4f8d53ae422ef95102adf4f6d20b078df127795908b64771a8ca215fcd99907e6b49545fb78c9788fcdea5f1ae6e9989f5f959a91a0c2fb5220c39c3108f872f080a369ad2f049d69e5b392331679f17d8bbe2769e976008d8ec56b03933a39d3c7616333c6d66ed7131b09ee0dd7eed831b6480fec8876522b53429f19b38172f3dd2cbdda057bd5d2ffafcbb3d253731a7dc28cd38cd7112b905f8b285bcd1b4329d5e0f8262b2e03ba5a963253872cb4dfebf8e7e03d9953700be018923ea8c9cb74287157ab974f929e34441a2fc939018d530ed36cc7930f72beb60919a416c2652792850d56bd44b84c05fd38c0f785ff01ac54073c6ae1ceef39c07ef1f2c73b44219987e1ac73a744fa440cdc0ab42ba611441a3774c7402cd2a5d860c66b0cb0c9814a6163541d87b48010d341dbf92fc0328e401714d00082a1e9c61aa60621c9acfd5ac8cf142481f1a69d3112b42b1fdbea022f731801ae1ec21811543658a3e2a63f07a19b3c27b95afc0bae0c7d31bff111f49651af6d13a245b8ad09a5019b2a045899360244da5bea6b11f0d39703e3d41a053f2e8d83d8f4dbf658d52c3d3cbb93e43fb792c833fe28405a11cc2fd57346d8875e5c1b68e49d7fd4a6ad0a05202286c0b44d8740915e101ce00c2c8db96fabfed93af398e783b2cc1928e4c569a82e94b0bbbb6b79642b1d52bcbc89de9b710bc20764c42d021272b77cd3bfc7e80decaf3dc5ffba207ad2d520f34f979579b133f2b0c7d709cbea7c3014e1893d982089f30f7965795ce0e29375a020b143b6db6d541e9d20da889c52246464f623039429c2767dd5b5bab58808f32f1f5de5824e411efb6fcc4a8028e2dc4ed7825e076559678ac5420d03826a30b0f7595e98365098125e758544788b4198d35da022a8364ac3c9c8056e84c0f487af785cc72fbd28b286b3e19eb015bd553a60721c842d293088cedb288efe7b620e861285b7520ed5339d5c5c05b12ec864c80fcb2a450f892f76c854591dae2ad6ed2d2a2ee6f6b07f00beb7b7d03acbd1f6e9c4fad7b091702ba34dfc6afe71332f94755a7a2635d532418c3e72dc23378c83a709faede1c3ba20c137bc8c7c8a966e887690f6e6f16abd55112c4f6c42ae43be8bd480b972561b2b9f807820ab5e35c4c7f5428b4575bd491ad7df1e7170d463dac0cf925b20482a893308ce728af1a344359db1f9ad89bfdd907bd8ecac0545eb457a517ae45cf01009fb303c1fe90240e68f3143c5ccd4990f3a95868f806f9dac67a6ad073342a0b50c5268ad44553462d6a9af1bf7230f99f925961b666b97a27d1786f0c8cc34fe47c716c992c4b0816ca68a6c83f71c6036e5517fb1954840ea09d98dc5e59dc7f098bfbad4950ec10ed207876e473cd09c2ec3a8e1976f118c5727c55d8a58a5e4cad3e1e6a3973cf24e0b4cc393d9357a16e08d8739d2ba5398cfecc7db16f107a96cd2f3c42dc3bd8a4eab88f1ec305a76ae8d58078f2ced42191248b56dd157020f3cb2e46e5490bb46c8a36317a3d0c53f86a4a4a9367f79c111d47c32ed6281008b33472b2b02cbcc7d771754787128156a73dc9399f29a5e4fba177b4274e7089bb063133aa5fdd0746d7cca71de9345fa7c83eda80d1a72ff63a32505d86c1091c469ad2bcb0a1133710f4e248872f9b622e74068b4ec8c3e654959d5cbb3cfe4e1b6618e05ef957ecaa1fa53d5a54d784e360a550c9b4d52b5f9f638204e6ebe88b0ad3f026c6f10b199e6a9e1b9a1ce4c5225a2eb5085561317158ed1d53cc17799f9fbab72bb3d3274bfd88da14c716ccdcc1c7ad8746cfacaff636eaf0a6e6e18a7bbf610c0fb57975a6016aba46af27f1681be8761ed831d117857712df24fa1058598d02e0568b46cbe64c6c912542707a2d302ec383d1e8892b9f8c43677b1ebce8a63111241755f78a60c6bd4e06b8ae6f4fc336c343669db2796fef078eb3913564dcb6d34f4266f15fa60798a3659f69ef7b70c418d867624b518d2f6555fea074504fb5646ac65014cf14a3c3197444580fbee586a5f46721d831666f766954bb6c7a100a9d361a122d0c2ccca4661aaea99370ac484b3bafd0675f4f49c3f93f083e29091869c84e05e8f13e8aec2458779eec0b6daf64f8661e760328a7d45d7ad1bfe7e50bc468f712b55847ec3b56e2ac39f2015e070c38aa691106521bbda0a4bf1765574658caa57da749e9a52971dae6517e14cab20f7e1d8defdd43c9c36cec0e0190024177a869b2f34059ee8f3be828555f90c1a9470a52422f757f6128320f048ca6c374051c0f4c99bcc36b593a35a04b71f9ac5b947a0c2a027cba4c52eae8904b2159f870122965cc5b891453d10a21544d09a167b875af5e2cf5ffcf97412725299478e26abb497762e170f3cfe8458d3f33bf9513f0dfe53433b18e8abeb8320627d6b28599be159fe91da16d91d297fe56c506f66d546993ba22aa6aecd96f5069201b6d3b77b3cf18b3dd4b81c2dfcb2a11e2c0ee4cb2b78f860e57ba40104b987878b59e4f45e7d1e92851848cb2e902cae717334ffc109b79ee41899b883e823087ac3c681d93078baafbf07bf8e2635b1fbcd49a7effd84611627b74f75c2b05156e10706878b3214ddf0fca51c14e2aa80699b71e4114f4dffa6454a939fa6f35a764c8db2528e02475079dca4e099430411780974c5057c870e7e8d229200a67a4375123b92551fcfe1f5cbff3b81ab4840c05ae8d257a535b589fcfbcb5fa9745e3df991279dbc7d57ee6748786fae81336b1f6fe641ae5168ebec5af27757eaba46ac17ce19c2e3e760234ea74699cb5928cc1579209ffba304fdee83e22499972a42182562c206b7e66fb28e9adaf47eefaa86a377c3f77bea0848c9a155edcea938475c6877795179f613fcc5a792782331dbeef7bf23717778d148779e658627c194e7d88779b2fdec4da96b09a98df50bb7facafa93fd1e83b72a3f0ff7499e5db9014e062d833fc6121735181cc8d31c9792f4c1825f4b68656dc68e1fc7e3a23f6a73afcda7ed810dd77debec310d59aac93682573c82d60207fb9d63f5e2ef50658d689d025acc6c706f060b472acbba032430e30968f1e36fdb00ffccf1dcde9892aca16cff7ccc3f3f86e56d30652a0f88d1ad444b899870c4c9da9e8a13377f61f4ce8da3abbf4cb75d0e95abd579e6b13fce1e79b7df1aae5adfbdc9f14aeaa6a7d2948e54901d98ac9d961ef4d43f60a0304a2196173f02416eef89c04afafbd92010b99dede146fb5a67d7ba213d9b69fa70b6d7fedc2562daac31b0123c4174ec4c7192fcb9bea13c80712aafc5fd7b1605de36fc772f03b6aaba04dfeb236795312c9241a5a817ae48450245fad50f3162a36d83842e6fddb5bd2c518a771e133b8f197e9ae9ebd5df6ab39ff8ced336d1477edac7d8e7b8693445ac010b81861b42d576be0730edc7f8ff1272305225e4d8579fd353cc8fc4b398b480e324515677fd5cfd892eb7fc0fc9a1e12734ddd5d840f31154b6c172468a12def3754e923d4b4b6cc71b334c1eb868593676d629dfd92484087549caf70d5c9f160b28ba805aedc0e96dafd0e90c001e804311aa4a36da52963f5273259a8ce685031e1635707cec26212a3ba7b222608d4510404f2c95aaa0304ff72bed6308d06e7ebd6b1a0767bb4667db9900e4946e3acf8b59ee75a0c5aec1a9b5774c4cb77ed9c6cb649f4ea67e86753c3151a7a059283f6168224aec05681e378f763f16d451590e6245ec5fec73975d9b798ca27fd0d4314ff2e07e813cc312f1209952a545f461010dda1d5163e3fd3aacbc398e63b595bc359ad832d6e2631d9ecdc87563a1ea2c2a9039b909d3c153b3096fdd02c8eed588fd13d7d6c4350867336f23484663628d9db7c447bb6855c8e1a0e78e3a78aa1dca4e7090c98d12233046387ddfb8829d411739031da4cc11b4d2e0dbcd05f570c57a1f9367077203500ee16ef79ae34024cb227d442219ff0b1eb4eb20c59aee2f710c458931009b7694c031deb87831ccc43788d2096c901b151c7dacce3c735fc8c04999cdb26e9d5efeb548d70968e8993470de9899a6229e1d3ab1c0053b401aa544e7c0dbb1eb291f1334e95a70123aac8ca611a5e552a367bb33947140a9f5dda5938169c47fc6f23bd3efbb9c1441b91d729a5e9facf654c8936c47be1d7b9b00f7aa9cc759b17f2920d7408eaeef194c17eb59373fb89e29d6e6cdbaa971254123ccd4d60574c09b97d3a42c40b1541a0abd8b17ae16f6638a311c450b3231061fae27a2bf68242dda38c7ee66755e13f2fcd0838bf50d01b221e95f850c0b35e9696c63b40615e8f697feebe2349928be1772b843c697ca62ebf30c3b1673cacc2fa811a6ff8895cf2a2c83035d465f876152bd8cd89233760f48ee47b82757131af4d99ba4333b4007812fdb06562ff05830fc617d9003ece61730e09321108b5d0aa7d11b98cd65cecb814fc005907041a81c56c8662b16e7807c793781f58d92563d74c9a4f947af1acab236fa1e89f094e2cb89ada165dbda1a6c2118929cc0e11b2d647dde8ced480b04ee4a62362bee83e6ee910ea839e87cbf1aefd6c2f6d824908fae5de70c6abdcb352550874fdff0c648fc61225a6bbef3628b5b1222803a248d006defab546e9f28c857a16d3c3d96514228f79cbc0ed09ee5a4be11f8278dbf3db96c52ba8a0e3811bd71a2e74f825d67b8a3a7b11a59c872ecc336221a6ccdc93993e93b1317bc2e138a47275444783198973221f350f2ef46fb40b948ba82a085ad93b0d9cb4e9186f3a216adc9b230a4304036cf3dc1a0b71aa58f3e6bd471fbb9bce6a9dbc481d65a5a35f8a494a8b5dbe2d5da00999330b9c7db2ec08d30ae9255f1f573b0e9c2f84f9497603199dfb76d7edbed0738aa823e415f7e88066ed989f407b21760f480f83d40b9ab7d4cbcda0d2f67826b03d1b4580738deeb66087be12bca31db2fefc4198e5c83e0502f051a0b505bbb2fcbdb53decba2b319dafd89f181b70230a42ddda39d34e319f4b16beb68af97e348118c92371194db765a2d63f6380e60316eb99ff55ec33cc035ee3ccfa2db6c7b136c16abfebfca573e57f12857d5399e1843ffca174fbd958b2d2f1f9ecae4e35c60cfc6aa208e2242dde3b96accc9b0276c2cabea8356c599ed104c91dcd5dfccb693ba7af388e0a100f1141e6c0eee0fe83ba4392a494cfdcd5f77228e88f7c9d3b6f5c69d9250cd2f995b22a416d6f666ac2618ced9f815274e18fbff373ea011a4d7bfda17105039bdf8ae7be56d506c633e2e6387a250b4bc783d0119fc759eebf46dac4dbec7dac6a325ba94044e83aef7cfb998747266754cb724e3216ca1192bf330600d311d0c0a958d1ffafaab78e92ddd73a70090da3a648e20dd1c81d0bca65a43e0334b99d0b3b38093589071dc8486a12a8995622d6c8fe534fd6a963e52f31fd3b18076e7e631d23449b9417abc6038e8e14d6b691b7806cdabcdce714263c3954c1027f5440f8674009ce134485e141e24d4254411def2c6a6484958d4ec6566c912b1be8bd5a50112ecc2006a4e24e4b466597e570d317de3a49579fc0363b5c6bde60ef80d23334f83a90ddb2271ab51d8532df93096c7e6b265723a5db08c2596c253e11a76aabfe493582cafd399b9a52b42609815a5feac067c2a6a39b9d653cf836875d79fe9f167bf0e046088898314eaede8a6b8926710e734d368e24095c02c7c962098db6215e11fd30e0c4aec9b586e0acf8ed7ca4391494ad2a9d372936a3677f122db7a6c0edf0061389793e12756e1402eef0eb2a3499f2c9277219ee3dd7c58b1356871f3772d53fc66fe8a2b12c8439f0e3b27ccc400e2b39967fcc6455e5e959f187cc8b5df4545ec09dd130ef1654d58a804f7557efcdd1faf6b1ac94ccd89d71f19dc1daf98e2dd426d95d0712cbe0b7fb099033e01dc53e4ae0c4b3ce146274dd47a5e02f7105eefbba5bf22481dd2e0664f2a9f74f7d8bf6d6bfcdb66cbdb33fff99d278d25cdd076087999f971956b4fe84fc48d543eec220bf054149bfadcf08ba968a1e099cff27bb26ba9996439502f8cec284512a65c6ca360fa92072201ef5b07c2eb8423928173c37f271d080ae654726bb644bbb058a583c2de5dfdd5bec57ce9192ad07ff38e16364bda9651405ff3071a66c8a27b196e919a8771e798c4dc0eb4c2afbae3a9bdb3c756ec53d595815690be7a6093fa4f491f1c0f266b3671e17a5cc46889f2d4ed8d92af840e75a92e1d7d6e1dee51ff6b1d46ad539d2ae34e959c828dab9f14dc0afc6303e9d8af0a4c2b46ebd0d66c2cb24628d805e9d648d0960e3275f41a660e4bb1c9172f090d77925ba89b8ad648f912d0bf1cb85a7cad7360cd44458341478fd5f2c1a19ed9b4e8bdaf36b27e5433e5347fb54a3af2128267ce31d0af10ae92bf75ee1b3f8fbf899cc220c6164ef5b971f8f462903839c068dce500ae78eb055df608fbb1191bf958a47543e962365404f635019301b4ac77d4a1708bd2177f921dd0c9515c55e7574a819cf7f5f301c9cff6b8c6309c30f2a6e072ade6587013f72c38f20e3abbee83150319f276502101639e0ed8bd0865dead37b621fde278b5a19d114fbd0d3fe2063b5d42f96d40422a6c82a674f19b14bd87fdbbedbbc9d60cae0b58d49d88467a34055ce91d1dace14e7707bad6b26214e9de49aa43b9a1b3544ab84af43de4e1d4a83960e89b51d159f6b98ceaa8bfd645cef81f84f15b576b2d3910a1b0a86a213a92af8e2d8c650c5dc8e1c15028fa400699b19fc70581a04977355b5e14026a8fc8515dc98ce2b4905358b2af751bc0c3726dbb40b0ceb89430c9e0eb20ff4576dbfe5adb15af7c3c467f0b400e7384ae6a29c9e9b228c0a105317660b265534359cd6ce6f0c8593511202092c5aedf7d9d7f9ad6d30699cb2f9b337961dfc65ee984a6a3de2322491842b62cf01d63fa9c78df255761196e07077c719fb67122bcf462fd709c606630414e81e502480b73c7dc6e6e4a8f39f3001fc7e1e08d3b3556ba94de2b16295154d0023cd80253569596c81138b13177897bf360d80baa3f00aa3f5be4af1a2aaa008b54979540c3d77b22f155ce07e32b27af0637faaea90affb2c4423c257493dafd0a67f04ff074db2ddf05b94023532bbad9b636a83905826ba6d3e770d4ff059c919331a2fb2c2d6691e3132051e08d26fab3acccabf1ab5847b225923d996a2eb63aba25f7c4212d83fce0ec8ce40279c952f2a9e43da20df086afc1c064570820b5c3e6de32da3c281227ea5914cc776b7fac8c98d50ce2ba0bc13921705cdd7baa5ff62f3423e0ff25353e372f8e56792a2c480fc29be2bee32c3842550c14ba03d971a154eabaa4381e8701959cf4b7de3442b66f9e6951f216781d2e762987268785c00752c35e38584daf0ad659fe0e3af43d61a6d37f8323a1994d331e3700806bfdeb3839494a4bfa5724b2b1a5ee9e948694e34d0829152c503397202101d07a386d7eb34dfc5f201277b6b0d1e24f476814f74d80a30890bf756d0ad87a1c35df2e698e937cc11a6cae03718f44e84c3f5d9173fad187ca46ebfedffd5d2d886401163e7306efe5fe862711639cf6f8a0bd5f8677110a97e3750b8bccc47380345a7dab085c28344696734d470e670f1325923e45364ec6056254a94930a7149c7a925313fd6c95234c6da38cde88def34b4a389727ac56a8cd44fa144b1efc2e560d4d2b8cff955967fd83b581e76b98984f1bcae1d8f8dcb7f96f462b0798fad0c529fe1565352d716bbd8e9d5658f60b492754427dcaa81ea1ce68d812bb49cdf38421e5918ad8cfd02af0d3fcfb6baf2cff32b2f597ae29105d94c0dd765186b51ad26c32c41b9bebcb61c3b0b2c23a898998e8b5dce61214935a87fa8601724955b988174d0217412fb398ba164d9b965fd6df9322d331597c27ea6f740d1e1ef1e9c8aad82ae604632607a0e16a07ee57e33b3a82451280b6122d14963d26717baff3bead80be6cb55d10d4cfb758e0a656ba839d76438416cb68d029d85c58c0b2a4b85828c09dcdb9c31dce9e4ff1949e6af4d64328a4e82d9888c89feecb9f0ab41cc3388d23f30265ea40ba7caed9b658e0a7ea915cf1b0f29b4f0977c8db1b45501d2be5fbf3f4debb69cc14128aad271dd481358e7c0ab7121b7590af31bf622b48e19b4d76d53407937c45d49bdc6acd3fb392c47af3af07b4a14ae1f6725032b852a4340e77a830a962b2268eeaca755c094afc7b6a0569292f7c5fec15f8259dd1e18314dbc9beb933509f41926214b97001e80dc63ec011efb6189d05c34d839cdcceb624c094c226e2acf64b4ff851401b35f37460848e21b0036795826c96f80eb4a5d6d3f0e4005c4b117b3b262924bef1d73aa37ab82f3d368bcc94cec07f3d6ef906ca86084bc9f44973fdd1cc1245e4f11bf581a9e254548b3a43733942e894e76b51a21ac7cd3acce0e749429b6b82c63b2e5302cc393b02ee69ef7eb9df26ee80a28383d1b80b5c9a9f6cf25deb65b37d98251a69e9026071db2013949c501b0b4d28e94a160c1dd780a55923314df5aa98d7bc9f4adce2979cdc5f0c745f332403310830f3da7ff508e9c6230e3a2565ab36deb7a84b0d721b959d3f6beb7b0de5f3b9a4c717141371c0e28c0c5a83127d13318d81ac545b8a202bec7aaae729b737e42aa8b84f04565a826954a1e343df7464d4d4fc378cad238ec4e9a4dbc7a5073f123b04a2f7ddc81ecf9761ce58d22e2bf3cdda391bc1dcd33ca378d4c2c11c87616a00d17093fd9715d2267da23eab609489d676c03b782774aca6dfbf35be086304ea99956fa27f187b517682c811b7e4cc75bc8313dc9eebc8e7c542a87d4954889323a90f4c11275afcf66d4f3527d040912aed134aa814b0959767685884c70f11769faef523e491eb51600b6a4320882fc7d50a00c689a19d2419a2071166c87c50f576774d0e7b17b656524e6b80b85e65db3a6a4f3ddd528f936d132dfac9d26df2b04e8a6331e31840859f9ab5a9a2849f7c86ad3e2e275e7e4e9a6331369927a66b19ed3bf55123f72f3c2f4281f2e3d6be06e3f179c3c68533e00237db4edddec40baa7c94f7a5941a0e5a658f074ce33d8b0b98e2a95e396379cd29469754c6087155e77192774fab8984e038b925a2ae01d1ac8565dfdeac164f6ffaa0ba2f276b3b2770a4be85656c31a8f59c911d8519acd178b1010c982152f4d3e08eed069837d1dff96aa8c980a66b70cc2c8c23b5ae09f5a93c5a5e9d1934671f8178e1e957e1a8d6fbde4e9b2c0fd34086dfac58f10991ac6619498b91d44a8f57e97dbf671fec8225b3de63c189cecaa4876979c9866a659479c2695adeeb6d8d97e6207d6fb8df531a813721e147f104ccaed8f05f17c8f842eec72716a21d64e0494d63653a38925d389c3ffea84508fe2ee6b06322b71dab20da4ce3fdd19e32ff0cfd60994e83eabe0842db6e1886ad6740e58e98a4a2501f95fcd1105544aabdd2ee6e89f41f6c902b25cf1f9f33e08de3376492a2562ddaa8927cbdd2eb561192e2fe331e65db6460df35557481926449aa93267faf72d87745105b39c8ddef7f7e8640754fd601468526c1aba0a1b9ea27067a6452ee3919c75d4373aac31a65f995ac574f6dca2f8730cf7c94081dcd27377a112cecb9ee0bd61db3cd0525a91dafe52adf072bfc8ff3d6238d4f7a65592c35660779ffcb30754023555ad3c32407d174e23981043b3b6f9a671e4398d979a0395a49ada81d3e9154bc35b7cebab3315d757b55cdd7567c878eb420852d6942d8ccc561fd0e34cf81de165a3ce6f10849525f247684522adb8d90c3fb1b789aecc6b11e5abc6835701115fdcf0c89f06fdb691b09951204a77af8ac04068045368a7601fce40e060df10af34a941445cdb4a6cf0da11b0d219c9768f6b8c9d3ef6c1b61904b0e50143b4613a5163aef7fb06eb26a7ebe75f07f64c25c18528d79294441d651e091f68b8afda10365132c6ea40f26a5673e82d73424eeb41ebaacee794198d6462a347027a2ce1e1fdd855fd2803b1c39143a692d3ce5d521ada296d446a448813030f5b8fdacbcdfa1d266634bdee44ac57d616ecf1eb60eb531c7ba2e4fceef13d36fdb4c73ba8c00a132d91acd166261a7a5321d19a280c55d1f350bb61b5dc249d604d9ce3d53a059bf95e6df4bd14d56779ea0d92dae02d156084a718fbece7ff175b5fb13c684fedd5f3c9ddd1297e9531a1c1c369b1dbc3550ecf3d06483641bdf5e02d0ca59b399dd87a8ddeb64304931776eaa11213f62278276785e1bf73461e532bef7ebfd789e5e3992e733d8f376a2491f4d22817c26fda18ca4304f0c3ccdb1b878f7ecc086d068699b61bab1f1439fa94cc66365b699ecde8b64b189b14f948dacddc1243b7056f09f3e41fdb56d9d23f867ef6b9d60ebc6515b40924c4b3ccdb63794077e84c75078ad4ae467dca3bef1aa851df29f2268245377b14807ed1bc7b4b30f44af14d1cc72882faf49bb10da3a1e6a731fe33eec30569ca93ec496b67ae674b6505ab92ee8d1169569b03c798edce5416817d132ab074e4139f6dc5374d91f50896d890c7a84543351b50e1d375f823f7cc883c11176b8b3171e5e6fa3f5443062c545b72eaea734e9e57ab7802f177e7bcebe9d5ce7167fc1863b640c6e19584e4a00c64501b2114b2791add58ec70ff9a23850e6abdd00688c4526fb5c5b711a2bd818aa7125670d1876dc7591e60f31f6e916f14797903a11cd3e584d8fb567e9bfc78fe01e75604d4b777ba3c8a8a23fa7061c5675000496609e0555a976303d68e9e1f7b739fa187d71706efd10a9ff9238cd079515b8660b55a919f7ee44d3e726e5769f60e9fbc194b55b299bff7af28f4b0fbe0fb7356728fe33baa2b53779893712c8dc3675c096a2131c6787867465b55ae82508fbbc670027fa53ac3fff276cfd347a5f343a15822d2ae8a60f99b425ea5e16ba5dc90c17155e57bba38eef44f9ce1a52791c52134eaff164241ba32fda1179241751afc3cfc65b340ec5bf938b1b2a6aadf4f20b50db17515a9313ff916d9fcdd8473d4e45520a6e14767d549797d737d99611e9cfb1c50cd9d90f51fd33df72450a2a6074da452012514f145f524f579352eeed40675719c3cdf28509ee74e8f58a3cc1158e8fac5d98e6d978c8e1dd6751fdb655bd194b4edf3f246cfe6e16559047ec5cf4928804d57e2334d6ee3e8acea247c66d22e74a255ebf13b66c2017497ba6bf89f3e70ef640a9a63fdc0fe320a698322173b8ae82118b1f65da15260621e1fb2968ba67962f248810f75d5e5317d5850257bbf7269bad0a97a75bd31dbc890fe3e6fc04d634374f6f467c73b5babef2ed0280267b97f813f0f9f9c52f8a76df90654f531cdf10da14bb0295cb80f434e951d99dc1dc7d83c165574053838db5ac2b3cf6d249d2cec39fd3d96cf0f26c860bb396f37529b1db4f5eae435d0f5ba5921991ac68e237616c37b9df12aeb316eeea4e640590da4137c097d53db1d3cb2063dbe3e2c11a9de74f5c1ce0531d773a8e3e0053baf3dc970587371b575d03d9f072fb0f9b3823a80de590801254bcd6a4143aa378162aff90fa86a0caf9d7e310c151a443e7f559ae12a425faa8e61cbe3d15572bef4f3003f6adf45ce628b81b806888de41dd44ae976522b97f52050516112d39d874ed777b3b2615d391a45ce82059136e567811ec7de6016ae8999b2a4cfe5e78d089b1244a09a4fadca23e6de3a5576a75fcf1ad86f8647f6a37579549867741f5a3fa6df70abd0b5f173efb0dfd8ea2cdf7733520b5b2e1813d6e74f1d2d30df4d3423b0d72b1c0e399f6e1e9ef381cbf875a7fe4bf10c8a18d63bc3fad809546d60f897e8eabd87e727a585c06d257a99e4f60d68ce47f47bf569d9fe1a6b6ba5f97ed9a4b37ef40e08cbe9edca9a36ce7def4efcf17e256e6caf92ced041946674c6bcf08a9183af21cf4634ed6a92ab8307577e1e301f631dd7ae691cfb3bc2a99c4ac6bd00d27cc2c0412d5bcfae640b298c783d5f960d21b09c4b1dfd8984e41fb26da92a6401e3ca6f4b02dfed46a6464c05e9e7efb7af30361aac0475474f0530542afb980c343fda14ff40c622358d98f0ae8a2f7105dc008da5143ea4e8dab173d78107d9d3e170092e9363cd15523cb3f1642e179a31dc8fd6e8c478857318056f5a5b6612e955995351f1a85316777a09e92b466d683b45439b9847b19b202916fb440e31e9adb0b71614e7a6beb63faf7ecadeb605bcf5ad70565f0c88c7a205ade7fbc264a1648fa7158cec4eeaae81c3fa1d9b8805760045815f733963a5ed89e12d3088a9eedf1bcc4f0b8913c087e6d4dc33472e9820ea9f4051bc38af3d588e2d67f1d4a00d86557b9fdf7828d1beb247f86efb59d1f302208b2d60e2dbdd2118ca76ec2ecf5b7a6ce9448990d584835e2893244c97de19f63afc3b8873bb258f5d5650095c32c233173d08eaf2d169221e0625acd4f7ea24462696cfc7840449c6046e0df2bd5c8626bb66cdad84248555f872c7c2bb763b368961f1b01903a65557e692b7b183eece4ca1310fb2f5a2508c8dd01b9c061ef9f12181ede6845ae11720549deaed59701e0e4271c3625d3c1e68821b87f7d22a80ba34bae9b7c5250015b35a7163d4ac69a7723b73fbf0e2f810aa66a216c8762175de3767d98cfa264345ad897967069f4c700524d384b0f1ec643e7284efdf831e3735a3c2845c462c1599f3f60a0023ac30fd3c673fd313c904a7576b12372d3af5eb1ed38f6a8a12ac233725df93a22d2ec066e50c8513f77eb4be4a07acf7e61a9eedb2794fabeec488b536943e3927848987c1fd39ae82c84ec77a1f257a2573489a4ecef6e44d3f55a1c02885b294b57c47b46e0b2071a1575f3c9936a6c057fca3a08941822df617ab3b578c03a8ebd00e59f5f63299e42651fd4f7941678861271981ace4406ba7dadde9788ca0a8fdfd17761c9823a467ebba15d5393ea4350e47200a7e616cf45f5949056ed1c4bdeed75f54c70924da59e7c03b09a5d9b790574ceec638831d6b4959d6130d7498472882b74e9087813c4b17a463fe6a1e90de323b06e68b7ab0b0c939d3774dccffc42680793c23780144280adf66f9c5ed88088dc2dc7860046ac8a3bd10f40f1f880c5e8f1e199f0d83074077b0b252f54782109694c57cac563cb2cd2024b8c551fb9a1727a2ee9dd7aa55869477051e72187ee18f969818fa5e5049ca8b6a03f570ec787c651fe5234d33bb267a6fb37ff564e6c8afe2a53d6ec55a99ede3eef9042e74d20881ea1f51f670460de31d28ad3388189bf0f9662c13287a7c1f853b86df4a9377c19f05e4a30f9038ad71d6a40f3fa179652768b70f46e72d345371cef9f3f9c7ff823628e0e6d28cb9e5489d2629a945249391ce81e972c42b00cfc163b36ddb90a320bc7eb2a0b3516d5e42a4adf94c3282c0c9fb1c547b1d3354eff9f65f2f225f6eccd1972e2f955b456fb07ea6e54b848d2b63645623929fcb188aa0559073b17ebd2ced2bf085bc37af49c9462a2eb4d8b7ee140fd33deb2c8568c84bcaf68ae14b76b76add3318b5257c7c4f1d2d15d0de508e57413cec74bbd58e4eff01f1ec3dea2e4ab6bb1a423f3863b6f59b178d0c90c4f76a40e4557f2e7e09417297cd14bf851a92d2d2d25c81e08f0e9034026e9373f743b46142dd6a01681bd817c5ba52dfd0bdb00f7f552e177694d06f58c2774679fb3e34031bf6238f166df34685d1f89a7284199ddbf2a8c6923eaecb40cad73932746c3bb719e085c50046de20be363416922bbbd68ce71198c6b040b542489b98c51eacbd6c386d71d5032ef882c63e48593782ff861fd5a5ad3a33a7c5b9add82d385445f2c3eae8f6f4b200923c1e5b2ae62321b1b95b94bef9615d35703d6f7913781989e17fa8786eaf2850f8d7e10213c47f7057d0c04f4e0cf3bcf79f8ae1c0174d340136fd1e418abfa51977000b5b223b30e318a81a6c38a2a2997853ef9a28311982b52c2208b33a1f7519311acd518d13da024bc195abf7c934c4dfe1e6e42cb8ddde0b3fa67f5c6c1367e0db8e54ac03d32f02d66d6e8e23d82d46d9b0e5e5d11e492bb93bda58d3e482fbe9743ac6ddeb88f207620b15854804ba906caad76f4ce444ab375ed8a73e27d73d90312f064fb93d409ba84741e851b52fee212e9b3f8abb2119afc4e871ebc5ec9d2978ef4d12466e0db7f93b73af5607c3ebbe6e8a376d9121ab3afb591cf149ecf80629ff0ea17ca969a99947eb78a51465f7ae5ee57eb50031f41b1d26e91eb7205ddd141a77f11eddfa8405222b091368dbf7423f709a9ef870f60d19fb9d949214a7c396dce8fbae0b61496ff4622126e6e5c737ef4d48a6465d8002750a238f7a4849fddfd5765a3015d67390a47561514971c8cc6cdb70d64852b33fea17b4374b60ad3b3aca9ae6fdc2c2fe94982710fb60ea1ae105b56670261a5f681de852fcc904878979fcb6eb96a64ee18ff3afe7673bfb54af1dacb961cdabff73bee8119a5b716649c01c61483fd7469ce03c1469f6ea630cc1c106b8c7f5f0e72ddd87e6324aa77442bbded40a9a66dfa60e73572dec25bb457db4e26abf5a92c7ab1f70c15a03f861c36dcc900aa8a35846412447dd3790f5431940566660d55eff1e5b634f6f18b33a4a5134403cc6fdc1058a2ca742abe01aa583911b951d3f056b5b7a9b6c1e639fb35a7f12a0773d3c41e019d18ccf224c16994d1f35576199e91070b77564997c2d2b6b204f02099f737ec574fc7eab733c513ad78d163ea7199e23cb92721e6d0b5a4ec930099e780ea4089947946dd08551c607ee123c547796f5dc955205e57a5a563294e23c0f0a248c8ff6131aae8ff3d9d6b5dd536ae97b5a013fd6639d9b0a489cd76c4da9bfc98f80bcfb6ecfbd02a9ebe84e46ae80fee5339d48f2e9b3ff35e2f957b1195ca99dfc964c0c368dc8baf5bf03c5c3991091cd589e08f4fa0ddc04a072db07b92c9ca3f556479681a69650067ed2bf8f13e7b4881fe837bf0a57fb96f067cc244d1a48fb8de702af23612533e2b39db993ee21fefee55a57fcf5b95820750907442c9590546e190d49177cc60749e09838f8d6669095363b69d90f532a5c74613f9798f23ba7566d6c7a479464b6a28efea934db05067447dd3172a02dcfa16a7f2bcd25d3980eb8baa3e416149751733afb658640a30358f428f9aacb8336c9dddbbe4f88615a75c18ca12298dcdd6e9cb5431beaf20eee4f74e3b1c3ffb8dfba34f8517e099437bc96a62e3224cfe980fbf1fd0d6bb6acc90d70519cfdd2030195180ad60f06aebb2747ae767fc41259a6fd47c52adf33e1a4dd082b3f4f502d8f777cdd4c3e6ddc24b91f493554e34ec2d8b6adbe096ffa2d8a2167ebffe93e26a866dac811cc2f12bcfd3191ada55e4aa6806ea6cb94dd97c14d3f2867a2000976fd98002a6259a67ade98d576494cc94782b80dcea6706ef6986fd4f97d1f705b9491da6d452dc0c707bbfcb8f130a7f1de014b2434c6c95c61c5f15b3f9e851ee2c0fb104299e1342410521835ddc14dd003a869284143101d99cbc95dfb4e026c90deead884a0cfa088f20cf7a8e9a7d7ca352f079bde7b37bc9ad1eda30018f9287030dc134bfc686f1f0bf48598cb36b0bd19b48037fbab32b5727288ef069a6a52f4d174900a35335afd75667de255d5400733e48906dad3899e16245375a2fe851609827116a03f617b3e8789eb94094e49624351030685e94e27a0f7786dd7288f4dc901c2ce0990d2e9af8366227d1b75f4bdafb25de995f7bdadc156292f0f4d724eb7ba159578b62fd10aa83580c8e4117438791c862bb1d1e5718e4bfb154c28fc99e32e029d52902a3c669d609d19fafd5850fccfc65e118e8df34a67d754076a7bef637d5f20ab851818f328d96d0f707857745def952c8a97003a5267bb4fb2f784326597d4c5caaa523ae915aeeee7494f4a4a93714c4d38d73d1e8c1df8072d9bee10be263ba6d938bea8f113bed0fd97bb96c3a23269a438c815597ed53d3df6f6f8dd6e96bd659df3ab5ff4fb457b80470fdbf4bb2bd73843e597b82041f7b939aff71465bd7f3c27328e9014c6a963c5d56c0e7afaa7abad88fd60516894f9b7380336d660177fbfef3ee22fd1358388d8ef483d5868d8c8515eed3642ed50248c729b2b8a8343fa73da917330e8493d0bacf075ff150eeb7ee6c3ec0cb5085e7a18978d4129f4839afd26532783c174031998113df1481c95eb2520af3da8d7002b66e615bad109c87e3f38d355329012cca0ddb236da692f60f8a1ad77b05b850e07b6cee6b3a46c3ab94f130fedf8bb1ab8afda5a0b8dd647467d5f9a0138c3f5bf4a92c1d5c01392186026f536cba38679550ffc3e5804d9ee82e1aeaee109c241f3c057808c37f26283585af2d83a8ee207c07d732c0d2563e188105e052ffaf6c56922a9f45a963460ec60fb29f8e4304cc6725b08b1b6a8cd18818d7fbe5c3bb408858b275eb36fc1c17574939d6db80797c5cb4dfbc860b58337fc1ebdcd84b94f04bc9987e23783bdc1995a3a43a44ee192dc4b1a6b0a0e972ffae0d4c1317987173807807e4ef42fd1ef11507011f28c84a3c5884f854d5e1544778022018d5ea2dfe33a0d3d4c451af570e5a67acfa31e6b960bee7bfe6b28559e85d0f39e31cd350a014edaff51cbd279930489e737d634490e42013fce4cc69f2c560262eff2640a6314acca59c3740a9e803cb521a2d81ec578865fb352d50ef8b73205a8cc81b4ccc2f64ee2ad4fc7dfc2a122f73cfd178cfb2bd2b60d4bb9ff6550c01e6b6efcecc371433143ab696129b8a31ba930eb15a843d8958ae374f1388f4c14d1d385ee5f96822e1757d134125b30d5b71f0d4419890fec7e68e75945af981935cce8e915781417a3c1678f7fd4b7623b38ce615a2454f1c61e70ba01ce9d0e8078bfe92ae8b48ff96cf3f859adf54303fb0e8e9c78ac813b0cf96608ce4247998495dbf3e53730a6dacb555e530417ca35579ac6bc35a755d74a6975e615745353f6faf115dc6853f29a7a482bfe52e2805ebf1cf4c3f6cd87461bb30b5efafee706552a0b6b0f5d957643ef91cf0ff8ca18249ff24fb740e4214f8b9ca44f8f468e743f140b23c1cb7aeb8fed7e1a24605da7227e31e0776a08f471acc083492eb482cdd2c0a8be624b78789a9a4b7942aded14dc160c1ab92a41ea7679a3b17391dce02007f648a393c61bf15da5b161911979937feee1ecf6aef0c10dbd151933a4f9274b9806cd56b8873e080eb3ac15e8fec27e916fc086a5414c366706421be98fc6375592cde44c74a5f9d9d93d023283fd8bea325d390b34cffba513152b3f01d2886be0906d4f69168a0b04159a5d272ba732241dc905cfb261f55b0a8237b5d692e530de9ec2f18a686e5cfdf34bea6138201949b04e56fd66ac72da1c38dbeb61696f4f1f980a7fa50d22493313be8c0f41352d4c7171bd2f41f07b45e4d9797fe9ff42354d879c67c1092bf6fdb074faf580c4813d88a25c65c41de2319005992e71f525fdfccadbbdd803789443a45892dbfd1807ffb8cd3e67852557daf59f7d116b497e8c0cb5a5b1569494bc8710cd58bf0ef0c18081de9e8f679cf51134805c4db832e2571061fe43a22f2d06c2671d8f84c71f848414441ab90fe6d6b676006ab6374bf7c0d7b5e121671500b07f8efff88f6b11ed1401e3c296a0df4e3ed6d31cd8bf1db20b364e6e512cccba4461dc29ebeefc6d0194cb34dc9a06e7a1151bf96393b1e65ea7edf4b1dd746e4679ccf9ff0cafbb3842e12f44cc192a368d336a3b2e93c7c5fb4a22b575fc1d4ba7abf09023af18334abaa388a1157e7fcdb8ef22e045eb0e58bca3d39a54ce805e8e1dbb5bd9b97ba976526ccf8899677f53c6a4e82af9113a44467fab2cbb08e6f70440bde3107dd646ddcbd72cb62c88ed4cf32a5b441a0ba5941b75d575b75b11ec8bd6ff08dd0cf3acd3c6b7cb541fc33b907d4faa29d46ef8bf18b00ba553df64515bed1ba1e890d2d2c26bbc1dc5af3fa4e2e7b84cd0cb9a35b19c551cfee6f54e7c20478613eaa123a878e168f528717d1f9dcbfe337f315216c07f53140e88074158a33350ccfdfbc91af414931edb8c07ad4ce8d918d5db3b76efeb35c0cbfa4e2a7176e5c5f99de7ce5c61b5b84150406aa277bc08ea9e82630983ac18bfa28b6debc00f56c5990688e407a16793df1039729641d755ec791f63704593def280510594ff5fb845f5aaa95b5e5908b12b3176f6fe1072e2b86208c8b0682aea2747585fbb1ab423b5e02b206a942b4579cc91a16572fbc621e7910f53608dc9a1d255a63b25017f9df091d24ced6ba2705385e71309d67dcf11ca1a2a4813bead1c1f49b0a551d1de46fc4cc5f71709cf94093666679300c28f9e879c3003f8d3f6e0da15039659c707f11d31c5c10daaac0cc48ad5564e7d6a7a0045fc63644099c216bb55d1029edbd2b34629cfcbe4ff7777805298114c98c68d55e4d8838960dd12769867206e36a45d001f24ff2e59c0af48ee71896e08ea9286304a4c5438aa6c2f87ea080b2d2f803f83955898e344224ed187bcdcf69bd5e224dd86d717a009770683721d07fe12dcfc2dabe3e74eefa3947d399654b350bcdff5dd07e488710f945427eeb2eda8e6907bc2a63317600e3e7addde2eb5a4843417602477650906d399747a30d9aca28620aa943a4407fca0368bb228d554beab8f2977db60106f3796426a04f10128f35323fc2bdbd71e5abe4a6c97c5c9b02d161e98f669e57b846f425df8bc68b769331d06c11ef398b072b5487fd11ff9a92c5d33dbd59c0b46f54bf71b52d7a7660b32e8de40043758dd6b70cb3ff056bb3a5bb712fb0b31903e129c363686622e1f02bd4667b92c8952f0f307b1ff1a340873362a1a6128a85bf4bc9c806076fdd6ee23d8814576734dfb73abc92848c93297a22ae03d848b5abe9b23a95247d26398ec8bbf00ba97b2bade9297de40d5259c3f950291a55b0abea4dfaa33aad99484923d4b4bf29238aebbbde03a3cc20a792b02ab11f5605a50e1c983e5934170943c76ca7d76971b4e475131212c41e2626d3c9d216f5e251812ea74e5570d147f38ea8066c07f329bb5c5444598f2ad202485bcf6c90375aea4edabe4994b2a6691f7f6b3ecd1224a3594b58cdc5a331d001fd89a1cdc32614fe3bf21a39dcf5a279cb58ae3b2dca55e40f1b6ff91cc8295dfcc051f62d8f4a89df11b9e239d0a88fe30d80df146fb146a7e2a0131b036b501fd66ee711e845a33e689b4e1c62abe2cfeeae06993828f9c0faf4a73be7ff95fec518b4c99e4fd57eb4897ada218185f1622bc8b6684497995d4ca32b52ae4e332df463c46cf84e430dfdd9548fb1b6e226d7b481e35e9ea3003d5bdd1b4921556e0f3b1a5c28b5c985d9c44c9b32a686fb24831c78cb398dea6e7b083cdbe748ffaef782a56c1a094b1b89f2191048ced226b2e58c3395a9a1f912b88cb261771801e4c90b280d246d1d067bffd7a85cf3653e758251c369df1905bfe7031c38e7055b5327f07683f63b1826e537462a2ce5e76c6e520079619005ab9def8e33d6e6b3e8f377267760d21be632314ac6b46c64e808d5c416d856182a50920359ba616a6db95d93af157ab8f2255f675605e9ff9106ca6d49b8a85cf200b3ee7aad29457451fb21846d891f1078cdaff3cc2d77988b7055cc2864f51697c0fef38f99193e2161dbef992f1d68fc2c7126424c87805435c64aacbd24e3d40cb8f2d4e0b67e39d2b5b8707f81ea3f8ba0109afa83a4c5b634b604919adcd5f2f3900060a1c3127723537ca84397867c0be779573e893efe0169215050cb89b8ca63c5d36f96a4cbd5fbc79e377cf4430c88aa9a9d4a6825febd407bb53ffeec6b33bf70ad689c7cd3154b2f3234156f3835074b0f48e21f54e47b992f31dc7b5edb781858230bf0ee33a2c062ec0da80738d8147193f6735b7c6816dea44f8d615be0e4bcb471577476be79d046c69c302e5ffe2f3a6b683f46a4d345ea477c8a73770a66aa4be36f6efe7117c42165600a51b189aa7ef9d8d2b1d1f060746d44566204b386e472957c1cd24a1b9a9e9a994def1ffe14b346fdb74c00bb89df158b3aff8f49f4d44fe40c91c1c54f6b45b126918b2a667063013a5b531fe0d8eba8a993dc21059d3661d1ed857fb3baa58425d4c6cd6c84abfe3c2d6d91a6455aa0668cf537bc6220be480dbbddf90fa622062c40626536a4a095be726dfc2eb0d2cde20790a60c88e0068a2ffe71b90f5ffc5d42c49a561d3d690b11232b29559e3661bbeeeaede7cf196378bb820473e43999831a94f6f4a8c8cecbb996533fb3b37357f3664b9feea7e42e8ace7776cabbb48609e8000f217a95f6ca4120959cb263974f1b70b68930a773dd27dad0624126b9d91e2e7dbb4ac5b2ef3819fad529b1453915fdb506d1136dd503079a7b1877eee32c8bc5f1be8adbdc09d3f881313f3e82f6338a0d46dc9e1cec35df13974b3dd152b9958bc38d70fb9b0acb3dea00</script>  <div class="hbe hbe-content">    <div class="hbe hbe-input hbe-input-default">      <input class="hbe hbe-input-field hbe-input-field-default" type="password" id="hbePass">      <label class="hbe hbe-input-label hbe-input-label-default" for="hbePass">        <span class="hbe hbe-input-label-content hbe-input-label-content-default">用魔法咒语解开它吧。</span>      </label>    </div>  </div></div><script data-pjax src="/lib/hbe.js"></script><link href="/css/hbe.style.css" rel="stylesheet" type="text/css">]]></content>
    
    
    <summary type="html">这篇博客被邪恶的博主用魔法封住了。</summary>
    
    
    
    
  </entry>
  
  <entry>
    <title>[IOI2018] 机械娃娃 题解</title>
    <link href="http://example.com/2021/03/18/IOI2018-%E6%9C%BA%E6%A2%B0%E5%A8%83%E5%A8%83-%E9%A2%98%E8%A7%A3/"/>
    <id>http://example.com/2021/03/18/IOI2018-%E6%9C%BA%E6%A2%B0%E5%A8%83%E5%A8%83-%E9%A2%98%E8%A7%A3/</id>
    <published>2021-03-18T10:59:11.000Z</published>
    <updated>2021-03-19T12:40:07.511Z</updated>
    
    <content type="html"><![CDATA[<p><a href="https://uoj.ac/problem/408">题面在此</a>。</p><a id="more"></a><p>第一想法是对于某个触发器，它的出边是固定的，如果它的出边集合大小大于 <span class="math inline">\(1\)</span> 的话，就只能连到开关上。所以就考虑用开关来表示一个触发器的所有出边。</p><p>不难构造出一个完满二叉树的结构。按照题目顺序把前几个叶子和最后一个叶子连到这个触发器的出边上，中间的叶子就全部回到根。类似下图，其中 <span class="math inline">\(T\)</span> 集合为某个触发器的出边集合。（其中 <span class="math inline">\(1&#39;\)</span> 就是 <span class="math inline">\(1\)</span>，画图原因），路线就是 <span class="math inline">\(T1,T2,(1),T3\)</span>，走完之后所有开关都在 <code>X</code>。</p><p><img src="https://inews.gtimg.com/newsapp_ls/0/13304049297/0.png" /></p><p>仔细想想可以发现我们并不需要对每个点都开一个完满二叉树，我们完全可以只用一个完满二叉树来存储所有的出边。类似下图，其中 <span class="math inline">\(A\)</span> 是给定序列。</p><p><img src="https://inews.gtimg.com/newsapp_ls/0/13304060750/0.png" /></p><p>路线就是 <span class="math inline">\(A0,A1,A2,...\)</span>。</p><p>这样我们需要 <span class="math inline">\(A\)</span> 序列长度为 <span class="math inline">\(2\)</span> 的整数次方，最坏情况我们不能接受。</p><p>考虑 <span class="math inline">\(M=1\)</span> 的部分分，我们可以构造出来一个这样的结构，其中方点是开关。</p><p><img src="https://inews.gtimg.com/newsapp_ls/0/13304110559/0.png" /></p><p>我们仅用了 <span class="math inline">\(3\)</span> 个开关，就使得 <span class="math inline">\(U\)</span> 可以被到达 <span class="math inline">\(7\)</span> 次。</p><p>考虑每个开关的 <code>X</code> 边贡献，不难发现在图中标号为 <span class="math inline">\(v\)</span> 的开关的 <code>X</code> 边会经过 <span class="math inline">\(2^v\)</span> 次。所以我们可以通过对 <code>X</code> 边的控制来使得 <span class="math inline">\(U\)</span> 可以被经过 <span class="math inline">\([0,2^3-1]\)</span> 次。</p><p>我们把每个 <code>X</code> 边所链接的都改成一个上述的完满二叉树，我们可以通过对 <span class="math inline">\(N\)</span> 的二进制拆分来决定每个完满二叉树存在与否，就可以通过 <span class="math inline">\(N+\log_2N\)</span> 实现按照顺序遍历 <span class="math inline">\(A\)</span> 序列。</p><link rel="stylesheet" href="/css/spoiler.css" type="text/css"><script src="/js/spoiler.js" type="text/javascript" async></script>]]></content>
    
    
    <summary type="html">&lt;p&gt;&lt;a href=&quot;https://uoj.ac/problem/408&quot;&gt;题面在此&lt;/a&gt;。&lt;/p&gt;</summary>
    
    
    
    
    <category term="妙题" scheme="http://example.com/tags/%E5%A6%99%E9%A2%98/"/>
    
    <category term="构造" scheme="http://example.com/tags/%E6%9E%84%E9%80%A0/"/>
    
  </entry>
  
  <entry>
    <title>妙题集合</title>
    <link href="http://example.com/2021/03/17/%E5%A6%99%E9%A2%98%E9%9B%86%E5%90%88/"/>
    <id>http://example.com/2021/03/17/%E5%A6%99%E9%A2%98%E9%9B%86%E5%90%88/</id>
    <published>2021-03-17T13:53:22.000Z</published>
    <updated>2021-03-29T12:46:18.442Z</updated>
    
    <content type="html"><![CDATA[<p>一些神题。</p><a id="more"></a><p>[SDOI2019]热闹的聚会与尴尬的聚会</p><p>给一张 <span class="math inline">\(n\)</span> 点 <span class="math inline">\(m\)</span> 边的无向图。选出两个点集 <span class="math inline">\(S\)</span>, <span class="math inline">\(T\)</span>，<span class="math inline">\(S\)</span> 没有要求，<span class="math inline">\(T\)</span> 需要满足其中任意两点没有边，<span class="math inline">\(S\)</span>, <span class="math inline">\(T\)</span> 之间没有限制。设 <span class="math inline">\(val(S)\)</span> 为仅保留 <span class="math inline">\(S\)</span> 的点和 <span class="math inline">\(S\)</span> 的点之间的边的最小度数的点的度数，<span class="math inline">\(val(T)=|T|\)</span>。构造一种满足 <span class="math inline">\(\lfloor \frac{n}{val(S)+1} \rfloor\leq val(T)\)</span> 且 <span class="math inline">\(\lfloor \frac{n}{val(T)+1} \rfloor\leq val(S)\)</span> 的方案。<span class="math inline">\(T\)</span> 组询问。<span class="math inline">\(T\leq 32,n\leq 10^4,m\leq 10^5\)</span>。</p><div class='spoiler collapsed'>    <div class='spoiler-title'>        题解    </div>    <div class='spoiler-content'>        <p>考虑贪心。每次选择度数最小的点，把它加入 <span class="math inline">\(T\)</span>，然后删去所有与 <span class="math inline">\(T\)</span> 连边的点，并更新所有点的度数。</p><p>设每次删除时的度数为 <span class="math inline">\(deg\)</span>，那么就有 <span class="math inline">\(\sum_{i=1}^T deg_i=n-|T|\)</span>。</p><p>而对于 <span class="math inline">\(S\)</span>，在某个时刻直接把剩下的点全部取出来，最优是 <span class="math inline">\(\max\{deg_i\}\)</span> 的。</p><p><span class="math inline">\(val(S)\)</span> 最劣的时候就是所有的 <span class="math inline">\(deg\)</span> 都均分，即 <span class="math inline">\(\lceil\frac{n-|T|}{|T|}\rceil\)</span>。这样仍然是满足要求的。</p><p>所以直接用个数据结构动态维护 <span class="math inline">\(deg\)</span> 即可，复杂度 <span class="math inline">\(O(T\times (m\log n))\)</span>。</p>    </div></div><hr /><p>CF1174F Ehab and the Big Finale</p><p>这是一道交互题。</p><p>你有一棵 <span class="math inline">\(n\)</span> 个节点的有根树，<span class="math inline">\(1\)</span> 号点是根节点。</p><p>这棵树中有一个隐藏的节点 <span class="math inline">\(x\)</span>，你需要通过询问把 <span class="math inline">\(x\)</span> 找出来。</p><p>你可以进行如下两种询问：</p><p>1、<code>d u</code> <span class="math inline">\((1\le u\le n)\)</span>。交互库会返回节点 <span class="math inline">\(u\)</span> 和 <span class="math inline">\(x\)</span> 的距离。</p><p>2、<code>s u</code> <span class="math inline">\((1\le u\le n)\)</span>。交互库会返回从 <span class="math inline">\(u\)</span> 到 <span class="math inline">\(x\)</span> 的路径上第二个点的标号。注意，你询问的 <span class="math inline">\(u\)</span> 必须是 <span class="math inline">\(x\)</span> 的祖先，否则会报错。</p><p>你需要在不超过 <span class="math inline">\(36\)</span> 次询问之内找出 <span class="math inline">\(x\)</span>。<span class="math inline">\(x\)</span> 是预先设定好的，不会随着询问而改变。<span class="math inline">\(n \le 2\times 10^5\)</span>。</p><div class='spoiler collapsed'>    <div class='spoiler-title'>        题解    </div>    <div class='spoiler-content'>        <p>先询问 <code>d 1</code> 得到候选点集合，设其大小为 <span class="math inline">\(cnt\)</span>。</p><p>每次把当前考虑的点移动到候选点结合的 LCA。</p><p>然后求一遍子树候选点集合大小。如果当前点 <span class="math inline">\(x\)</span> 没有一个集合大小大于 <span class="math inline">\(\frac{cnt}{2}\)</span> 的儿子，那么直接问 <code>s x</code> 就可以把候选点的数量减半。否则往哪个唯一的集合大小大于 <span class="math inline">\(\frac{cnt}{2}\)</span> 搜，每次往重儿子走，直到走到一个候选点 <span class="math inline">\(y\)</span>，然后询问 <code>d y</code>，这时候所有的候选点都可以与 <span class="math inline">\(y\)</span> 求距离然后判断是否还是候选点。假设之后的候选点集合的 LCA 为 <span class="math inline">\(z\)</span>，因为 <span class="math inline">\(y\)</span> 是 <span class="math inline">\(z\)</span> 走重儿子走到的，所以在极端情况下 <span class="math inline">\(z\)</span> 还有两个儿子，且大小各为 <span class="math inline">\(\frac{cnt}{3}\)</span>，所以此时问 <code>s z</code> 就可以把候选点数量减至至多 <span class="math inline">\(\frac{n}{3}\)</span>。</p><p>综上复杂度是 <span class="math inline">\(2\log_{3}n\)</span> 的，完全三叉树可以卡到此复杂度上限。</p>    </div></div><hr /><p>CF750F New Year and Finding Roots</p><p>这是一道交互题。</p><p>有一棵高度为 <span class="math inline">\(h\)</span> 的有根完全二叉树，点的编号从 <span class="math inline">\(1\)</span> 到 <span class="math inline">\(2^h-1\)</span>。每一次你可以询问某一个点在树上的邻居，现在请你使用不超过 <span class="math inline">\(16\)</span> 次询问找到树根。<span class="math inline">\(T\)</span> 组数据，<span class="math inline">\(T\leq 500,2\leq h \leq 7\)</span>。</p><div class='spoiler collapsed'>    <div class='spoiler-title'>        题解    </div>    <div class='spoiler-content'>        <p>假设当前在叶子。</p><p>直接跳到其父亲，那么我们可以直接得到当前点的深度，设为 <span class="math inline">\(dep\)</span>。</p><p>然后询问一次，然后随机在两个出边之间选一条走，如果走错了，那么就会花 <span class="math inline">\(h-dep\)</span> 次走到叶子，这时候这两条出边的另一个就是跳向父亲的。</p><p>当 <span class="math inline">\(h=7\)</span> 的时候脸足够黑的话要 <span class="math inline">\(22\)</span> 次，即主链上 <span class="math inline">\(7\)</span> 次，支链上 <span class="math inline">\(\sum_{i=1}^6i=15\)</span> 次。</p><p>不难发现越高的点不小心走错花的贡献越多。我们不希望走错，所以考虑当深度足够浅的时候 BFS——这样我们就不存在走错了。</p><p>当这个阈值为 <span class="math inline">\(3\)</span> 的时候，我们可能查询的点只有 <span class="math inline">\(17\)</span> 个，如图所示：</p><p><img src="https://ftp.bmp.ovh/imgs/2021/03/d03a9df9a7dc5731.png" /></p><p>在 <span class="math inline">\(6,12,15,17\)</span> 我们采取 DFS 的策略，在 <span class="math inline">\(4\)</span> 我们就开始 BFS。</p><p>这样一共有 <span class="math inline">\(17\)</span> 个点，看似超出了一次，但实际上这 <span class="math inline">\(17\)</span> 个点中一定有根，如果前 <span class="math inline">\(16\)</span> 次询问都没问到根，那么最后剩下的就一定是根。</p><p>实际上我们并不需要找叶子。我们随机一个点，然后随机走直到走到了叶子，这时候我们可以通过路径长度来确定一个深度比较浅的点。如上图如果我们一开始走的 <span class="math inline">\(10\sim 14\)</span>，那么我们就可以直接确定 <span class="math inline">\(6\)</span> 号点的深度 <span class="math inline">\(4\)</span>，因为深度大于 <span class="math inline">\(4\)</span> 的点走不出一个长度为 <span class="math inline">\(6\)</span> 的路径。</p><p>不难发现这样确定点不会劣于从叶子开始的做法。故 <span class="math inline">\(16\)</span> 次足够了。</p>    </div></div><hr /><p>CF1368F Lamps on a Circle</p><p>这是一道交互题。</p><p>Alice 和 Bob 在玩游戏，有 <span class="math inline">\(n\)</span> 盏灯排成一个<strong>圈</strong>，顺时针标号为 <span class="math inline">\(1\sim n\)</span>，初始所有灯都是关着的。</p><p>每轮操作为：</p><ul><li>Alice 选择一个 <span class="math inline">\(k\in [1,n]\)</span> 然后打开任意 <span class="math inline">\(k\)</span> 盏灯（可以重复打开）。</li><li>Bob 关闭一段长度为 <span class="math inline">\(k\)</span> 的连续区间的灯。</li></ul><p>Alice 可以在每轮开始时选择停止游戏，这局游戏的得分就是当前亮着的灯的数量。</p><p>Alice 想要最大化得分，Bob 想要最小化得分。</p><p>你需要使用不超过 <span class="math inline">\(10^4\)</span> 次操作达到得分上界。</p><p><span class="math inline">\(n\le 1000\)</span>。</p><div class='spoiler collapsed'>    <div class='spoiler-title'>        题解    </div>    <div class='spoiler-content'>        <p>假设我们把序列分成若干段，相邻之间有至少一个空位，那么最后的答案就是 <span class="math inline">\(\sum size-\max size\)</span>。</p><p>因为你在修改的时候，如果至少有二个段，Bob 就不能把你所有的修改都抵掉。所以你最后总会剩且只剩一段，而 Bob 也总能把你企图修改的最大的一段的变回来。</p><p>假设你要分 <span class="math inline">\(x\)</span> 段，那一定是平均分最优。所以可以直接枚举段数求该段数下的贡献。</p><p>每一轮 Alice 都可以多点亮至少一个灯，所以 <span class="math inline">\(10^4\)</span> 足够了。</p>    </div></div><link rel="stylesheet" href="/css/spoiler.css" type="text/css"><script src="/js/spoiler.js" type="text/javascript" async></script>]]></content>
    
    
    <summary type="html">&lt;p&gt;一些神题。&lt;/p&gt;</summary>
    
    
    
    
    <category term="妙题" scheme="http://example.com/tags/%E5%A6%99%E9%A2%98/"/>
    
  </entry>
  
  <entry>
    <title>机房日常</title>
    <link href="http://example.com/2021/03/11/%E6%9C%BA%E6%88%BF%E6%97%A5%E5%B8%B8/"/>
    <id>http://example.com/2021/03/11/%E6%9C%BA%E6%88%BF%E6%97%A5%E5%B8%B8/</id>
    <published>2021-03-11T10:52:00.000Z</published>
    <updated>2021-03-24T13:07:22.684Z</updated>
    
    <content type="html"><![CDATA[<p>神说记录机房日常可以涨 RP。</p><p>积积积积积点点点点点阳阳阳阳阳德德德德德。</p><a id="more"></a><p>博主是老鸽子，咕咕咕咕咕。</p><p>因为博主太懒了，下文的时间是倒序的。</p><hr /><h3 id="section">2021.3.23</h3><blockquote><p>XiG: 我发现把眼镜反过来戴脑袋会特别晕<br />lsqs: 因为度数不一样啊<br />Dan: 那我先反一下，再反一下……<br />All: 那和没反有什么区别吗？</p></blockquote><h3 id="section-1">2021.3.22</h3><blockquote><p>Dan: 给个提示 <span class="math inline">\(F^2_{k-1}\equiv c \pmod {F_k}\)</span><br />All: 也就是说对于所有的 <span class="math inline">\(k\)</span>，<span class="math inline">\(F^2_{k-1}\bmod F_k\)</span> 是常数咯？<br />lsqs: 那不是求出 <span class="math inline">\(k=1\)</span> 的值就可以了吗？<br />Ima: <span class="math inline">\(k=1,2\)</span> 的值不一样诶！<br />Dan: 不是啊，对于不同的 <span class="math inline">\(k\)</span> 来说 <span class="math inline">\(c\)</span> 可能不同啊。<br />All: 那给了个啥提示啊？<br />Dan: 哦~【恍然大悟】</p></blockquote><h3 id="section-2">2021.3.21</h3><p>PETS 考试：</p><blockquote><p>Q: Do you like your school ?<br />A: Yes, of course.<br />Q: Why ?<br />...<br />A: I think ... the students are kind. XD</p></blockquote><h3 id="section-3">2021.3.11</h3><blockquote><p>Imakf: 为什么这么做最优啊？<br />Qiu: 因为这么做最优。<br />Imakf: ？<br />Qiu: 显然啊。</p></blockquote><blockquote><p>Qiu: <span class="math inline">\(n\times 2^{\frac{n}{4}}\)</span> 过 <span class="math inline">\(n\leq 100\)</span> 不随便过？</p></blockquote><link rel="stylesheet" href="/css/spoiler.css" type="text/css"><script src="/js/spoiler.js" type="text/javascript" async></script>]]></content>
    
    
    <summary type="html">&lt;p&gt;神说记录机房日常可以涨 RP。&lt;/p&gt;
&lt;p&gt;积积积积积点点点点点阳阳阳阳阳德德德德德。&lt;/p&gt;</summary>
    
    
    
    
    <category term="日常" scheme="http://example.com/tags/%E6%97%A5%E5%B8%B8/"/>
    
  </entry>
  
  <entry>
    <title>c++11——范围 for 的那些事</title>
    <link href="http://example.com/2021/03/02/c-11%E2%80%94%E2%80%94%E8%8C%83%E5%9B%B4-for-%E7%9A%84%E9%82%A3%E4%BA%9B%E4%BA%8B/"/>
    <id>http://example.com/2021/03/02/c-11%E2%80%94%E2%80%94%E8%8C%83%E5%9B%B4-for-%E7%9A%84%E9%82%A3%E4%BA%9B%E4%BA%8B/</id>
    <published>2021-03-02T10:59:27.000Z</published>
    <updated>2021-03-02T12:48:52.513Z</updated>
    
    <content type="html"><![CDATA[<p>众所周知在 <code>c++11</code> 中支持了同 <code>python3</code> 一样的范围 <code>for</code> 语句。即 <code>for (int x : vector)</code>。</p><p>该语法结合 <code>c++11</code> 中方便的 <code>auto</code> 不定类型名使用体验极佳。</p><a id="more"></a><p>但是这样仅适用于系统提供的容器，包括但不限于 STL、数组等。如：</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">vector</span> &lt;<span class="keyword">int</span>&gt; v;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">auto</span> x : v) &#123; <span class="comment">/* do something */</span> &#125;</span><br><span class="line"><span class="built_in">set</span> &lt;<span class="keyword">int</span>&gt; s;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">auto</span> x : s) &#123; <span class="comment">/* do something */</span> &#125;</span><br><span class="line"><span class="keyword">int</span> a[<span class="number">1005</span>];</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">auto</span> x : a) &#123; <span class="comment">/* do something */</span> &#125;</span><br></pre></td></tr></table></figure><p>在一些时候如果我们想要如此方便的遍历自己的结构体就不适用了。</p><p>这里给出一种可以实现这个效果的方法。</p><p>首先我们要知道 <code>for (:)</code> 在程序内部到底是怎么实现的。抛开数组不谈，对于一些可遍历的 STL，我们自己在遍历的时候是用迭代器从 <code>begin()</code> 到 <code>end()</code> 遍历。其实在程序内部，这种范围 <code>for</code> 有一种实现也是这样，即 <code>for (auto x = v.begin(); x != v.end(); ++x)</code>。当然具体如何实现不管，我们只需要知道，对于我们自己定义的结构体，如果能自定义一个迭代器，且该结构体有 <code>begin()</code>、<code>end()</code> 函数供迭代器遍历，那么就可以实现这个过程。</p><p>实际上迭代器用指针模拟就可以了。但是因为指针的 <code>++</code> 和 <code>*</code> 已经被定义，不适合当做这里的迭代器。但是我们可以用一个结构体来存储指针并模拟。即</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">template</span> &lt;<span class="keyword">typename</span> T&gt; <span class="class"><span class="keyword">struct</span> <span class="title">Iterator</span> &#123;</span></span><br><span class="line">  T *iter;</span><br><span class="line">  Iterator (T *p) &#123; iter = p; &#125;</span><br><span class="line">  T&amp; <span class="keyword">operator</span> *() &#123; <span class="keyword">return</span> *iter; &#125;</span><br><span class="line">  <span class="keyword">bool</span> <span class="keyword">operator</span> != (<span class="keyword">const</span> Iterator&amp; that) &#123; <span class="keyword">return</span> <span class="keyword">this</span>-&gt;iter != that.iter; &#125;</span><br><span class="line">  Iterator&amp; <span class="keyword">operator</span>++() &#123; iter = iter-&gt;next; <span class="keyword">return</span> *<span class="keyword">this</span>; &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure><p>为了能够适用更多情况，这里的模拟迭代器适用 <code>template</code> 模板。在其中定义了一个指针来储存数据，重载的取值的 <code>*</code>，自加 <code>++</code> 和不等于，即与上文暴力实现的需求相对应。这里有两个注意项，<code>++</code> 的函数中的语句 <code>iter = iter-&gt;next</code>，这需要适用这个迭代器的结构体有 <code>next</code> 指针；<code>*</code> 的返回值必须为传引用，不然的话就不能通过这个来修改了。</p><p>考虑怎么使用它。下面给出一个边表的实现：</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">Edges</span> &#123;</span></span><br><span class="line">  <span class="keyword">int</span> to; Edges *next;</span><br><span class="line">  Edges () &#123; to = <span class="number">0</span>, next = <span class="literal">nullptr</span>; &#125;</span><br><span class="line">  <span class="function">Iterator&lt;Edges&gt; <span class="title">begin</span><span class="params">()</span> </span>&#123; <span class="keyword">return</span> Iterator&lt;Edges&gt;(<span class="keyword">this</span>); &#125;;</span><br><span class="line">  <span class="function">Iterator&lt;Edges&gt; <span class="title">end</span><span class="params">()</span> </span>&#123; <span class="keyword">return</span> Iterator&lt;Edges&gt;(<span class="literal">nullptr</span>); &#125;</span><br><span class="line">&#125; e[];</span><br></pre></td></tr></table></figure><p>其中 <code>to</code> 是边表要存的信息，这里不管。<code>next</code> 是连接下一个元素的指针，这里和迭代器中的 <code>next</code> 相对应。在该结构体中我们还需要定义两个函数 <code>begin()</code> 和 <code>end()</code>，这样才能遍历这个结构体。</p><p>不难发现最后 <code>Edges</code> 会连出一个链表。用范围 <code>for</code> 遍历的时候，我们传入的是开始遍历的位置。具体的，即 <code>for (auto x : e[k])</code>，这意味着它会从 <code>e[k]</code> 开始遍历，到链尾才会结束。</p><p>至此我们就可以实现用范围 <code>for</code> 遍历自定义的结构体了。</p><p>❀ ~撒花~ ❀</p><hr /><p>但事实上在算法竞赛中它的用途极少，因为似乎除了边表就没有什么东西需要遍历一个结构体了。但是或许可以写一些算法竞赛之外的东西，<del>用来装 X</del>。</p><link rel="stylesheet" href="/css/spoiler.css" type="text/css"><script src="/js/spoiler.js" type="text/javascript" async></script>]]></content>
    
    
    <summary type="html">&lt;p&gt;众所周知在 &lt;code&gt;c++11&lt;/code&gt; 中支持了同 &lt;code&gt;python3&lt;/code&gt; 一样的范围 &lt;code&gt;for&lt;/code&gt; 语句。即 &lt;code&gt;for (int x : vector)&lt;/code&gt;。&lt;/p&gt;
&lt;p&gt;该语法结合 &lt;code&gt;c++11&lt;/code&gt; 中方便的 &lt;code&gt;auto&lt;/code&gt; 不定类型名使用体验极佳。&lt;/p&gt;</summary>
    
    
    
    
    <category term="语言" scheme="http://example.com/tags/%E8%AF%AD%E8%A8%80/"/>
    
  </entry>
  
  <entry>
    <title>Euler Project</title>
    <link href="http://example.com/2021/02/22/Euler-Project/"/>
    <id>http://example.com/2021/02/22/Euler-Project/</id>
    <published>2021-02-22T11:23:11.000Z</published>
    <updated>2021-03-02T10:59:57.999Z</updated>
    
    <content type="html"><![CDATA[<p>大佬说 Euler-Project 没有刷的必要，这篇博客咕了。</p><link rel="stylesheet" href="/css/spoiler.css" type="text/css"><script src="/js/spoiler.js" type="text/javascript" async></script>]]></content>
    
    
      
      
    <summary type="html">&lt;p&gt;大佬说 Euler-Project 没有刷的必要，这篇博客咕了。&lt;/p&gt;
&lt;link rel=&quot;stylesheet&quot; href=&quot;/css/spoiler.css&quot; type=&quot;text/css&quot;&gt;&lt;script src=&quot;/js/spoiler.js&quot; type=&quot;te</summary>
      
    
    
    
    
  </entry>
  
  <entry>
    <title>快读相关</title>
    <link href="http://example.com/2021/02/18/%E5%BF%AB%E8%AF%BB%E7%9B%B8%E5%85%B3/"/>
    <id>http://example.com/2021/02/18/%E5%BF%AB%E8%AF%BB%E7%9B%B8%E5%85%B3/</id>
    <published>2021-02-18T08:59:46.000Z</published>
    <updated>2021-03-01T12:29:58.334Z</updated>
    
    <content type="html"><![CDATA[<p>琢磨了一下午，在输入输出流上面有了一点点自己的理解。</p><a id="more"></a><hr /><p>关于重载运算符读入结构体。</p><p>对于一个结构体，如果要读入它我们是不能直接用 <code>cin</code> 的，但是我们可以重载输入流的运算符 <code>&gt;&gt;</code>，从而使得它可以支持这个操作。</p><p>输入流 <code>cin</code> 的数据类型是 <code>istream</code>。我们不妨把 <code>&gt;&gt;</code> 看成是一个二元运算符，其左操作数是一个 <code>istream</code> 的变量，右操作数是一个需要读入的东西。</p><p>不难发现，我们有时候会连写 <code>cin</code>，如 <code>cin &gt;&gt; a &gt;&gt; b</code>，注意到 <code>&gt;&gt;</code> 是左结合的，所以可以看成是 <code>(cin &gt;&gt; a) &gt;&gt; b</code>。可以发现后面的操作符少了一个左操作数，所以 <code>cin &gt;&gt; a</code> 的返回值应该还是 <code>cin</code> 这个输入流变量。</p><p>这样我们就有了一个大致的想法，重载运算符 <code>&gt;&gt;</code>，左操作数读入 <code>istream</code>，右操作数读入 <code>structName</code>，读入完之后返回 <code>istream</code>。即：</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">istream&amp; <span class="keyword">operator</span> &gt;&gt; (istream &amp;is, structName &amp;a) &#123;</span><br><span class="line">  <span class="comment">/* Input a */</span></span><br><span class="line">  <span class="keyword">return</span> is;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>如果把这个重载写在全局是没有问题的，但是如果写在结构体内就会 CE。</p><p>这是结构体的特性导致的，在重载二元运算符的时候，其第一个参数会默认为它自己（比如在重载矩阵乘法的时候），所以需要加上 <code>friend</code> 标识使得它合法。</p><p>即如果把重载写在全局，那么就不需要加 <code>friend</code> 标识，否则必须在重载定义前加。即：</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">friend</span> istream&amp; <span class="keyword">operator</span> &gt;&gt; (istream &amp;is, structName &amp;a) &#123;</span><br><span class="line">  <span class="comment">/* Input a */</span></span><br><span class="line">  <span class="keyword">return</span> is;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>类似的，输出也是这么重载。输出流的类型是 <code>ostream</code>，标识是 <code>cout</code>。其它规则与输入一样。下面给出一个例子：</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">friend</span> ostream&amp; <span class="keyword">operator</span> &lt;&lt; (ostream &amp;os, structName a) &#123;</span><br><span class="line">  <span class="comment">/* Output a */</span></span><br><span class="line">  <span class="keyword">return</span> os;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><hr /><p>关于重载运算符的快读。</p><p>快读用的时候不太爽，因为如果要读很多个数就要一个一个 <code>read</code>。考虑用上面的重载运算符优化。</p><p>但是如果直接重载 <code>&gt;&gt;,&lt;&lt;</code>，而且用输入输出流的 <code>istream,ostream</code> 的话，这个快读是无效的，因为 <code>c++</code> 内部的读入就是通过重载实现。</p><p>所以考虑自己定义一个读入结构体 <code>Input</code>。重定义左操作数为结构体 <code>Input</code> 右操作数为整形的 <code>&gt;&gt;</code>，然后在运算内写快读，即：</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Input</span> &#123;</span></span><br><span class="line"><span class="keyword">private</span> :</span><br><span class="line">  <span class="keyword">char</span> buf[<span class="number">1000000</span>], *p1 = buf, *p2 = buf;</span><br><span class="line"><span class="keyword">public</span> :</span><br><span class="line">  <span class="function"><span class="keyword">inline</span> <span class="keyword">char</span> <span class="title">gc</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (p1 == p2) p2 = (p1 = buf) + fread(buf, <span class="number">1</span>, <span class="number">1000000</span>, <span class="built_in">stdin</span>);</span><br><span class="line">    <span class="keyword">return</span> p1 == p2 ? EOF : *(p1++);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">template</span> &lt;<span class="keyword">typename</span> T&gt; <span class="keyword">inline</span> Input&amp; <span class="keyword">operator</span> &gt;&gt; (T &amp;n) &#123;</span><br><span class="line">    n = <span class="number">0</span>; RI ch = gc(), f;</span><br><span class="line">    <span class="keyword">while</span> ((ch &lt; <span class="string">&#x27;0&#x27;</span> || ch &gt; <span class="string">&#x27;9&#x27;</span>) &amp;&amp; ch != <span class="string">&#x27;-&#x27;</span>) ch = gc();</span><br><span class="line">    f = (ch == <span class="string">&#x27;-&#x27;</span> ? ch = gc(), <span class="number">-1</span> : <span class="number">1</span>);</span><br><span class="line">    <span class="keyword">while</span> (ch &gt;= <span class="string">&#x27;0&#x27;</span> &amp;&amp; ch &lt;= <span class="string">&#x27;9&#x27;</span>) n = n * <span class="number">10</span> + (ch ^ <span class="number">48</span>), ch = gc();</span><br><span class="line">    n *= f;</span><br><span class="line">    <span class="keyword">return</span> *<span class="keyword">this</span>;</span><br><span class="line">  &#125;</span><br><span class="line">&#125; fin;</span><br></pre></td></tr></table></figure><p>在使用的时候，<code>fin</code> 和 <code>cin</code> 是类似的用法。如果需要增加功能，如输入字符串等，就直接新定义 <code>&gt;&gt;</code> 即可。因为根据 <code>c++ template</code> 的性质，函数匹配会优先匹配实参，也就是说如果在这个结构体内还有 <code>inline Input&amp; operator &gt;&gt; (char *s) &#123;&#125;</code>，然后在输入的时候右操作数是 <code>char*</code> 的话，会优先匹配这个函数。</p><p>快输同理：</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Output</span> &#123;</span></span><br><span class="line"><span class="keyword">private</span> :</span><br><span class="line">  <span class="keyword">char</span> ouf[<span class="number">1000000</span>], *P1 = ouf, *P2 = ouf;</span><br><span class="line">  <span class="keyword">char</span> Of[<span class="number">105</span>], *O1 = Of, *O2 = Of;</span><br><span class="line"><span class="keyword">public</span> :</span><br><span class="line">  <span class="function"><span class="keyword">inline</span> <span class="keyword">void</span> <span class="title">Flush</span><span class="params">()</span> </span>&#123; fwrite(ouf, <span class="number">1</span>, P2 - P1, <span class="built_in">stdout</span>); P2 = P1; &#125;</span><br><span class="line">  <span class="function"><span class="keyword">inline</span> <span class="keyword">void</span> <span class="title">pc</span><span class="params">(<span class="keyword">char</span> ch)</span> </span>&#123;</span><br><span class="line">    *(P2++) = ch;</span><br><span class="line">    <span class="keyword">if</span> (P2 == P1 + <span class="number">1000000</span>) Flush();</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">template</span> &lt;<span class="keyword">typename</span> T&gt; <span class="keyword">inline</span> Output&amp; <span class="keyword">operator</span> &lt;&lt; (T n) &#123;</span><br><span class="line">    <span class="keyword">if</span> (n &lt; <span class="number">0</span>) pc(<span class="string">&#x27;-&#x27;</span>), n = -n;</span><br><span class="line">    <span class="keyword">if</span> (n == <span class="number">0</span>) pc(<span class="string">&#x27;0&#x27;</span>);</span><br><span class="line">    <span class="keyword">while</span> (n) *(O1++) = (n % <span class="number">10</span>) ^ <span class="number">48</span>, n /= <span class="number">10</span>;</span><br><span class="line">    <span class="keyword">while</span> (O1 != O2) pc(*(--O1));</span><br><span class="line">    <span class="keyword">return</span> *<span class="keyword">this</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">inline</span> Output&amp; <span class="keyword">operator</span> &lt;&lt; (<span class="keyword">char</span> ch) &#123; pc(ch); <span class="keyword">return</span> *<span class="keyword">this</span>; &#125;</span><br><span class="line">  ~Output() &#123; Flush(); &#125;</span><br><span class="line">&#125; fout;</span><br></pre></td></tr></table></figure><p>因为我们这里使用的是 <code>fwrite</code>，所以在程序结束的时候可能在输出数组中仍然有未输出的字符，这时候就需要 <code>Flush</code>。但是为了避免在程序结束后忘记 <code>Flush</code>，我们给 <code>Output</code> 类型的结构体一个析构函数，在程序结束析构它的时候进行 <code>Flush</code>。</p><p>还有一点就是不管是快读还是快输，函数的返回值一定要是 <code>Input/Output &amp;</code>，即传引用。不然在 <code>return *this</code> 的时候会把这个结构体复制一份返回，这不是我们期望看到的。</p><p>但是这样还是有点奇怪，因为 <code>fin</code> 和 <code>fout</code> 我们不习惯写，我们可以 <code>#define cin fin</code>，<code>#define cout fout</code>。而且可以 <code>define endl</code> 等。</p><link rel="stylesheet" href="/css/spoiler.css" type="text/css"><script src="/js/spoiler.js" type="text/javascript" async></script>]]></content>
    
    
    <summary type="html">&lt;p&gt;琢磨了一下午，在输入输出流上面有了一点点自己的理解。&lt;/p&gt;</summary>
    
    
    
    
    <category term="语言" scheme="http://example.com/tags/%E8%AF%AD%E8%A8%80/"/>
    
  </entry>
  
  <entry>
    <title>「LibreOJ Round #11」Misaka Network 与求和 题解</title>
    <link href="http://example.com/2021/01/30/%E3%80%8CLibreOJ-Round-11%E3%80%8DMisaka-Network-%E4%B8%8E%E6%B1%82%E5%92%8C-%E9%A2%98%E8%A7%A3/"/>
    <id>http://example.com/2021/01/30/%E3%80%8CLibreOJ-Round-11%E3%80%8DMisaka-Network-%E4%B8%8E%E6%B1%82%E5%92%8C-%E9%A2%98%E8%A7%A3/</id>
    <published>2021-01-30T00:20:30.000Z</published>
    <updated>2021-01-30T01:01:03.549Z</updated>
    
    <content type="html"><![CDATA[<p>求 <span class="math inline">\(\sum_{i=1}^N\sum_{j=1}^Nf^k(\gcd(i,j))\)</span>，其中 <span class="math inline">\(f(x)\)</span> 表示 <span class="math inline">\(x\)</span> 的第二大质因子，每个质因子算多次，即 <span class="math inline">\(f(4)=f(6)=2\)</span>，定义 <span class="math inline">\(f(1)=0,f(Prime)=1\)</span>。</p><p>众所周知 Min_25 筛的本质是用 DP 求出所有 <span class="math inline">\(S(\lfloor\frac{n}{1}\rfloor),S(\lfloor\frac{n}{2}\rfloor)...\)</span> 这 <span class="math inline">\(2\sqrt{n}\)</span> 个值。如果可以较好的处理每个数质因子之间的关系的话，是不要求所筛函数是积性函数的，这个题就是一个典型例子。</p><a id="more"></a><p>直接设 <span class="math inline">\(f^k(n)=\sum_{d|n}g(d)\)</span>，莫比乌斯反演得到 <span class="math inline">\(g(n)=\sum_{d|n}f^k(d)\mu(\frac{n}{d})\)</span>。原式变成 <span class="math inline">\(\sum_{d=1}^ng(d)\lfloor\frac{n}{d}\rfloor^2\)</span>。</p><p>后面直接整除分块，现在就只需要求 <span class="math inline">\(g\)</span> 的前缀和。</p><p>设 <span class="math inline">\(S(n)=\sum_{i=1}^ng(i)\)</span>，那么 <span class="math inline">\(S(n)=\sum_{i=1}^n\sum_{d|n}\mu(d)f^k(\frac{n}{d})=\sum_{d=1}^n\mu(d)\sum_{i=1}^{\lfloor\frac{n}{d}\rfloor}f^k(i)\)</span>。后面的求和式又可以整除分块。而前面求 <span class="math inline">\(\mu\)</span> 的前缀和可以用杜教筛（应该也只能用杜教筛）。</p><p>考虑怎么求 <span class="math inline">\(\sum_{i=1}^{\lfloor\frac{n}{d}\rfloor}f^k(i)\)</span>。可以发现 Min_25 筛求积性函数和的时候，每次是剥离了一个数的最小质因子。在这个题中，如果这个最小质因子恰好是次大质因子，那么就可以直接计算贡献，否则贡献就已经在之前算过了。所以我们设 <span class="math inline">\(F(n,x)\)</span> 表示 <span class="math inline">\(n\)</span> 以内所有质因子大于等于 <span class="math inline">\(Prime_x\)</span> 的合数的 <span class="math inline">\(f^k(x)\)</span> 的和，<span class="math inline">\(G(n)\)</span> 表示 <span class="math inline">\(n\)</span> 以内的质数个数。类似于 Min_25 筛的，<span class="math inline">\(F,G\)</span> 只有 <span class="math inline">\(2\sqrt{n}\)</span> 个值。</p><p><span class="math inline">\(G\)</span> 是一个经典的 DP，在此就不再赘述。</p><p>考虑求 <span class="math inline">\(F\)</span>，有 <span class="math inline">\(F(n,x)=F(n,x+1)+\sum_{e=1}\left(F(\frac{n}{p_x^e},x+1)+p_x^k\left(G(\frac{n}{p_x^e})-(x-1)\right)\right)\)</span>，即分最小质因子大于 <span class="math inline">\(x\)</span> 和最小质因子恰好为 <span class="math inline">\(x\)</span> 分别处理。</p><p>最后的真实的 <span class="math inline">\(\sum_{i=1}^nf^k(i)\)</span> 就是 <span class="math inline">\(F(n)+G(n)\)</span>。</p><p>总复杂度暂时还不会分析，但是 Min_25 的预处理是约 <span class="math inline">\(O(n^\frac{3}{4})\)</span>，真实求值的时候要用两个整除分块加杜教筛，复杂度可能会达到 <span class="math inline">\(O(n^{\frac{7}{8}})\)</span>（当然这是瞎扯）。总之能过。</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> debug(...) fprintf(stderr, __VA_ARGS__)</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> RI register int</span></span><br><span class="line"><span class="keyword">typedef</span> <span class="keyword">long</span> <span class="keyword">long</span> LL;</span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> FILEIO(name) freopen(name<span class="meta-string">&quot;.in&quot;</span>, <span class="meta-string">&quot;r&quot;</span>, stdin), freopen(name<span class="meta-string">&quot;.out&quot;</span>, <span class="meta-string">&quot;w&quot;</span>, stdout);</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> <span class="keyword">const</span> MAXN = <span class="number">1e6</span> + <span class="number">5</span>;</span><br><span class="line"><span class="keyword">int</span> n, k, sq;</span><br><span class="line"><span class="keyword">int</span> Prime[MAXN], tot, miu[MAXN], Smiu[MAXN];</span><br><span class="line"><span class="keyword">char</span> Notprime[MAXN];</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">Euler</span><span class="params">(<span class="keyword">int</span> Max)</span> </span>&#123;</span><br><span class="line">  miu[<span class="number">1</span>] = Smiu[<span class="number">1</span>] = <span class="number">1</span>;</span><br><span class="line">  <span class="keyword">for</span> (RI i = <span class="number">2</span>; i &lt;= Max; ++i) &#123;</span><br><span class="line">    <span class="keyword">if</span> (!Notprime[i])</span><br><span class="line">      Prime[++tot] = i, miu[i] = <span class="number">-1</span>;</span><br><span class="line">    <span class="keyword">for</span> (RI j = <span class="number">1</span>; j &lt;= tot &amp;&amp; i * Prime[j] &lt;= Max; ++j) &#123;</span><br><span class="line">      Notprime[i * Prime[j]] = <span class="number">1</span>;</span><br><span class="line">      <span class="keyword">if</span> (i % Prime[j] == <span class="number">0</span>) <span class="keyword">break</span>;</span><br><span class="line">      miu[i * Prime[j]] = miu[i] * <span class="number">-1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    Smiu[i] = Smiu[i - <span class="number">1</span>] + miu[i];</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">namespace</span> DuDuDu &#123;</span><br><span class="line">  <span class="built_in">map</span> &lt;<span class="keyword">int</span>, <span class="keyword">unsigned</span> <span class="keyword">int</span>&gt; mp;</span><br><span class="line">  <span class="function"><span class="keyword">unsigned</span> <span class="keyword">int</span> <span class="title">S</span><span class="params">(<span class="keyword">int</span> n)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (n &lt;= MAXN - <span class="number">5</span>) <span class="keyword">return</span> Smiu[n];</span><br><span class="line">    <span class="keyword">if</span> (mp.count(n)) <span class="keyword">return</span> mp[n];</span><br><span class="line">    <span class="keyword">unsigned</span> ans = <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">for</span> (RI l = <span class="number">2</span>, r; l &lt;= n; l = r + <span class="number">1</span>) &#123;</span><br><span class="line">      r = n / (n / l);</span><br><span class="line">      ans -= (r - l + <span class="number">1</span>) * S(n / l);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> mp[n] = ans;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">namespace</span> InitF &#123;</span><br><span class="line"><span class="comment">// g(x) = 1,            G(n, x) = \sum g(i)  i is prime || minprime[i] &gt; x</span></span><br><span class="line"><span class="comment">// f(x) = second prime, F(n, x) = \sum f(i)  i is not prime &amp;&amp; minprime[i] &gt;= x</span></span><br><span class="line"></span><br><span class="line">  <span class="keyword">int</span> <span class="keyword">const</span> MX = <span class="number">1e5</span> + <span class="number">5</span>;</span><br><span class="line">  <span class="keyword">int</span> id1[MX], id2[MX], val[MX];</span><br><span class="line">  <span class="keyword">unsigned</span> <span class="keyword">int</span> G[MX], F[MX], Ans[MX];</span><br><span class="line">  <span class="function"><span class="keyword">inline</span> <span class="keyword">int</span> <span class="title">Getid</span><span class="params">(<span class="keyword">int</span> x)</span> </span>&#123; <span class="keyword">return</span> x &lt;= sq ? id1[x] : id2[n / x]; &#125;</span><br><span class="line">  <span class="function"><span class="keyword">unsigned</span> <span class="keyword">int</span> <span class="title">qpow</span><span class="params">(<span class="keyword">unsigned</span> <span class="keyword">int</span> a, <span class="keyword">int</span> k)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">unsigned</span> <span class="keyword">int</span> re = <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">for</span> (; k; k &gt;&gt;= <span class="number">1</span>, a *= a)</span><br><span class="line">      <span class="keyword">if</span> (k &amp; <span class="number">1</span>) re *= a;</span><br><span class="line">    <span class="keyword">return</span> re;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="function"><span class="keyword">void</span> <span class="title">Work</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="keyword">int</span> cnt = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span> (RI l = <span class="number">1</span>, r; l &lt;= n; l = r + <span class="number">1</span>) &#123;</span><br><span class="line">      r = n / (n / l);</span><br><span class="line">      <span class="keyword">int</span> x = (n / l);</span><br><span class="line">      <span class="keyword">if</span> (x &lt;= sq) id1[x] = ++cnt, val[cnt] = x;</span><br><span class="line">      <span class="keyword">else</span>     id2[n / x] = ++cnt, val[cnt] = x;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">for</span> (RI i = <span class="number">1</span>; i &lt;= cnt; ++i)</span><br><span class="line">      G[i] = val[i] - <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">int</span> x;</span><br><span class="line">    <span class="keyword">for</span> (x = <span class="number">1</span>; Prime[x] * Prime[x] &lt;= val[<span class="number">1</span>]; ++x)</span><br><span class="line">      <span class="keyword">for</span> (RI i = <span class="number">1</span>; i &lt;= cnt; ++i) &#123;</span><br><span class="line">        <span class="keyword">if</span> (Prime[x] * Prime[x] &gt; val[i]) <span class="keyword">break</span>;</span><br><span class="line">        G[i] = G[i] - (G[Getid(val[i] / Prime[x])] - (x - <span class="number">1</span>)); <span class="comment">// (x - 1) = SumG[x - 1]</span></span><br><span class="line">      &#125;</span><br><span class="line">    <span class="keyword">for</span> (; x; --x) &#123;</span><br><span class="line">      <span class="keyword">for</span> (RI i = <span class="number">1</span>; i &lt;= cnt; ++i) &#123;</span><br><span class="line">        LL cur = Prime[x];</span><br><span class="line">        <span class="keyword">while</span> (cur * Prime[x] &lt;= val[i]) &#123;</span><br><span class="line">          F[i] += F[Getid(val[i] / cur)];</span><br><span class="line">          F[i] += (G[Getid(val[i] / cur)] - (x - <span class="number">1</span>)) * qpow(Prime[x], k); <span class="comment">// (x - 1) = SumG[x - 1]</span></span><br><span class="line">          cur *= Prime[x];</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">for</span> (RI i = <span class="number">1</span>; i &lt;= cnt; ++i)</span><br><span class="line">      Ans[i] = F[i] + G[i];</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">unsigned</span> <span class="keyword">int</span> <span class="title">SG</span><span class="params">(<span class="keyword">int</span> n)</span> </span>&#123;</span><br><span class="line">  <span class="keyword">unsigned</span> <span class="keyword">int</span> ans = <span class="number">0</span>;</span><br><span class="line">  <span class="keyword">for</span> (RI l = <span class="number">1</span>, r; l &lt;= n; l = r + <span class="number">1</span>) &#123;</span><br><span class="line">    r = n / (n / l);</span><br><span class="line">    <span class="keyword">unsigned</span> <span class="keyword">int</span> L = DuDuDu :: S(l - <span class="number">1</span>), R = DuDuDu :: S(r);</span><br><span class="line">    ans += (R - L) * (InitF :: Ans[InitF :: Getid(n / l)]);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> ans;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">  </span><br><span class="line"><span class="meta">#<span class="meta-keyword">ifdef</span> LOCAL</span></span><br><span class="line">  FILEIO(<span class="string">&quot;a&quot;</span>);</span><br><span class="line"><span class="meta">#<span class="meta-keyword">endif</span></span></span><br><span class="line"></span><br><span class="line">  Euler(<span class="number">1e6</span>);</span><br><span class="line">  <span class="built_in">cin</span> &gt;&gt; n &gt;&gt; k;</span><br><span class="line">  sq = <span class="built_in">sqrt</span>(n);</span><br><span class="line">  InitF :: Work();</span><br><span class="line">  <span class="keyword">unsigned</span> <span class="keyword">int</span> ans = <span class="number">0</span>;</span><br><span class="line">  <span class="keyword">for</span> (RI l = <span class="number">1</span>, r; l &lt;= n; l = r + <span class="number">1</span>) &#123;</span><br><span class="line">    r = n / (n / l);</span><br><span class="line">    <span class="keyword">unsigned</span> <span class="keyword">int</span> L = SG(l - <span class="number">1</span>), R = SG(r);</span><br><span class="line">    ans += (R - L) * (n / l) * (n / l);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="built_in">cout</span> &lt;&lt; ans &lt;&lt; <span class="built_in">endl</span>;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// created by Daniel yuan</span></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">     ________</span></span><br><span class="line"><span class="comment">    /        \</span></span><br><span class="line"><span class="comment">   / /      \ \</span></span><br><span class="line"><span class="comment">  / /        \ \</span></span><br><span class="line"><span class="comment">  \            /</span></span><br><span class="line"><span class="comment">   \  ______  /</span></span><br><span class="line"><span class="comment">    \________/</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"></span><br></pre></td></tr></table></figure><link rel="stylesheet" href="/css/spoiler.css" type="text/css"><script src="/js/spoiler.js" type="text/javascript" async></script>]]></content>
    
    
    <summary type="html">&lt;p&gt;求 &lt;span class=&quot;math inline&quot;&gt;\(\sum_{i=1}^N\sum_{j=1}^Nf^k(\gcd(i,j))\)&lt;/span&gt;，其中 &lt;span class=&quot;math inline&quot;&gt;\(f(x)\)&lt;/span&gt; 表示 &lt;span class=&quot;math inline&quot;&gt;\(x\)&lt;/span&gt; 的第二大质因子，每个质因子算多次，即 &lt;span class=&quot;math inline&quot;&gt;\(f(4)=f(6)=2\)&lt;/span&gt;，定义 &lt;span class=&quot;math inline&quot;&gt;\(f(1)=0,f(Prime)=1\)&lt;/span&gt;。&lt;/p&gt;
&lt;p&gt;众所周知 Min_25 筛的本质是用 DP 求出所有 &lt;span class=&quot;math inline&quot;&gt;\(S(\lfloor\frac{n}{1}\rfloor),S(\lfloor\frac{n}{2}\rfloor)...\)&lt;/span&gt; 这 &lt;span class=&quot;math inline&quot;&gt;\(2\sqrt{n}\)&lt;/span&gt; 个值。如果可以较好的处理每个数质因子之间的关系的话，是不要求所筛函数是积性函数的，这个题就是一个典型例子。&lt;/p&gt;</summary>
    
    
    
    
    <category term="莫比乌斯反演" scheme="http://example.com/tags/%E8%8E%AB%E6%AF%94%E4%B9%8C%E6%96%AF%E5%8F%8D%E6%BC%94/"/>
    
    <category term="杜教筛" scheme="http://example.com/tags/%E6%9D%9C%E6%95%99%E7%AD%9B/"/>
    
    <category term="Min_25 筛" scheme="http://example.com/tags/Min-25-%E7%AD%9B/"/>
    
  </entry>
  
  <entry>
    <title>[CTSC2010] 性能优化 题解</title>
    <link href="http://example.com/2021/01/29/CTSC2010-%E6%80%A7%E8%83%BD%E4%BC%98%E5%8C%96-%E9%A2%98%E8%A7%A3/"/>
    <id>http://example.com/2021/01/29/CTSC2010-%E6%80%A7%E8%83%BD%E4%BC%98%E5%8C%96-%E9%A2%98%E8%A7%A3/</id>
    <published>2021-01-29T08:42:20.000Z</published>
    <updated>2021-01-29T10:59:40.578Z</updated>
    
    <content type="html"><![CDATA[<p>不难发现就是求 <span class="math inline">\(A*B^C\)</span> 的长度为 <span class="math inline">\(n\)</span> 的循环卷积（这都看不出来还配做这个题？）</p><a id="more"></a><p>一种及其 naive 的想法是倍增多项式快速幂模拟循环卷积。</p><p>因为值域很小，直接用 FFT 是足够的，复杂度 <span class="math inline">\(O(n\log n\log C)\)</span>，怎么看都过不了。</p><p>我们知道 FFT 本质上就是做的循环卷积。</p><p>所以说如果我们能求出长度为 <span class="math inline">\(n\)</span> 的 DFT 和 IDFT，那么我们直接 DFT 了 <span class="math inline">\(A,B\)</span>，然后把 <span class="math inline">\(B\)</span> 的点值求个 <span class="math inline">\(C\)</span> 次方，然后再 IDFT 回去。套一个 Bluestein 就是 <span class="math inline">\(O(n\log n)\)</span> 的了。</p><p>这样复杂度是 <span class="math inline">\(O(9n\log n)\)</span> 的，有点点卡常。</p><p>但是显然有一个性质我们没有用到，就是 <span class="math inline">\(n\)</span> 能表示成若干个不超过 <span class="math inline">\(10\)</span> 的正整数的乘积。</p><p>不妨考虑普通 FFT 的本质，是把它分成奇偶两部分 <span class="math inline">\(A_0(x)=a_0x^0+a_2x^1...,A_1(x)=a_1x^0+a_2x^1...\)</span>，然后递归下去算，最后这个点的 <span class="math inline">\(A(x)=A_0(x^2)+xA_1(x^2)\)</span>。</p><p>类似的，我们可以把 <span class="math inline">\(A\)</span> 分成 <span class="math inline">\(p\)</span> 份，<span class="math inline">\(A_0,A_1...A_p\)</span>，递归下去，回溯的时候 <span class="math inline">\(O(p)\)</span> 合并。</p><p>总复杂度是 <span class="math inline">\(O(\sum np)\)</span> 的，因为 <span class="math inline">\(n\)</span> 的质因子只有 <span class="math inline">\(2,3,5,7\)</span>，所以这个复杂度是可以接受的。</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> debug(...) fprintf(stderr, __VA_ARGS__)</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> RI register int</span></span><br><span class="line"><span class="keyword">typedef</span> <span class="keyword">long</span> <span class="keyword">long</span> LL;</span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> FILEIO(name) freopen(name<span class="meta-string">&quot;.in&quot;</span>, <span class="meta-string">&quot;r&quot;</span>, stdin), freopen(name<span class="meta-string">&quot;.out&quot;</span>, <span class="meta-string">&quot;w&quot;</span>, stdout);</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">namespace</span> IO &#123;</span><br><span class="line">  <span class="keyword">char</span> buf[<span class="number">1000000</span>], *p1 = buf, *p2 = buf;</span><br><span class="line">  <span class="function"><span class="keyword">inline</span> <span class="keyword">char</span> <span class="title">gc</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (p1 == p2) p2 = (p1 = buf) + fread(buf, <span class="number">1</span>, <span class="number">1000000</span>, <span class="built_in">stdin</span>);</span><br><span class="line">    <span class="keyword">return</span> p1 == p2 ? EOF : *(p1++);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">template</span> &lt;<span class="class"><span class="keyword">class</span> <span class="title">T</span>&gt; <span class="title">inline</span> <span class="title">void</span> <span class="title">read</span>(<span class="title">T</span> &amp;<span class="title">n</span>) &#123;</span></span><br><span class="line">    n = <span class="number">0</span>; RI ch = gc(), f;</span><br><span class="line">    <span class="keyword">while</span> ((ch &lt; <span class="string">&#x27;0&#x27;</span> || ch &gt; <span class="string">&#x27;9&#x27;</span>) &amp;&amp; ch != <span class="string">&#x27;-&#x27;</span>) ch = gc();</span><br><span class="line">    f = (ch == <span class="string">&#x27;-&#x27;</span> ? ch = gc(), <span class="number">-1</span> : <span class="number">1</span>);</span><br><span class="line">    <span class="keyword">while</span> (ch &gt;= <span class="string">&#x27;0&#x27;</span> &amp;&amp; ch &lt;= <span class="string">&#x27;9&#x27;</span>) n = n * <span class="number">10</span> + (ch ^ <span class="number">48</span>), ch = gc();</span><br><span class="line">    n *= f;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">char</span> Of[<span class="number">105</span>], *O1 = Of, *O2 = Of;</span><br><span class="line">  <span class="keyword">template</span> &lt;<span class="class"><span class="keyword">class</span> <span class="title">T</span>&gt; <span class="title">inline</span> <span class="title">void</span> <span class="title">print</span>(<span class="title">T</span> <span class="title">n</span>, <span class="title">char</span> <span class="title">ch</span> = &#x27;\<span class="title">n</span>&#x27;) &#123;</span></span><br><span class="line">    <span class="keyword">if</span> (n &lt; <span class="number">0</span>) <span class="built_in">putchar</span>(<span class="string">&#x27;-&#x27;</span>), n = -n;</span><br><span class="line">    <span class="keyword">if</span> (n == <span class="number">0</span>) <span class="built_in">putchar</span>(<span class="string">&#x27;0&#x27;</span>);</span><br><span class="line">    <span class="keyword">while</span> (n) *(O1++) = (n % <span class="number">10</span>) ^ <span class="number">48</span>, n /= <span class="number">10</span>;</span><br><span class="line">    <span class="keyword">while</span> (O1 != O2) <span class="built_in">putchar</span>(*(--O1));</span><br><span class="line">    <span class="built_in">putchar</span>(ch);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">using</span> IO :: read;</span><br><span class="line"><span class="keyword">using</span> IO :: print;</span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> <span class="keyword">const</span> MAXN = <span class="number">5e5</span> + <span class="number">5</span>;</span><br><span class="line"><span class="keyword">int</span> mod;</span><br><span class="line">LL omega[MAXN];</span><br><span class="line">LL a[MAXN], b[MAXN], t[MAXN];</span><br><span class="line"></span><br><span class="line"><span class="function">LL <span class="title">qpow</span><span class="params">(LL a, LL k)</span> </span>&#123;</span><br><span class="line">  LL re = <span class="number">1</span>;</span><br><span class="line">  <span class="keyword">for</span> (; k; k &gt;&gt;= <span class="number">1</span>, a = a * a % mod)</span><br><span class="line">    <span class="keyword">if</span> (k &amp; <span class="number">1</span>) re = re * a % mod;</span><br><span class="line">  <span class="keyword">return</span> re;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">int</span> Prime[<span class="number">105</span>];</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">Getwn</span><span class="params">()</span> </span>&#123;</span><br><span class="line">  <span class="keyword">int</span> tmp = mod - <span class="number">1</span>, cnt = <span class="number">0</span>, sq = <span class="built_in">sqrt</span>(mod - <span class="number">1</span>);</span><br><span class="line">  <span class="keyword">for</span> (RI i = <span class="number">2</span>; i &lt;= sq; ++i)</span><br><span class="line">    <span class="keyword">if</span> (tmp % i == <span class="number">0</span>) &#123;</span><br><span class="line">      Prime[++cnt] = i;</span><br><span class="line">      <span class="keyword">while</span> (tmp % i == <span class="number">0</span>)</span><br><span class="line">        tmp /= i;</span><br><span class="line">    &#125;</span><br><span class="line">  <span class="keyword">if</span> (tmp != <span class="number">1</span>) Prime[++cnt] = tmp;</span><br><span class="line">  <span class="keyword">for</span> (RI i = <span class="number">2</span>; <span class="number">666</span>; ++i) &#123;</span><br><span class="line">    <span class="keyword">int</span> flag = <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">for</span> (RI j = <span class="number">1</span>; flag &amp;&amp; j &lt;= cnt; ++j)</span><br><span class="line">      <span class="keyword">if</span> (qpow(i, (mod - <span class="number">1</span>) / Prime[j]) == <span class="number">1</span>)</span><br><span class="line">        flag = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">if</span> (flag) <span class="keyword">return</span> i;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">FFT</span><span class="params">(LL *a, <span class="keyword">int</span> len, <span class="keyword">int</span> l, <span class="keyword">int</span> r, <span class="keyword">int</span> op)</span> </span>&#123;</span><br><span class="line">  <span class="keyword">if</span> (len == <span class="number">1</span>) <span class="keyword">return</span> <span class="keyword">void</span>();</span><br><span class="line">  <span class="keyword">for</span> (RI i = l; i &lt;= r; ++i) t[i] = a[i];</span><br><span class="line">  <span class="keyword">int</span> p = <span class="number">-1</span>;</span><br><span class="line">  <span class="keyword">if</span> (len % <span class="number">7</span> == <span class="number">0</span>) p = <span class="number">7</span>;</span><br><span class="line">  <span class="keyword">if</span> (len % <span class="number">5</span> == <span class="number">0</span>) p = <span class="number">5</span>;</span><br><span class="line">  <span class="keyword">if</span> (len % <span class="number">3</span> == <span class="number">0</span>) p = <span class="number">3</span>;</span><br><span class="line">  <span class="keyword">if</span> (len % <span class="number">2</span> == <span class="number">0</span>) p = <span class="number">2</span>;</span><br><span class="line">  <span class="keyword">int</span> L[<span class="number">10</span>] = &#123;<span class="number">0</span>&#125;, R[<span class="number">10</span>] = &#123;<span class="number">0</span>&#125;;</span><br><span class="line">  <span class="keyword">int</span> cur = l, sz = len / p;</span><br><span class="line">  <span class="keyword">for</span> (RI i = <span class="number">0</span>; i &lt; p; ++i)</span><br><span class="line">    L[i] = cur, R[i] = cur - <span class="number">1</span>, cur += sz;</span><br><span class="line">  <span class="keyword">for</span> (RI i = l; i &lt;= r; ++i)</span><br><span class="line">    a[++R[(i - l) % p]] = t[i];</span><br><span class="line">  <span class="keyword">for</span> (RI i = <span class="number">0</span>; i &lt; p; ++i) </span><br><span class="line">    FFT(a, sz, L[i], R[i], op);</span><br><span class="line">  <span class="keyword">for</span> (RI i = l; i &lt;= r; ++i) t[i] = a[i];</span><br><span class="line">  LL wn = (mod - <span class="number">1</span>) / len, w = <span class="number">0</span>;</span><br><span class="line">  <span class="keyword">for</span> (RI i = l; i &lt;= r; ++i) &#123;</span><br><span class="line">    LL tmp = <span class="number">0</span>; a[i] = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span> (RI j = (i - l) % (len / p) + l; j &lt;= r; j += sz) &#123;</span><br><span class="line">      a[i] = (a[i] + t[j] * omega[tmp] % mod) % mod;</span><br><span class="line">      tmp = (tmp + w) % (mod - <span class="number">1</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    w = (w + op * wn + mod - <span class="number">1</span>) % (mod - <span class="number">1</span>);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">  </span><br><span class="line"><span class="meta">#<span class="meta-keyword">ifdef</span> LOCAL</span></span><br><span class="line">  FILEIO(<span class="string">&quot;a&quot;</span>);</span><br><span class="line"><span class="meta">#<span class="meta-keyword">endif</span></span></span><br><span class="line"></span><br><span class="line">  <span class="keyword">int</span> n, C; read(n), read(C); mod = n + <span class="number">1</span>;</span><br><span class="line">  LL wn = Getwn(); omega[<span class="number">0</span>] = <span class="number">1</span>;</span><br><span class="line">  <span class="keyword">for</span> (RI i = <span class="number">1</span>; i &lt; n; ++i)</span><br><span class="line">    omega[i] = omega[i - <span class="number">1</span>] * wn % mod;</span><br><span class="line">  <span class="keyword">for</span> (RI i = <span class="number">0</span>; i &lt; n; ++i) read(a[i]);</span><br><span class="line">  <span class="keyword">for</span> (RI i = <span class="number">0</span>; i &lt; n; ++i) read(b[i]);</span><br><span class="line">  FFT(a, n, <span class="number">0</span>, n - <span class="number">1</span>, <span class="number">1</span>);</span><br><span class="line">  FFT(b, n, <span class="number">0</span>, n - <span class="number">1</span>, <span class="number">1</span>);</span><br><span class="line">  <span class="keyword">for</span> (RI i = <span class="number">0</span>; i &lt; n; ++i)</span><br><span class="line">    a[i] = a[i] * qpow(b[i], C) % mod;</span><br><span class="line">  FFT(a, n, <span class="number">0</span>, n - <span class="number">1</span>, <span class="number">-1</span>);</span><br><span class="line">  <span class="keyword">for</span> (RI i = <span class="number">0</span>; i &lt; n; ++i)</span><br><span class="line">    print(a[i] * qpow(n, mod - <span class="number">2</span>) % mod);</span><br><span class="line"></span><br><span class="line">  <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// created by Daniel yuan</span></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">     ________</span></span><br><span class="line"><span class="comment">    /        \</span></span><br><span class="line"><span class="comment">   / /      \ \</span></span><br><span class="line"><span class="comment">  / /        \ \</span></span><br><span class="line"><span class="comment">  \            /</span></span><br><span class="line"><span class="comment">   \  ______  /</span></span><br><span class="line"><span class="comment">    \________/</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"></span><br></pre></td></tr></table></figure><link rel="stylesheet" href="/css/spoiler.css" type="text/css"><script src="/js/spoiler.js" type="text/javascript" async></script>]]></content>
    
    
    <summary type="html">&lt;p&gt;不难发现就是求 &lt;span class=&quot;math inline&quot;&gt;\(A*B^C\)&lt;/span&gt; 的长度为 &lt;span class=&quot;math inline&quot;&gt;\(n\)&lt;/span&gt; 的循环卷积（这都看不出来还配做这个题？）&lt;/p&gt;</summary>
    
    
    
    
    <category term="循环卷积" scheme="http://example.com/tags/%E5%BE%AA%E7%8E%AF%E5%8D%B7%E7%A7%AF/"/>
    
  </entry>
  
  <entry>
    <title>[HNOI2019] 白兔之舞 题解</title>
    <link href="http://example.com/2021/01/29/HNOI2019-%E7%99%BD%E5%85%94%E4%B9%8B%E8%88%9E-%E9%A2%98%E8%A7%A3/"/>
    <id>http://example.com/2021/01/29/HNOI2019-%E7%99%BD%E5%85%94%E4%B9%8B%E8%88%9E-%E9%A2%98%E8%A7%A3/</id>
    <published>2021-01-29T03:28:58.000Z</published>
    <updated>2021-01-29T08:44:55.293Z</updated>
    
    <content type="html"><![CDATA[<p><del>白兔虐我千百遍，我待白兔如初恋。</del></p><p>随着单位根反演的普及，这道题或许会逐渐成为模板。</p><a id="more"></a><p>设 <span class="math inline">\(F_i\)</span> 表示走 <span class="math inline">\(i\)</span> 步到 <span class="math inline">\(y\)</span> 得到方案，那么显然有： <span class="math display">\[F_i={L \choose i}A^i[x][y]\]</span> 其中 <span class="math inline">\(A\)</span> 矩阵是给出的邻接矩阵 <span class="math inline">\(w\)</span>。（如果这个都不会还学什么单位根反演？）</p><p>设 <span class="math inline">\(G_x\)</span> 表示表示最终的 <span class="math inline">\(x\)</span> 的答案，那么显然 <span class="math inline">\(G_x=\sum_iF_i[i\text{ mod }k=x]\)</span>。括号内的内容等价于 <span class="math inline">\(k|i-x\)</span>。</p><p>直接套单位根反演，就有 <span class="math inline">\(G_x=\frac{1}{k}\sum_{j=0}^{k-1}\omega_k^{-xj}\sum_{i=0}^L{L \choose i}A^i[x][y]\omega_k^{ij}\)</span>。</p><p>不难发现后面一堆就是 <span class="math inline">\((A\omega_k^j+I)^L[x][y]\)</span>，直接矩阵快速幂算即可，设算出来的结果为 <span class="math inline">\(H_j\)</span>，那么原式就等于 <span class="math inline">\(\frac{1}{k}\sum_{j=0}^{k-1}\omega_k^{-xj}H_j\)</span>。</p><p>按照 Bluestein 的套路，把 <span class="math inline">\(-xj\)</span> 拆成 <span class="math inline">\({j \choose 2}+{x \choose 2}-{j+x \choose 2}\)</span>，那么原式就为 <span class="math inline">\(\frac{1}{k}\omega_k^{x\choose 2}\sum_{j=0}^{k-1}\omega_k^{j \choose 2}H_j\cdot\omega_k^{j+x\choose 2}\)</span>，不难发现右边是一个减法卷积，直接任意模数 FFT 即可。</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> RI register int</span></span><br><span class="line"><span class="keyword">typedef</span> <span class="keyword">long</span> <span class="keyword">long</span> LL;</span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> FILEIO(name) freopen(name<span class="meta-string">&quot;.in&quot;</span>, <span class="meta-string">&quot;r&quot;</span>, stdin), freopen(name<span class="meta-string">&quot;.out&quot;</span>, <span class="meta-string">&quot;w&quot;</span>, stdout);</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> <span class="keyword">const</span> MAXN = <span class="number">3e5</span> + <span class="number">5</span>;</span><br><span class="line">LL n, k, L, x, y, mod;</span><br><span class="line"></span><br><span class="line"><span class="function">LL <span class="title">qpow</span><span class="params">(LL a, LL k)</span> </span>&#123;</span><br><span class="line">  LL re = <span class="number">1</span>;</span><br><span class="line">  <span class="keyword">for</span> (; k; k &gt;&gt;= <span class="number">1</span>, a = a * a % mod)</span><br><span class="line">    <span class="keyword">if</span> (k &amp; <span class="number">1</span>) re = re * a % mod;</span><br><span class="line">  <span class="keyword">return</span> re;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> Prime[<span class="number">105</span>];</span><br><span class="line"><span class="function">LL <span class="title">Getwn</span><span class="params">()</span> </span>&#123;</span><br><span class="line">  <span class="keyword">int</span> cnt = <span class="number">0</span>, tmp = mod - <span class="number">1</span>, sq = <span class="built_in">sqrt</span>(mod);</span><br><span class="line">  <span class="keyword">for</span> (RI i = <span class="number">2</span>; i &lt;= sq; ++i)</span><br><span class="line">    <span class="keyword">if</span> (tmp % i == <span class="number">0</span>) &#123;</span><br><span class="line">      Prime[++cnt] = i;</span><br><span class="line">      <span class="keyword">while</span> (tmp % i == <span class="number">0</span>)</span><br><span class="line">        tmp /= i;</span><br><span class="line">    &#125;</span><br><span class="line">  <span class="keyword">if</span> (tmp != <span class="number">1</span>) Prime[++cnt] = tmp;</span><br><span class="line">  <span class="keyword">for</span> (RI i = <span class="number">2</span>; <span class="number">666</span>; ++i) &#123;</span><br><span class="line">    <span class="keyword">int</span> flag = <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">for</span> (RI j = <span class="number">1</span>; flag &amp;&amp; j &lt;= cnt; ++j)</span><br><span class="line">      <span class="keyword">if</span> (qpow(i, (mod - <span class="number">1</span>) / Prime[j]) == <span class="number">1</span>)</span><br><span class="line">        flag = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">if</span> (flag == <span class="number">1</span>)</span><br><span class="line">      <span class="keyword">return</span> qpow(i, (mod - <span class="number">1</span>) / k);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">Matrix</span> &#123;</span></span><br><span class="line">  LL a[<span class="number">3</span>][<span class="number">3</span>];</span><br><span class="line">  Matrix <span class="keyword">operator</span> * (<span class="keyword">const</span> Matrix &amp;A) &#123;</span><br><span class="line">    Matrix re;</span><br><span class="line">    <span class="keyword">for</span> (RI i = <span class="number">0</span>; i &lt; n; ++i)</span><br><span class="line">      <span class="keyword">for</span> (RI j = <span class="number">0</span>; j &lt; n; ++j) &#123;</span><br><span class="line">        re.a[i][j] = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">for</span> (RI k = <span class="number">0</span>; k &lt; n; ++k)</span><br><span class="line">          re.a[i][j] += a[i][k] * A.a[k][j];</span><br><span class="line">        re.a[i][j] %= mod;</span><br><span class="line">      &#125;</span><br><span class="line">    <span class="keyword">return</span> re;</span><br><span class="line">  &#125;</span><br><span class="line">  Matrix <span class="keyword">operator</span> * (<span class="keyword">const</span> LL &amp;A) &#123;</span><br><span class="line">    Matrix re;</span><br><span class="line">    <span class="keyword">for</span> (RI i = <span class="number">0</span>; i &lt; n; ++i)</span><br><span class="line">      <span class="keyword">for</span> (RI j = <span class="number">0</span>; j &lt; n; ++j)</span><br><span class="line">        re.a[i][j] = a[i][j] * A % mod;</span><br><span class="line">    <span class="keyword">return</span> re;</span><br><span class="line">  &#125;</span><br><span class="line">  Matrix <span class="keyword">operator</span> + (<span class="keyword">const</span> Matrix &amp;A) &#123;</span><br><span class="line">    Matrix re;</span><br><span class="line">    <span class="keyword">for</span> (RI i = <span class="number">0</span>; i &lt; n; ++i)</span><br><span class="line">      <span class="keyword">for</span> (RI j = <span class="number">0</span>; j &lt; n; ++j)</span><br><span class="line">        re.a[i][j] = (a[i][j] + A.a[i][j]) % mod;</span><br><span class="line">    <span class="keyword">return</span> re;</span><br><span class="line">  &#125;</span><br><span class="line">&#125; E, I, F;</span><br><span class="line"><span class="function">Matrix <span class="title">Matrixqpow</span><span class="params">(Matrix a, <span class="keyword">int</span> k)</span> </span>&#123;</span><br><span class="line">  Matrix re; re = I;</span><br><span class="line">  <span class="keyword">for</span> (; k; k &gt;&gt;= <span class="number">1</span>, a = a * a)</span><br><span class="line">    <span class="keyword">if</span> (k &amp; <span class="number">1</span>) re = re * a;</span><br><span class="line">  <span class="keyword">return</span> re;</span><br><span class="line">&#125;</span><br><span class="line">LL A[MAXN], B[MAXN];</span><br><span class="line"></span><br><span class="line"><span class="keyword">namespace</span> FuckFuckTmd &#123;</span><br><span class="line">  <span class="keyword">double</span> <span class="keyword">const</span> PI = <span class="built_in">acos</span>(<span class="number">-1.0</span>);</span><br><span class="line">  <span class="keyword">int</span> <span class="keyword">const</span> M = <span class="number">32767</span>;</span><br><span class="line">  <span class="keyword">int</span> r[MAXN];</span><br><span class="line">  <span class="class"><span class="keyword">struct</span> <span class="title">Complex</span> &#123;</span></span><br><span class="line">    <span class="keyword">double</span> a, b;</span><br><span class="line">    Complex (<span class="keyword">double</span> _a = <span class="number">0</span>, <span class="keyword">double</span> _b = <span class="number">0</span>) &#123; a = _a, b = _b; &#125;</span><br><span class="line">    Complex <span class="keyword">operator</span> + (<span class="keyword">const</span> Complex &amp;A) &#123; <span class="keyword">return</span> Complex(a + A.a, b + A.b); &#125;</span><br><span class="line">    Complex <span class="keyword">operator</span> - (<span class="keyword">const</span> Complex &amp;A) &#123; <span class="keyword">return</span> Complex(a - A.a, b - A.b); &#125;</span><br><span class="line">    Complex <span class="keyword">operator</span> * (<span class="keyword">const</span> Complex &amp;A) &#123; <span class="keyword">return</span> Complex(a * A.a - b * A.b, a * A.b + b * A.a); &#125;</span><br><span class="line">  &#125; omega[MAXN], A[MAXN], B[MAXN], C[MAXN], D[MAXN], F[MAXN], G[MAXN], H[MAXN];</span><br><span class="line">  LL RE[MAXN];</span><br><span class="line">  <span class="function"><span class="keyword">void</span> <span class="title">FFT</span><span class="params">(Complex *a, <span class="keyword">int</span> len, <span class="keyword">int</span> op)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">for</span> (RI i = <span class="number">0</span>; i &lt; len; ++i)</span><br><span class="line">      <span class="keyword">if</span> (r[i] &gt; i)</span><br><span class="line">        swap(a[i], a[r[i]]);</span><br><span class="line">    <span class="keyword">for</span> (RI i = <span class="number">2</span>; i &lt;= len; i &lt;&lt;= <span class="number">1</span>) &#123;</span><br><span class="line">      <span class="keyword">int</span> wn = len / i;</span><br><span class="line">      <span class="keyword">for</span> (RI j = <span class="number">0</span>; j &lt; len; j += i) &#123;</span><br><span class="line">        <span class="keyword">int</span> w = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">for</span> (RI k = j; k &lt; j + i / <span class="number">2</span>; ++k) &#123;</span><br><span class="line">          Complex x = a[k], y = a[k + i / <span class="number">2</span>] * omega[w];</span><br><span class="line">          a[k] = x + y;</span><br><span class="line">          a[k + i / <span class="number">2</span>] = x - y;</span><br><span class="line">          w = (w + op * wn + len) % len;</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="function"><span class="keyword">void</span> <span class="title">FUCKFFT</span><span class="params">(LL *a, <span class="keyword">int</span> lena, LL *b, <span class="keyword">int</span> lenb)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">for</span> (RI i = <span class="number">0</span>; i &lt; lena; ++i) &#123;</span><br><span class="line">      A[i].a = (a[i] &gt;&gt; <span class="number">15</span>) &amp; M;</span><br><span class="line">      B[i].a = a[i] &amp; M;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">for</span> (RI i = <span class="number">0</span>; i &lt; lenb; ++i) &#123;</span><br><span class="line">      C[i].a = (b[i] &gt;&gt; <span class="number">15</span>) &amp; M;</span><br><span class="line">      D[i].a = b[i] &amp; M;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">int</span> len = <span class="number">1</span>, cnt = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">while</span> (len &lt; lena + lenb - <span class="number">1</span>)</span><br><span class="line">      len &lt;&lt;= <span class="number">1</span>, ++cnt;</span><br><span class="line">    <span class="keyword">for</span> (RI i = <span class="number">0</span>; i &lt; len; ++i)</span><br><span class="line">      r[i] = (r[i &gt;&gt; <span class="number">1</span>] &gt;&gt; <span class="number">1</span>) | ((i &amp; <span class="number">1</span>) &lt;&lt; (cnt - <span class="number">1</span>));</span><br><span class="line">    <span class="keyword">for</span> (RI i = <span class="number">0</span>; i &lt; len; ++i) &#123;</span><br><span class="line">      <span class="keyword">double</span> deg = <span class="number">2.0</span> * PI * i / len;</span><br><span class="line">      omega[i] = Complex(<span class="built_in">cos</span>(deg), <span class="built_in">sin</span>(deg));</span><br><span class="line">    &#125;</span><br><span class="line">    FFT(A, len, <span class="number">1</span>), FFT(B, len, <span class="number">1</span>);</span><br><span class="line">    FFT(C, len, <span class="number">1</span>), FFT(D, len, <span class="number">1</span>);</span><br><span class="line">    <span class="keyword">for</span> (RI i = <span class="number">0</span>; i &lt; len; ++i) &#123;</span><br><span class="line">      F[i] = A[i] * C[i];</span><br><span class="line">      G[i] = A[i] * D[i] + B[i] * C[i];</span><br><span class="line">      H[i] = B[i] * D[i];</span><br><span class="line">    &#125;</span><br><span class="line">    FFT(F, len, <span class="number">-1</span>), FFT(G, len, <span class="number">-1</span>), FFT(H, len, <span class="number">-1</span>);</span><br><span class="line">    <span class="keyword">for</span> (RI i = <span class="number">0</span>; i &lt; len; ++i) &#123;</span><br><span class="line">      RE[i] = LL(F[i].a / len + <span class="number">0.5</span>) % mod * (M + <span class="number">1</span>) % mod * (M + <span class="number">1</span>) % mod;</span><br><span class="line">      RE[i] = (RE[i] + LL(G[i].a / len + <span class="number">0.5</span>) % mod * (M + <span class="number">1</span>) % mod) % mod;</span><br><span class="line">      RE[i] = (RE[i] + LL(H[i].a / len + <span class="number">0.5</span>) % mod) % mod;</span><br><span class="line">      RE[i] = (RE[i] % mod + mod) % mod;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//LL ans[MAXN];</span></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">  </span><br><span class="line"><span class="meta">#<span class="meta-keyword">ifdef</span> LOCAL</span></span><br><span class="line">  FILEIO(<span class="string">&quot;a&quot;</span>);</span><br><span class="line"><span class="meta">#<span class="meta-keyword">endif</span></span></span><br><span class="line"></span><br><span class="line">  <span class="built_in">cin</span> &gt;&gt; n &gt;&gt; k &gt;&gt; L &gt;&gt; x &gt;&gt; y &gt;&gt; mod; --x, --y;</span><br><span class="line">  <span class="keyword">for</span> (RI i = <span class="number">0</span>; i &lt; n; ++i)</span><br><span class="line">    <span class="keyword">for</span> (RI j = <span class="number">0</span>; j &lt; n; ++j) &#123;</span><br><span class="line">      <span class="built_in">cin</span> &gt;&gt; E.a[i][j];</span><br><span class="line">      I.a[i][j] = (i == j);</span><br><span class="line">    &#125;</span><br><span class="line">  LL wn = Getwn(), w = <span class="number">1</span>;</span><br><span class="line">  <span class="keyword">int</span> lenF = k, lenG = <span class="number">2</span> * k - <span class="number">1</span>;</span><br><span class="line">  <span class="keyword">for</span> (RI i = <span class="number">0</span>; i &lt; lenF; ++i) &#123;</span><br><span class="line">    F = E * w + I;</span><br><span class="line">    F = Matrixqpow(F, L);</span><br><span class="line">    A[i] = F.a[x][y];</span><br><span class="line">    A[i] = A[i] * qpow(wn, <span class="number">1l</span>l * i * (i - <span class="number">1</span>) / <span class="number">2</span>) % mod;</span><br><span class="line">    w = w * wn % mod;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">for</span> (RI i = <span class="number">0</span>; i &lt; lenG; ++i)</span><br><span class="line">    B[i] = qpow(wn, k - <span class="number">1l</span>l * i * (i - <span class="number">1</span>) / <span class="number">2</span> % k);</span><br><span class="line">  <span class="comment">// for (RI i = 0; i &lt; lenF; ++i)</span></span><br><span class="line">  <span class="comment">//   for (RI j = i; j &lt; lenG; ++j)</span></span><br><span class="line">  <span class="comment">//     ans[j - i] = (ans[j - i] + A[i] * B[j] % mod) % mod;</span></span><br><span class="line">  <span class="keyword">for</span> (RI i = <span class="number">0</span>, j = lenG - <span class="number">1</span>; i &lt; j; ++i, --j)</span><br><span class="line">    swap(B[i], B[j]);</span><br><span class="line">  FuckFuckTmd :: FUCKFFT(A, lenF, B, lenG);</span><br><span class="line">  LL *ans = FuckFuckTmd :: RE;</span><br><span class="line">  <span class="keyword">for</span> (RI i = <span class="number">0</span>; i &lt; k; ++i) &#123;</span><br><span class="line">    LL val = ans[lenG - <span class="number">1</span> - i];</span><br><span class="line">    val = val * qpow(k, mod - <span class="number">2</span>) % mod * qpow(wn, <span class="number">1l</span>l * i * (i - <span class="number">1</span>) / <span class="number">2</span>) % mod;</span><br><span class="line">    <span class="built_in">cout</span> &lt;&lt; val &lt;&lt; <span class="built_in">endl</span>;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// created by Daniel yuan</span></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">     ________</span></span><br><span class="line"><span class="comment">    /        \</span></span><br><span class="line"><span class="comment">   / /      \ \</span></span><br><span class="line"><span class="comment">  / /        \ \</span></span><br><span class="line"><span class="comment">  \            /</span></span><br><span class="line"><span class="comment">   \  ______  /</span></span><br><span class="line"><span class="comment">    \________/</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"></span><br></pre></td></tr></table></figure><link rel="stylesheet" href="/css/spoiler.css" type="text/css"><script src="/js/spoiler.js" type="text/javascript" async></script>]]></content>
    
    
    <summary type="html">&lt;p&gt;&lt;del&gt;白兔虐我千百遍，我待白兔如初恋。&lt;/del&gt;&lt;/p&gt;
&lt;p&gt;随着单位根反演的普及，这道题或许会逐渐成为模板。&lt;/p&gt;</summary>
    
    
    
    
    <category term="单位根反演" scheme="http://example.com/tags/%E5%8D%95%E4%BD%8D%E6%A0%B9%E5%8F%8D%E6%BC%94/"/>
    
    <category term="循环卷积" scheme="http://example.com/tags/%E5%BE%AA%E7%8E%AF%E5%8D%B7%E7%A7%AF/"/>
    
    <category term="多项式" scheme="http://example.com/tags/%E5%A4%9A%E9%A1%B9%E5%BC%8F/"/>
    
  </entry>
  
  <entry>
    <title>BZOJ3328 PYXFIB 题解</title>
    <link href="http://example.com/2021/01/28/BZOJ3328-PYXFIB-%E9%A2%98%E8%A7%A3/"/>
    <id>http://example.com/2021/01/28/BZOJ3328-PYXFIB-%E9%A2%98%E8%A7%A3/</id>
    <published>2021-01-28T12:26:26.000Z</published>
    <updated>2021-01-28T12:51:28.872Z</updated>
    
    <content type="html"><![CDATA[<p>好像网上没有这么做的题解，所以就写个吧。</p><a id="more"></a><p>直接单位根反演，就有： <span class="math display">\[\frac{1}{k}\sum_{j=0}^{k-1}\sum_{i=0}^n{n \choose i}(\omega_k^j)^iF_i\]</span> 正常的做法是把斐波那契数用矩阵表示，然后用二项式定理。</p><p>考虑直接头铁用通项公式展开斐波那契数，就有 <span class="math display">\[\frac{1}{\sqrt{5}k}\sum_{j=0}^{k-1}\left(\frac{1+\sqrt{5}}{2}(1+\frac{1+\sqrt{5}}{2}\omega_k^j)^n-\frac{1-\sqrt{5}}{2}(1+\frac{1-\sqrt{5}}{2}\omega_k^j)^n\right)\]</span> 在模意义下可能没有 <span class="math inline">\(5\)</span> 的二次剩余，故考虑扩域，把数表示成 <span class="math inline">\(a+b\sqrt{5}\)</span> 的形式。</p><p>定义一下扩域后数的加减乘除然后直接做即可。在这里除法的本质是求逆元，也就是求 <span class="math inline">\(c+d\sqrt{5}\)</span> 使得它和 <span class="math inline">\(a+b\sqrt{5}\)</span> 乘起来为 <span class="math inline">\(1\)</span>。</p><p>不过需要注意的是，当 <span class="math inline">\(P=5\)</span> 的时候，<span class="math inline">\(\frac{1}{\sqrt{5}k}\)</span> 没有逆元，这样就会 WA，考虑特殊处理一下。</p><p>可以发现 <span class="math inline">\(\frac{1}{\sqrt{5}k}\)</span> 表示成 <span class="math inline">\(a+b\sqrt{5}\)</span> 的形式的时候 <span class="math inline">\(a=0\)</span>，那么当 <span class="math inline">\(P\not=5\)</span> 的时候它的逆元 <span class="math inline">\(a=0\)</span>，既然这样，后面的式子求出来的 <span class="math inline">\(a\)</span> 也会等于 <span class="math inline">\(0\)</span>。</p><p>所以我们根本没有必要在这一步把这个复数求逆，直接把 <span class="math inline">\(k\)</span> 求逆乘上后面的式子求出来的 <span class="math inline">\(b\)</span> 即可。</p><p>常数可能会比矩阵乘法的做法小。</p><link rel="stylesheet" href="/css/spoiler.css" type="text/css"><script src="/js/spoiler.js" type="text/javascript" async></script>]]></content>
    
    
    <summary type="html">&lt;p&gt;好像网上没有这么做的题解，所以就写个吧。&lt;/p&gt;</summary>
    
    
    
    
    <category term="单位根反演" scheme="http://example.com/tags/%E5%8D%95%E4%BD%8D%E6%A0%B9%E5%8F%8D%E6%BC%94/"/>
    
  </entry>
  
  <entry>
    <title>单位根反演学习笔记</title>
    <link href="http://example.com/2021/01/28/%E5%8D%95%E4%BD%8D%E6%A0%B9%E5%8F%8D%E6%BC%94%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/"/>
    <id>http://example.com/2021/01/28/%E5%8D%95%E4%BD%8D%E6%A0%B9%E5%8F%8D%E6%BC%94%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/</id>
    <published>2021-01-28T08:39:39.000Z</published>
    <updated>2021-01-28T09:16:24.028Z</updated>
    
    <content type="html"><![CDATA[<p>以下等式被称作单位根反演：</p><a id="more"></a><p><span class="math display">\[[n|k]=\frac{1}{n}\sum_{i=0}^{n-1}\omega_n^{ik}\]</span> 其中 <span class="math inline">\(\omega_n\)</span> 表示在所求域内的 <span class="math inline">\(n\)</span> 次单位根。<span class="math inline">\(n\)</span> 次单位根的定义是，若 <span class="math inline">\(\omega_n\)</span> 是 <span class="math inline">\(n\)</span> 次单位根当且仅当 <span class="math inline">\(\omega_n^0,\omega_n^1...\omega_n^{n-1}\)</span> 互不相同，且 <span class="math inline">\(\omega_n^0=\omega_n^n\)</span>。一般来说所求域会是模大质数 <span class="math inline">\(P\)</span> 的同余域，所以若设 <span class="math inline">\(g\)</span> 为 <span class="math inline">\(P\)</span> 的原根，那么在该域下，<span class="math inline">\(n\)</span> 次单位根为 <span class="math inline">\(g^{\frac{P-1}{n}}\)</span>。</p><p>关于单位根，有个比较显然的等式，即 <span class="math inline">\(\omega_n^k=\omega_n^{k\text{ mod }n}\)</span>。</p><p>基于上面的等式，就有了一种单位根反演证明方法：</p><ol type="1"><li>若 <span class="math inline">\([n|k]\)</span> 那么 <span class="math inline">\(\omega_n^{ik}=1\)</span>，所以右边的式子算出来就是 <span class="math inline">\(1\)</span>。</li><li>反之，<span class="math inline">\(\sum_{i=0}^{n-1}\omega_n^{ik}=\sum_{i=0}^{n-1}(\omega_n^k)^i=\frac{1-\omega_n^n}{1-\omega_n^k}\)</span>，因为前提，分母一定不是 <span class="math inline">\(0\)</span>，而分子为 <span class="math inline">\(0\)</span>，所以整体为 <span class="math inline">\(0\)</span>。</li></ol><p>故得证。</p><hr /><p>虽然单位根反演看上去特别简单，但是在用的时候其实很难把一个式子和单位根反演联系起来，这就需要多加练习。</p><p>举个栗子：<a href="https://loj.ac/p/6485">LOJ #6485 LJJ 学二项式定理</a>。 <span class="math display">\[\begin{aligned}&amp;\sum_{i=0}^n{n \choose i}s^ia_{i\text{ mod }4}\\=&amp;\sum_{i=0}^n{n\choose i}s^i\sum_{j=0}^3[4|i-j]a_j\\=&amp;\sum_{i=0}^n{n\choose i}s^i\sum_{j=0}^3a_j\frac{1}{4}\sum_{k=0}^3\omega_4^{(i-j)k}\\=&amp;\frac{1}{4}\sum_{j=0}^3a_j\sum_{k=0}^3\sum_{i=0}^n{n\choose i}s^i\omega_4^{ik-jk}\\=&amp;\frac{1}{4}\sum_{j=0}^3a_j\sum_{k=0}^3\omega_4^{-jk}\sum_{i=0}^n{n\choose i}s^i\omega_4^{ik}\\=&amp;\frac{1}{4}\sum_{j=0}^3a_j\sum_{k=0}^3\omega_4^{-jk}(1+s\omega_4^k)^n\end{aligned}\]</span> 当然，直接看推式子的话，这道题就浪费了，所以接下来梳理一下解题思路。</p><p>首先直接求和肯定是不好求的，因为后面的下标取模非常麻烦，但是我们可以把后面的模枚举出来，就有了第一步。</p><p>之后直接套用单位根反演，并且可以发现组合数和 <span class="math inline">\(s^i\)</span> 很像二项式定理，所以对单位根的指数进行一些分裂等处理，使得所有和 <span class="math inline">\(i\)</span> 有关的项全部被分离，并且把带 <span class="math inline">\(i\)</span> 的项通过二项式定理合并。</p><p>最后就只需要模拟求和式了，复杂度 <span class="math inline">\(O(9\times \log n)\)</span>。</p><hr /><p>其实很多单位根反演都是把模或者除之类的算术暴力展开，得到一个符合单位根反演的式子之后直接反演，然后通过对单位根指数的分裂与合并，把单位根的各项分配到合适的地方去，之后就通过一些数学方法合并一些式子，使得求和式变得简单。</p><link rel="stylesheet" href="/css/spoiler.css" type="text/css"><script src="/js/spoiler.js" type="text/javascript" async></script>]]></content>
    
    
    <summary type="html">&lt;p&gt;以下等式被称作单位根反演：&lt;/p&gt;</summary>
    
    
    
    
    <category term="数学" scheme="http://example.com/tags/%E6%95%B0%E5%AD%A6/"/>
    
    <category term="反演" scheme="http://example.com/tags/%E5%8F%8D%E6%BC%94/"/>
    
  </entry>
  
  <entry>
    <title>[NOI2016] 循环之美 题解</title>
    <link href="http://example.com/2021/01/26/NOI2016-%E5%BE%AA%E7%8E%AF%E4%B9%8B%E7%BE%8E-%E9%A2%98%E8%A7%A3/"/>
    <id>http://example.com/2021/01/26/NOI2016-%E5%BE%AA%E7%8E%AF%E4%B9%8B%E7%BE%8E-%E9%A2%98%E8%A7%A3/</id>
    <published>2021-01-26T13:15:59.000Z</published>
    <updated>2021-01-28T08:40:30.738Z</updated>
    
    <content type="html"><![CDATA[<p>手玩发现，一个极简分数，如果其分母和进制的 <span class="math inline">\(\gcd\)</span> 为 <span class="math inline">\(1\)</span>，那么就符合题意。</p><p>那么就变成了求 <span class="math inline">\(\sum_{i=1}^n\sum_{j=1}^m[(j,k)=1][(i,j)=1]\)</span>。</p><p>其实这个求和式的化简并不难，只是需要多发现式子之间的联系。</p><a id="more"></a><h4 id="展开-ij1">1. 展开 <span class="math inline">\([(i,j)=1]\)</span>。</h4><p><span class="math display">\[\begin{aligned}&amp;\sum_{i=1}^n\sum_{j=1}^m[(j,k)=1][(i,j)=1]\\=&amp;\sum_{t=1}^n\mu(t)\lfloor\frac{n}{t}\rfloor\sum_{j=1}^{\lfloor\frac{m}{t}\rfloor}[(tj,k)=1]\\=&amp;\sum_{t=1}^n\mu(t)\lfloor\frac{n}{t}\rfloor[(t,k)=1]\sum_{a|k}\mu(a)\lfloor\frac{m}{ta}\rfloor\\=&amp;\sum_{a|k}\mu(a)\sum_{t=1}^n\mu(t)\lfloor\frac{n}{t}\rfloor[(t,k)=1]\lfloor\frac{m}{ta}\rfloor\end{aligned}\]</span></p><p>后面显然可以整除分块。但是分块后需要求 <span class="math inline">\(\sum_{i=1}^n\mu(i)[(i,k)=1]\)</span>。到在这里博主就不会了，因为这个式子看起来不可推。但是实际上设这个为 <span class="math inline">\(g(n,k)\)</span>，稍加整理： <span class="math display">\[\begin{aligned}&amp;\sum_{i=1}^n\mu(i)[(i,k)=1]\\=&amp;\sum_{a|k}\mu(a)\sum_{i=1}^{\lfloor\frac{n}{a}\rfloor}\mu(ia)\\=&amp;\sum_{a|k}\mu^2(a)\sum_{i=1}^{\lfloor\frac{n}{a}\rfloor}\mu(i)[(i,a)=1]\\=&amp;\sum_{a|k}\mu^2(a)g(\lfloor\frac{n}{a}\rfloor,a)\end{aligned}\]</span> 这个式子暴力推，<span class="math inline">\(g\)</span> 到边界亚线性筛。</p><h4 id="展开-ik1">2. 展开 <span class="math inline">\([(i,k)=1]\)</span>。</h4><p>博主一开始没有想到展开这个，但是这样推相对简单。</p><p><span class="math display">\[\begin{aligned}&amp;\sum_{i=1}^n\sum_{j=1}^m[(j,k)=1][(i,j)=1]\\=&amp;\sum_{a|k}\mu(a)\sum_{i=1}^n\sum_{j=1}^{\lfloor\frac{m}{a}\rfloor}[(i,ja)=1]\\=&amp;\sum_{a|k}\mu(a)\sum_{i=1}^n\sum_{j=1}^{\lfloor\frac{m}{a}\rfloor}[(i,j)=1][(i,a)=1]\end{aligned}\]</span></p><p>可以发现最后的式子和第一个式子很像，式子答案为 <span class="math inline">\(f(n,m,k)\)</span>，那么就有 <span class="math inline">\(f(n,m,k)=\sum_{a|k}f(\lfloor\frac{m}{a}\rfloor,n,a)\)</span>。到边界直接算即可。</p><hr /><p>可以发现对不同的地方展开，有两个截然不同的结果，虽然最后都可以得到正确答案，但是会有不同的推导难度。</p><p>而不管用什么，最重要的部分都是等效替代，也就是说把某个求和式设成函数 <span class="math inline">\(f\)</span>，然后在推导中注意看式子中有没有重新得到 <span class="math inline">\(f\)</span>，然后就可以得到 <span class="math inline">\(f\)</span> 之间的递推式了。</p><link rel="stylesheet" href="/css/spoiler.css" type="text/css"><script src="/js/spoiler.js" type="text/javascript" async></script>]]></content>
    
    
    <summary type="html">&lt;p&gt;手玩发现，一个极简分数，如果其分母和进制的 &lt;span class=&quot;math inline&quot;&gt;\(\gcd\)&lt;/span&gt; 为 &lt;span class=&quot;math inline&quot;&gt;\(1\)&lt;/span&gt;，那么就符合题意。&lt;/p&gt;
&lt;p&gt;那么就变成了求 &lt;span class=&quot;math inline&quot;&gt;\(\sum_{i=1}^n\sum_{j=1}^m[(j,k)=1][(i,j)=1]\)&lt;/span&gt;。&lt;/p&gt;
&lt;p&gt;其实这个求和式的化简并不难，只是需要多发现式子之间的联系。&lt;/p&gt;</summary>
    
    
    
    
    <category term="莫比乌斯反演" scheme="http://example.com/tags/%E8%8E%AB%E6%AF%94%E4%B9%8C%E6%96%AF%E5%8F%8D%E6%BC%94/"/>
    
  </entry>
  
  <entry>
    <title>[NOI2019] 序列 题解</title>
    <link href="http://example.com/2021/01/26/NOI2019-%E5%BA%8F%E5%88%97-%E9%A2%98%E8%A7%A3/"/>
    <id>http://example.com/2021/01/26/NOI2019-%E5%BA%8F%E5%88%97-%E9%A2%98%E8%A7%A3/</id>
    <published>2021-01-26T01:11:10.000Z</published>
    <updated>2021-01-26T02:51:49.752Z</updated>
    
    <content type="html"><![CDATA[<p>简单学习了模拟费用流之后一直有点迷糊，后来在交流中似乎悟到了些什么。</p><p>能推出这道题挺开心的，而且对模拟费用流有了更进一步的理解。</p><a id="more"></a><p>首先这个题目很容易建出费用流的图。</p><p>考虑每次增广都会新增一对 <span class="math inline">\(a,b\)</span>，那么我们就需要起点向 <span class="math inline">\(\{a\}\)</span> 连边，<span class="math inline">\(\{b\}\)</span> 向终点连边，这样一条路径就一定会对应一对 <span class="math inline">\(a,b\)</span>。</p><p>对于 <span class="math inline">\(K\)</span> 个下标的限制，直接对起点拆点。</p><p>而对于至少的限制，我们把其转化成最多，即最多 <span class="math inline">\(K-L\)</span> 对 <span class="math inline">\(c,d\)</span> 不相同，这样也可以用一条流量为 <span class="math inline">\(K-L\)</span> 的边表示。</p><p>而对于相同和不同的限制，如果相同那么显然可以直接流，即 <span class="math inline">\(a_i\)</span> 向 <span class="math inline">\(b_i\)</span> 连边。而如果不同，那么就需要通过上一行的边，所以建立两个辅助节点 <span class="math inline">\(L,R\)</span>，<span class="math inline">\(L\)</span> 向 <span class="math inline">\(R\)</span> 连 <span class="math inline">\(K-L\)</span> 的边，然后 <span class="math inline">\(\{a\}\)</span> 向 <span class="math inline">\(L\)</span> 连边，<span class="math inline">\(R\)</span> 向 <span class="math inline">\(\{b\}\)</span> 连边。</p><p>因为我们在增广的同时要保证最大，所以在所有起点向 <span class="math inline">\(\{a\}\)</span> 的边上和 <span class="math inline">\(\{b\}\)</span> 向终点的边上加上他们的权值的费用，其它边的费用为 <span class="math inline">\(0\)</span>，这样就有了一个费用流的模型。</p><p><a href="https://imgchr.com/i/sXiJIJ"><img src="https://s3.ax1x.com/2021/01/26/sXiJIJ.png" /></a></p><p>直接费用流肯定过不了，考虑模拟费用流。</p><p>我们可以发现一共有六种增广方式。 <span class="math display">\[\begin{aligned}&amp;S \rightarrow A \rightarrow B \rightarrow T\\&amp;S \rightarrow A \rightarrow L \rightarrow R \rightarrow B \rightarrow T\\&amp;S \rightarrow A_1 \rightarrow L \rightarrow A_2 \rightarrow B_2 \rightarrow T\\&amp;S \rightarrow A_1 \rightarrow B_1 \rightarrow R \rightarrow B_2 \rightarrow T\\&amp;S \rightarrow A_1 \rightarrow L \rightarrow A_2 \rightarrow B_2 \rightarrow R \rightarrow B_3 \rightarrow T\\&amp;S \rightarrow A_1 \rightarrow B_1 \rightarrow R \rightarrow B_2 \rightarrow A_2 \rightarrow L \rightarrow A_3 \rightarrow B_3 \rightarrow T\\\end{aligned}\]</span> 在有下标的路径中，下标相同的点的位置相同。（如 <span class="math inline">\(A_1\)</span> 和 <span class="math inline">\(B_1\)</span> 的）</p><p>可以发现其中只有路径 <span class="math inline">\(2\)</span> 会经过 <span class="math inline">\(L\rightarrow R\)</span> 的边，所以我们可以先贪心把路径 <span class="math inline">\(2\)</span> 走完，然后再增广 <span class="math inline">\(K-L\)</span> 次。</p><p>考虑剩下的增广，设 <span class="math inline">\(P\)</span> 为没选的点的集合，<span class="math inline">\(Q\)</span> 为选了的点，且当前状态是用 <span class="math inline">\(L\rightarrow R\)</span> 边形成的集合，<span class="math inline">\(O\)</span> 为选了的点，且当前状态是用 <span class="math inline">\(A_i\rightarrow B_i\)</span> 的边形成的集合。</p><p>那么对于剩下的五种路径，我们有以下限制： <span class="math display">\[\begin{aligned}A, B   \in &amp;P\\\text{}\\A_1, B_2 \in &amp;P; &amp;A_2     \in &amp;Q\\A_1, B_2 \in &amp;P; &amp;B_1     \in &amp;Q\\A_1, B_3 \in &amp;P; &amp;A_2, B_2 \in &amp;Q\\A_1, B_3 \in &amp;P; &amp;B_1, A_3 \in &amp;Q; &amp;A_2, B_2 \in O\end{aligned}\]</span> 然后在增广完之后，上面的五条路径分别会出现这样的改变：</p><table><colgroup><col style="width: 12%" /><col style="width: 14%" /><col style="width: 14%" /><col style="width: 14%" /><col style="width: 14%" /><col style="width: 14%" /><col style="width: 14%" /></colgroup><thead><tr class="header"><th></th><th><span class="math inline">\(\text{insert } O\)</span></th><th><span class="math inline">\(\text{delete } O\)</span></th><th><span class="math inline">\(\text{insert } Q\)</span></th><th><span class="math inline">\(\text{delete } Q\)</span></th><th><span class="math inline">\(\text{insert }P\)</span></th><th><span class="math inline">\(\text{delete }P\)</span></th></tr></thead><tbody><tr class="odd"><td><span class="math inline">\(\text{path 1}\)</span></td><td><span class="math inline">\(A,B\)</span></td><td></td><td></td><td></td><td></td><td><span class="math inline">\(A,B\)</span></td></tr><tr class="even"><td><span class="math inline">\(\text{path 3}\)</span></td><td><span class="math inline">\(A_2,B_2\)</span></td><td></td><td><span class="math inline">\(A_1\)</span></td><td><span class="math inline">\(A_2\)</span></td><td></td><td><span class="math inline">\(A_1,B_2\)</span></td></tr><tr class="odd"><td><span class="math inline">\(\text{path 4}\)</span></td><td><span class="math inline">\(A_1,B_1\)</span></td><td></td><td><span class="math inline">\(B_2\)</span></td><td><span class="math inline">\(B_1\)</span></td><td></td><td><span class="math inline">\(A_1,B_2\)</span></td></tr><tr class="even"><td><span class="math inline">\(\text{path 5}\)</span></td><td><span class="math inline">\(A_2,B_2\)</span></td><td></td><td><span class="math inline">\(A_2,B_2\)</span></td><td><span class="math inline">\(A_1,B_3\)</span></td><td></td><td><span class="math inline">\(A_1,B_3\)</span></td></tr><tr class="odd"><td><span class="math inline">\(\text{path 6}\)</span></td><td><span class="math inline">\(A_1,B_1,A_3,B_3\)</span></td><td><span class="math inline">\(A_2,B_2\)</span></td><td><span class="math inline">\(B_1,A_3\)</span></td><td><span class="math inline">\(A_2,B_2\)</span></td><td></td><td><span class="math inline">\(A_1,B_3\)</span></td></tr></tbody></table><p>可以发现改变量并不多。</p><p>那么我们用 <span class="math inline">\(5\)</span> 个可删堆，分别维护：<span class="math inline">\(A,B\)</span> 都在 <span class="math inline">\(P\)</span> 的和的最大值，<span class="math inline">\(A\)</span> 在 <span class="math inline">\(P\)</span> 的最大值，<span class="math inline">\(B\)</span> 在 <span class="math inline">\(P\)</span> 的最大值，<span class="math inline">\(A\)</span> 在 <span class="math inline">\(P\)</span> 且 <span class="math inline">\(B\)</span> 在 <span class="math inline">\(Q\)</span> 的最大的 <span class="math inline">\(A\)</span> 的权值，<span class="math inline">\(A\)</span> 在 <span class="math inline">\(Q\)</span> 且 <span class="math inline">\(B\)</span> 在 <span class="math inline">\(P\)</span> 的最大的 <span class="math inline">\(B\)</span> 的权值。并同时维护 <span class="math inline">\(A,B\)</span> 都在 <span class="math inline">\(Q\)</span>，<span class="math inline">\(A,B\)</span> 都在 <span class="math inline">\(O\)</span> 的对数，就可以通过这五个可删堆的拼凑，得到上述五条路径的最大值，修改的时候由于修改量很少，暴力更新可删堆即可。</p><p>总复杂度 <span class="math inline">\(O(\sum n\log \max\{n\})\)</span>。</p><p>贴个代码</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> debug(...) fprintf(stderr, __VA_ARGS__)</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> RI register int</span></span><br><span class="line"><span class="keyword">typedef</span> <span class="keyword">long</span> <span class="keyword">long</span> LL;</span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> FILEIO(name) freopen(name<span class="meta-string">&quot;.in&quot;</span>, <span class="meta-string">&quot;r&quot;</span>, stdin), freopen(name<span class="meta-string">&quot;.out&quot;</span>, <span class="meta-string">&quot;w&quot;</span>, stdout);</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">namespace</span> IO &#123;</span><br><span class="line">  <span class="keyword">char</span> buf[<span class="number">1000000</span>], *p1 = buf, *p2 = buf;</span><br><span class="line">  <span class="function"><span class="keyword">inline</span> <span class="keyword">char</span> <span class="title">gc</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (p1 == p2) p2 = (p1 = buf) + fread(buf, <span class="number">1</span>, <span class="number">1000000</span>, <span class="built_in">stdin</span>);</span><br><span class="line">    <span class="keyword">return</span> p1 == p2 ? EOF : *(p1++);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">template</span> &lt;<span class="class"><span class="keyword">class</span> <span class="title">T</span>&gt; <span class="title">inline</span> <span class="title">void</span> <span class="title">read</span>(<span class="title">T</span> &amp;<span class="title">n</span>) &#123;</span></span><br><span class="line">    n = <span class="number">0</span>; RI ch = gc(), f;</span><br><span class="line">    <span class="keyword">while</span> ((ch &lt; <span class="string">&#x27;0&#x27;</span> || ch &gt; <span class="string">&#x27;9&#x27;</span>) &amp;&amp; ch != <span class="string">&#x27;-&#x27;</span>) ch = gc();</span><br><span class="line">    f = (ch == <span class="string">&#x27;-&#x27;</span> ? ch = gc(), <span class="number">-1</span> : <span class="number">1</span>);</span><br><span class="line">    <span class="keyword">while</span> (ch &gt;= <span class="string">&#x27;0&#x27;</span> &amp;&amp; ch &lt;= <span class="string">&#x27;9&#x27;</span>) n = n * <span class="number">10</span> + (ch ^ <span class="number">48</span>), ch = gc();</span><br><span class="line">    n *= f;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">char</span> Of[<span class="number">105</span>], *O1 = Of, *O2 = Of;</span><br><span class="line">  <span class="keyword">template</span> &lt;<span class="class"><span class="keyword">class</span> <span class="title">T</span>&gt; <span class="title">inline</span> <span class="title">void</span> <span class="title">print</span>(<span class="title">T</span> <span class="title">n</span>, <span class="title">char</span> <span class="title">ch</span> = &#x27;\<span class="title">n</span>&#x27;) &#123;</span></span><br><span class="line">    <span class="keyword">if</span> (n &lt; <span class="number">0</span>) <span class="built_in">putchar</span>(<span class="string">&#x27;-&#x27;</span>), n = -n;</span><br><span class="line">    <span class="keyword">if</span> (n == <span class="number">0</span>) <span class="built_in">putchar</span>(<span class="string">&#x27;0&#x27;</span>);</span><br><span class="line">    <span class="keyword">while</span> (n) *(O1++) = (n % <span class="number">10</span>) ^ <span class="number">48</span>, n /= <span class="number">10</span>;</span><br><span class="line">    <span class="keyword">while</span> (O1 != O2) <span class="built_in">putchar</span>(*(--O1));</span><br><span class="line">    <span class="built_in">putchar</span>(ch);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">using</span> IO :: read;</span><br><span class="line"><span class="keyword">using</span> IO :: print;</span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> <span class="keyword">const</span> MAXN = <span class="number">2e5</span> + <span class="number">5</span>;</span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">Node</span> &#123;</span></span><br><span class="line">  <span class="keyword">int</span> v, id;</span><br><span class="line">  <span class="keyword">bool</span> <span class="keyword">operator</span> &lt; (<span class="keyword">const</span> Node &amp;A) <span class="keyword">const</span> &#123;</span><br><span class="line">    <span class="keyword">return</span> v ^ A.v ? v &lt; A.v : id &lt; A.id;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">bool</span> <span class="keyword">operator</span> == (<span class="keyword">const</span> Node &amp;A) <span class="keyword">const</span> &#123;</span><br><span class="line">    <span class="keyword">return</span> v == A.v &amp;&amp; id == A.id;</span><br><span class="line">  &#125;</span><br><span class="line">&#125; a[MAXN], b[MAXN];</span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">ErasableHeap</span> &#123;</span></span><br><span class="line">  <span class="built_in">priority_queue</span> &lt;Node&gt; I, O;</span><br><span class="line">  <span class="function"><span class="keyword">inline</span> <span class="keyword">void</span> <span class="title">flush</span><span class="params">()</span> </span>&#123; <span class="keyword">while</span> (!O.empty() &amp;&amp; I.top() == O.top()) I.pop(), O.pop(); &#125;</span><br><span class="line">  <span class="function"><span class="keyword">inline</span> <span class="keyword">void</span> <span class="title">clear</span><span class="params">()</span> </span>&#123; <span class="keyword">while</span> (!I.empty()) I.pop();    <span class="keyword">while</span> (!O.empty()) O.pop(); &#125;</span><br><span class="line">  <span class="function"><span class="keyword">inline</span> <span class="keyword">void</span> <span class="title">insert</span><span class="params">(Node x)</span> </span>&#123; I.push(x); &#125;</span><br><span class="line">  <span class="function"><span class="keyword">inline</span> <span class="keyword">void</span> <span class="title">erase</span><span class="params">(Node x)</span>  </span>&#123; O.push(x); &#125;</span><br><span class="line">  <span class="function"><span class="keyword">inline</span> <span class="keyword">bool</span> <span class="title">empty</span><span class="params">()</span> </span>&#123; flush(); <span class="keyword">return</span> I.empty(); &#125;</span><br><span class="line">  <span class="function"><span class="keyword">inline</span> Node <span class="title">top</span><span class="params">()</span>   </span>&#123; flush(); <span class="keyword">return</span> I.top();   &#125;</span><br><span class="line">&#125; q1, q2, q3, q4, q5;</span><br><span class="line"><span class="comment">// Max AB in P; Max A in P; Max B in P; Max A in P and B in Q; Max A in Q and B in P;</span></span><br><span class="line"><span class="keyword">int</span> visa[MAXN], visb[MAXN];</span><br><span class="line"><span class="keyword">int</span> stkQ[MAXN], stkO[MAXN];</span><br><span class="line"><span class="comment">// 0 : in P; 1 : in Q; 2 : in O</span></span><br><span class="line"><span class="keyword">int</span> cntO, cntQ;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">DeleteAll</span><span class="params">(<span class="keyword">int</span> x)</span> </span>&#123;</span><br><span class="line">  <span class="keyword">if</span> (visa[x] == <span class="number">0</span> &amp;&amp; visb[x] == <span class="number">0</span>) q1.erase((Node)&#123;a[x].v + b[x].v, x&#125;);</span><br><span class="line">  <span class="keyword">if</span> (visa[x] == <span class="number">0</span>)                 q2.erase(a[x]);</span><br><span class="line">  <span class="keyword">if</span> (visb[x] == <span class="number">0</span>)                 q3.erase(b[x]);</span><br><span class="line">  <span class="keyword">if</span> (visa[x] == <span class="number">0</span> &amp;&amp; visb[x] == <span class="number">1</span>) q4.erase(a[x]);</span><br><span class="line">  <span class="keyword">if</span> (visa[x] == <span class="number">1</span> &amp;&amp; visb[x] == <span class="number">0</span>) q5.erase(b[x]);</span><br><span class="line">  <span class="keyword">if</span> (visa[x] == <span class="number">1</span> &amp;&amp; visb[x] == <span class="number">1</span>) --cntQ;</span><br><span class="line">  <span class="keyword">if</span> (visa[x] == <span class="number">2</span> &amp;&amp; visb[x] == <span class="number">2</span>) --cntO;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">InsertAll</span><span class="params">(<span class="keyword">int</span> x)</span> </span>&#123;</span><br><span class="line">  <span class="keyword">if</span> (visa[x] == <span class="number">0</span> &amp;&amp; visb[x] == <span class="number">0</span>) q1.insert((Node)&#123;a[x].v + b[x].v, x&#125;);</span><br><span class="line">  <span class="keyword">if</span> (visa[x] == <span class="number">0</span>)                 q2.insert(a[x]);</span><br><span class="line">  <span class="keyword">if</span> (visb[x] == <span class="number">0</span>)                 q3.insert(b[x]);</span><br><span class="line">  <span class="keyword">if</span> (visa[x] == <span class="number">0</span> &amp;&amp; visb[x] == <span class="number">1</span>) q4.insert(a[x]);</span><br><span class="line">  <span class="keyword">if</span> (visa[x] == <span class="number">1</span> &amp;&amp; visb[x] == <span class="number">0</span>) q5.insert(b[x]);</span><br><span class="line">  <span class="keyword">if</span> (visa[x] == <span class="number">1</span> &amp;&amp; visb[x] == <span class="number">1</span>) stkQ[++cntQ] = x;</span><br><span class="line">  <span class="keyword">if</span> (visa[x] == <span class="number">2</span> &amp;&amp; visb[x] == <span class="number">2</span>) stkO[++cntO] = x;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">PushInQ</span><span class="params">(<span class="keyword">int</span> *vis, <span class="keyword">int</span> x)</span> </span>&#123;</span><br><span class="line">  DeleteAll(x);</span><br><span class="line">  vis[x] = <span class="number">1</span>;</span><br><span class="line">  InsertAll(x);</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">PushInO</span><span class="params">(<span class="keyword">int</span> x)</span> </span>&#123;</span><br><span class="line">  DeleteAll(x);</span><br><span class="line">  visa[x] = visb[x] = <span class="number">2</span>;</span><br><span class="line">  InsertAll(x);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">int</span> T; read(T);</span><br><span class="line">  <span class="keyword">while</span> (T--) &#123;</span><br><span class="line">    <span class="keyword">int</span> n, K, L; read(n), read(K), read(L);</span><br><span class="line">    <span class="keyword">int</span> res = K - L;</span><br><span class="line">    <span class="keyword">for</span> (RI i = <span class="number">1</span>; i &lt;= n; ++i)</span><br><span class="line">      read(a[i].v), a[i].id = i;</span><br><span class="line">    <span class="keyword">for</span> (RI i = <span class="number">1</span>; i &lt;= n; ++i)</span><br><span class="line">      read(b[i].v), b[i].id = i;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> (RI i = <span class="number">1</span>; i &lt;= n; ++i)</span><br><span class="line">      visa[i] = visb[i] = <span class="number">0</span>;</span><br><span class="line">    cntO = <span class="number">0</span>, cntQ = <span class="number">0</span>;</span><br><span class="line">    q1.clear(); q2.clear(); q3.clear(); q4.clear(); q5.clear();</span><br><span class="line"></span><br><span class="line">    sort(a + <span class="number">1</span>, a + <span class="number">1</span> + n, [](Node x, Node y)&#123; <span class="keyword">return</span> x.v &gt; y.v; &#125;);</span><br><span class="line">    sort(b + <span class="number">1</span>, b + <span class="number">1</span> + n, [](Node x, Node y)&#123; <span class="keyword">return</span> x.v &gt; y.v; &#125;);  </span><br><span class="line">    LL ans = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span> (RI i = <span class="number">1</span>; i &lt;= res; ++i) &#123;</span><br><span class="line">      ans += a[i].v, visa[a[i].id] = <span class="number">1</span>;</span><br><span class="line">      ans += b[i].v, visb[b[i].id] = <span class="number">1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    sort(a + <span class="number">1</span>, a + <span class="number">1</span> + n, [](Node x, Node y)&#123; <span class="keyword">return</span> x.id &lt; y.id; &#125;);</span><br><span class="line">    sort(b + <span class="number">1</span>, b + <span class="number">1</span> + n, [](Node x, Node y)&#123; <span class="keyword">return</span> x.id &lt; y.id; &#125;);</span><br><span class="line">    <span class="keyword">for</span> (RI i = <span class="number">1</span>; i &lt;= n; ++i) InsertAll(i);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">int</span> tmp = L;</span><br><span class="line">    <span class="keyword">while</span> (L--) &#123;</span><br><span class="line">      LL val1 = q1.top().v;</span><br><span class="line">      LL val2 = !q2.empty() &amp;&amp; !q5.empty() ? q2.top().v + q5.top().v : <span class="number">-0x7f7f7f7f7f7f7f7f</span>;</span><br><span class="line">      LL val3 = !q3.empty() &amp;&amp; !q4.empty() ? q3.top().v + q4.top().v : <span class="number">-0x7f7f7f7f7f7f7f7f</span>;</span><br><span class="line">      LL val4 = cntQ &amp;&amp; !q2.empty() &amp;&amp; !q3.empty() ? q2.top().v + q3.top().v : <span class="number">-0x7f7f7f7f7f7f7f7f</span>;</span><br><span class="line">      LL val5 = cntO &amp;&amp; !q4.empty() &amp;&amp; !q5.empty() ? q4.top().v + q5.top().v : <span class="number">-0x7f7f7f7f7f7f7f7f</span>;</span><br><span class="line">      <span class="keyword">if</span> (val1 &gt; val2 &amp;&amp; val1 &gt; val3 &amp;&amp; val1 &gt; val4 &amp;&amp; val1 &gt; val5) &#123;</span><br><span class="line">        ans += val1;</span><br><span class="line">        PushInO(q1.top().id);</span><br><span class="line">      &#125;</span><br><span class="line">      <span class="keyword">else</span> <span class="keyword">if</span> (val2 &gt; val3 &amp;&amp; val2 &gt; val4 &amp;&amp; val2 &gt; val5) &#123;</span><br><span class="line">        ans += val2;</span><br><span class="line">        <span class="keyword">int</span> tmp = q5.top().id;</span><br><span class="line">        PushInQ(visa, q2.top().id);</span><br><span class="line">        PushInO(tmp);</span><br><span class="line">      &#125;</span><br><span class="line">      <span class="keyword">else</span> <span class="keyword">if</span> (val3 &gt; val4 &amp;&amp; val3 &gt; val5) &#123;</span><br><span class="line">        ans += val3;</span><br><span class="line">        <span class="keyword">int</span> tmp = q4.top().id;</span><br><span class="line">        PushInQ(visb, q3.top().id);</span><br><span class="line">        PushInO(tmp);</span><br><span class="line">      &#125;</span><br><span class="line">      <span class="keyword">else</span> <span class="keyword">if</span> (val4 &gt; val5) &#123;</span><br><span class="line">        ans += val4;</span><br><span class="line">        <span class="keyword">int</span> t1 = q2.top().id, t2 = q3.top().id;</span><br><span class="line">        PushInO(stkQ[cntQ]);</span><br><span class="line">        PushInQ(visa, t1);</span><br><span class="line">        PushInQ(visb, t2);</span><br><span class="line">      &#125;</span><br><span class="line">      <span class="keyword">else</span> &#123;</span><br><span class="line">        ans += val5;</span><br><span class="line">        <span class="keyword">int</span> t1 = q4.top().id, t2 = q5.top().id, t3 = stkO[cntO];</span><br><span class="line">        PushInQ(visa, t3), PushInQ(visb, t3);</span><br><span class="line">        PushInO(t1);</span><br><span class="line">        PushInO(t2);</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    print(ans);</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">S -&gt; A -&gt; B -&gt; T</span></span><br><span class="line"><span class="comment">S -&gt; A -&gt; L -&gt; R -&gt; B -&gt; T</span></span><br><span class="line"><span class="comment">S -&gt; A1 -&gt; L -&gt; A2 -&gt; B2 -&gt; T</span></span><br><span class="line"><span class="comment">S -&gt; A1 -&gt; B1 -&gt; R -&gt; B2 -&gt; T</span></span><br><span class="line"><span class="comment">S -&gt; A1 -&gt; L -&gt; A2 -&gt; B2 -&gt; R -&gt; B3 -&gt; T</span></span><br><span class="line"><span class="comment">S -&gt; A1 -&gt; B1 -&gt; R -&gt; B2 -&gt; A2 -&gt; L -&gt; A3 -&gt; B3 -&gt; T</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">First, use all of the path 2</span></span><br><span class="line"><span class="comment">Then, expand rest times</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">Let P is a set of the nodes not be chosen, Q is a set of the nodes be chosen into LR, Otherwise is O.</span></span><br><span class="line"><span class="comment">path 1 : A, B   in P                            O : A, B   insert</span></span><br><span class="line"><span class="comment">path 3 : A1, B2 in P; A2     in Q               O : A2, B2 insert                         Q : A2 delete,     A1     insert</span></span><br><span class="line"><span class="comment">path 4 : A1, B2 in P; B1     in Q               O : A1, B1 insert                         Q : B1 delete,     B2     insert</span></span><br><span class="line"><span class="comment">path 5 : A1, B3 in P; A2, B2 in Q               O : A2, B2 insert                         Q : A2, B2 delete, A1, B3 insert</span></span><br><span class="line"><span class="comment">path 6 : A1, B3 in P; B1, A3 in Q; A2, B2 in O  O : A2, B2 delete, A1, B1, A3, B3 insert  Q : B1, A3 delete, A2, B2 insert</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"></span><br><span class="line">  <span class="built_in">cerr</span> &lt;&lt; (<span class="keyword">double</span>)(clock()) / CLOCKS_PER_SEC &lt;&lt; <span class="string">&quot; ms &quot;</span> &lt;&lt; <span class="built_in">endl</span>;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// created by Daniel yuan</span></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">     ________</span></span><br><span class="line"><span class="comment">    /        \</span></span><br><span class="line"><span class="comment">   / /      \ \</span></span><br><span class="line"><span class="comment">  / /        \ \</span></span><br><span class="line"><span class="comment">  \            /</span></span><br><span class="line"><span class="comment">   \  ______  /</span></span><br><span class="line"><span class="comment">    \________/</span></span><br><span class="line"><span class="comment">*/</span></span><br></pre></td></tr></table></figure><p>最后再来个总结：</p><p>模拟费用流究其根本是先建图，然后再分析图进行贪心模拟。</p><link rel="stylesheet" href="/css/spoiler.css" type="text/css"><script src="/js/spoiler.js" type="text/javascript" async></script>]]></content>
    
    
    <summary type="html">&lt;p&gt;简单学习了模拟费用流之后一直有点迷糊，后来在交流中似乎悟到了些什么。&lt;/p&gt;
&lt;p&gt;能推出这道题挺开心的，而且对模拟费用流有了更进一步的理解。&lt;/p&gt;</summary>
    
    
    
    
    <category term="网络流" scheme="http://example.com/tags/%E7%BD%91%E7%BB%9C%E6%B5%81/"/>
    
    <category term="费用流" scheme="http://example.com/tags/%E8%B4%B9%E7%94%A8%E6%B5%81/"/>
    
    <category term="模拟费用流" scheme="http://example.com/tags/%E6%A8%A1%E6%8B%9F%E8%B4%B9%E7%94%A8%E6%B5%81/"/>
    
  </entry>
  
  <entry>
    <title>DP of DP</title>
    <link href="http://example.com/2021/01/21/DP-of-DP/"/>
    <id>http://example.com/2021/01/21/DP-of-DP/</id>
    <published>2021-01-21T11:53:34.000Z</published>
    <updated>2021-01-21T12:37:37.879Z</updated>
    
    <content type="html"><![CDATA[<p>做过不少 DP of DP 题，但是考试还是想不到，很气，写个总结记录下。</p><a id="more"></a><p>对于一个题目，如果它要求的是在某个限制下计数，并且在看一个状态有没有满足限制的时候也需要 DP，这时候往往就要用到 DP of DP。</p><p>一般的流程是这样的，我们先考虑对于一个已知状态，怎么判定其是否满足性质。这时候我们一般都会有一个 DP，且这个 DP 是用增量法填表的，即类似于 <span class="math inline">\(f_{i,...}\)</span> 表示前 <span class="math inline">\(i\)</span> 个位置（或其它）怎么怎么样。然后因为我们的根本需求是计数，而计数我们也用到增量法，所以可以把 <span class="math inline">\(f_{i,...}\)</span> 的 <span class="math inline">\(i\)</span> 放到外层 DP 处，然后把剩下的 <span class="math inline">\(f_{...}\)</span> 给排成一列压缩起来，变成一个状态。这样在外层我们就得到了 <span class="math inline">\(F_{i,S}\)</span>，表示考虑前 <span class="math inline">\(i\)</span> 个位置（或其它），内层 DP 的状态是 <span class="math inline">\(S\)</span> 的方案数。在转移 <span class="math inline">\(i+1\)</span> 的时候，我们把 <span class="math inline">\(S\)</span> 还原成内层 DP 数组 <span class="math inline">\(f_{...}\)</span>，然后对 <span class="math inline">\(f_{...}\)</span> 和 <span class="math inline">\(i+1\)</span> 跑内层 DP 得到一个新状态<span class="math inline">\(f^{&#39;}_{...}\)</span> 并重新压缩成 <span class="math inline">\(T\)</span>，这样就可以从 <span class="math inline">\(F_{i,S}\)</span> 转移到 <span class="math inline">\(F_{i+1,T}\)</span>。</p><p>考虑看一道例题：</p><blockquote><p>给一个小写字母字符串 <span class="math inline">\(S\)</span>，<span class="math inline">\(|S|\leq15\)</span>，问有多少个长度为 <span class="math inline">\(n\)</span>，<span class="math inline">\((n\leq 100)\)</span> 的小写字母字符串 <span class="math inline">\(T\)</span>，使得 <span class="math inline">\(S\)</span> 和 <span class="math inline">\(T\)</span> 的最长上升子序列的长度为 <span class="math inline">\(k\)</span>。对于 <span class="math inline">\(k=0,1,2...|S|\)</span> 都要求答案。</p></blockquote><p>经典题，按照上面的流程来做。</p><p>首先对于一个已知字符串 <span class="math inline">\(T\)</span>，考虑求它的最长上升子序列。设 <span class="math inline">\(f_{i,j}\)</span> 表示考虑 <span class="math inline">\(T\)</span> 的前 <span class="math inline">\(i\)</span> 个字符，<span class="math inline">\(S\)</span> 的前 <span class="math inline">\(j\)</span> 个字符的最长上升子序列最长是多少。这个 DP 符合增量法，所以把 <span class="math inline">\(f_{1,2...j}\)</span> 压缩成一个状态 <span class="math inline">\(S\)</span>。在外层，设 <span class="math inline">\(F_{i,S}\)</span> 表示考虑 <span class="math inline">\(T\)</span> 的前 <span class="math inline">\(i\)</span> 个字符，<span class="math inline">\(f_{i,\{0,1...|S|\}}\)</span> 算出来的值状压起来为 <span class="math inline">\(S\)</span> 的方案数。转移的时候，枚举下一个字符填什么，然后把 <span class="math inline">\(S\)</span> 还原成 <span class="math inline">\(f\)</span>，然后计算出新的 <span class="math inline">\(f&#39;\)</span>，再状压回 <span class="math inline">\(T\)</span>，就可以从 <span class="math inline">\(F_{i,S}\)</span> 转移到 <span class="math inline">\(F_{i+1,T}\)</span> 了。</p><p>这样我们就完成了普通的 DP of DP，但是这样复杂度有问题，因为 <span class="math inline">\(f\)</span> 的取值范围是 <span class="math inline">\([0,15]\)</span> 压起来特别大，但是我们发现 <span class="math inline">\(f_i-f_{i-1}\in[0,1]\)</span>，所以可以把 <span class="math inline">\(f_i-f_{i-1}\)</span> 压起来，这样 <span class="math inline">\(F_{i,S}\)</span> 的 <span class="math inline">\(S\)</span> 的取值只有 <span class="math inline">\(2^{15}\)</span> 了。</p><p>代码如下，这里只实现了字符集为 <span class="math inline">\(\{N,O,I\}\)</span> 。原题是 <a href="https://www.luogu.com.cn/problem/P4590">[TJOI2018] 游园会</a>。</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> debug(...) fprintf(stderr, __VA_ARGS__)</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> RI register int</span></span><br><span class="line"><span class="keyword">typedef</span> <span class="keyword">long</span> <span class="keyword">long</span> LL;</span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> FILEIO(name) freopen(name<span class="meta-string">&quot;.in&quot;</span>, <span class="meta-string">&quot;r&quot;</span>, stdin), freopen(name<span class="meta-string">&quot;.out&quot;</span>, <span class="meta-string">&quot;w&quot;</span>, stdout);</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> <span class="keyword">const</span> mod = <span class="number">1e9</span> + <span class="number">7</span>;</span><br><span class="line"><span class="keyword">char</span> s[<span class="number">20</span>];</span><br><span class="line"><span class="keyword">int</span> f[<span class="number">20</span>], g[<span class="number">20</span>];</span><br><span class="line"><span class="keyword">int</span> Trans[<span class="number">1</span> &lt;&lt; <span class="number">15</span>][<span class="number">3</span>];</span><br><span class="line"><span class="keyword">int</span> dp[<span class="number">2</span>][<span class="number">3</span>][<span class="number">1</span> &lt;&lt; <span class="number">15</span>];</span><br><span class="line"><span class="keyword">int</span> bitcnt[<span class="number">1</span> &lt;&lt; <span class="number">15</span>];</span><br><span class="line"><span class="keyword">int</span> Ans[<span class="number">20</span>];</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">void</span> <span class="title">Add</span><span class="params">(<span class="keyword">int</span> &amp;x, <span class="keyword">int</span> y)</span> </span>&#123; x += y - mod, x += (x &gt;&gt; <span class="number">31</span>) &amp; mod; &#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">  </span><br><span class="line"><span class="meta">#<span class="meta-keyword">ifdef</span> LOCAL</span></span><br><span class="line">  FILEIO(<span class="string">&quot;a&quot;</span>);</span><br><span class="line"><span class="meta">#<span class="meta-keyword">endif</span></span></span><br><span class="line"></span><br><span class="line">  <span class="keyword">int</span> n, k; <span class="built_in">scanf</span>(<span class="string">&quot;%d %d&quot;</span>, &amp;n, &amp;k);</span><br><span class="line">  <span class="built_in">scanf</span>(<span class="string">&quot;%s&quot;</span>, s + <span class="number">1</span>);</span><br><span class="line">  <span class="keyword">for</span> (RI S = <span class="number">0</span>, NS; S &lt; (<span class="number">1</span> &lt;&lt; k); ++S) &#123;</span><br><span class="line">    <span class="keyword">for</span> (RI i = <span class="number">1</span>; i &lt;= k; ++i)</span><br><span class="line">      f[i] = f[i - <span class="number">1</span>] + ((S &gt;&gt; (i - <span class="number">1</span>)) &amp; <span class="number">1</span>);</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">for</span> (RI i = <span class="number">1</span>; i &lt;= k; ++i)</span><br><span class="line">      g[i] = max(g[i - <span class="number">1</span>], max(f[i], f[i - <span class="number">1</span>] + (s[i] == <span class="string">&#x27;N&#x27;</span>)));</span><br><span class="line">    NS = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span> (RI i = <span class="number">1</span>; i &lt;= k; ++i)</span><br><span class="line">      NS |= (g[i] - g[i - <span class="number">1</span>]) &lt;&lt; (i - <span class="number">1</span>);</span><br><span class="line">    Trans[S][<span class="number">0</span>] = NS;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> (RI i = <span class="number">1</span>; i &lt;= k; ++i)</span><br><span class="line">      g[i] = max(g[i - <span class="number">1</span>], max(f[i], f[i - <span class="number">1</span>] + (s[i] == <span class="string">&#x27;O&#x27;</span>)));</span><br><span class="line">    NS = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span> (RI i = <span class="number">1</span>; i &lt;= k; ++i)</span><br><span class="line">      NS |= (g[i] - g[i - <span class="number">1</span>]) &lt;&lt; (i - <span class="number">1</span>);</span><br><span class="line">    Trans[S][<span class="number">1</span>] = NS;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> (RI i = <span class="number">1</span>; i &lt;= k; ++i)</span><br><span class="line">      g[i] = max(g[i - <span class="number">1</span>], max(f[i], f[i - <span class="number">1</span>] + (s[i] == <span class="string">&#x27;I&#x27;</span>)));</span><br><span class="line">    NS = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span> (RI i = <span class="number">1</span>; i &lt;= k; ++i)</span><br><span class="line">      NS |= (g[i] - g[i - <span class="number">1</span>]) &lt;&lt; (i - <span class="number">1</span>);</span><br><span class="line">    Trans[S][<span class="number">2</span>] = NS;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">int</span> cur = <span class="number">1</span>, nxt = <span class="number">0</span>;</span><br><span class="line">  dp[<span class="number">0</span>][<span class="number">0</span>][<span class="number">0</span>] = <span class="number">1</span>;</span><br><span class="line">  <span class="keyword">for</span> (RI i = <span class="number">0</span>; i &lt; n; ++i) &#123;</span><br><span class="line">    swap(cur, nxt);</span><br><span class="line">    <span class="built_in">memset</span>(dp[nxt], <span class="number">0</span>, <span class="keyword">sizeof</span>(dp[nxt]));</span><br><span class="line">    <span class="keyword">for</span> (RI S = <span class="number">0</span>; S &lt; (<span class="number">1</span> &lt;&lt; k); ++S) &#123;</span><br><span class="line">      Add(dp[nxt][<span class="number">1</span>][Trans[S][<span class="number">0</span>]], dp[cur][<span class="number">0</span>][S]);</span><br><span class="line">      Add(dp[nxt][<span class="number">1</span>][Trans[S][<span class="number">0</span>]], dp[cur][<span class="number">1</span>][S]);</span><br><span class="line">      Add(dp[nxt][<span class="number">1</span>][Trans[S][<span class="number">0</span>]], dp[cur][<span class="number">2</span>][S]);</span><br><span class="line">      Add(dp[nxt][<span class="number">0</span>][Trans[S][<span class="number">1</span>]], dp[cur][<span class="number">0</span>][S]);</span><br><span class="line">      Add(dp[nxt][<span class="number">2</span>][Trans[S][<span class="number">1</span>]], dp[cur][<span class="number">1</span>][S]);</span><br><span class="line">      Add(dp[nxt][<span class="number">0</span>][Trans[S][<span class="number">1</span>]], dp[cur][<span class="number">2</span>][S]);</span><br><span class="line">      Add(dp[nxt][<span class="number">0</span>][Trans[S][<span class="number">2</span>]], dp[cur][<span class="number">0</span>][S]);</span><br><span class="line">      Add(dp[nxt][<span class="number">0</span>][Trans[S][<span class="number">2</span>]], dp[cur][<span class="number">1</span>][S]);</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">for</span> (RI S = <span class="number">1</span>; S &lt; (<span class="number">1</span> &lt;&lt; k); ++S)</span><br><span class="line">    bitcnt[S] = bitcnt[S ^ (S &amp; (-S))] + <span class="number">1</span>;</span><br><span class="line">  <span class="keyword">for</span> (RI i = <span class="number">0</span>; i &lt; <span class="number">3</span>; ++i)</span><br><span class="line">    <span class="keyword">for</span> (RI S = <span class="number">0</span>; S &lt; (<span class="number">1</span> &lt;&lt; k); ++S)</span><br><span class="line">      Add(Ans[bitcnt[S]], dp[nxt][i][S]);</span><br><span class="line">  <span class="keyword">for</span> (RI i = <span class="number">0</span>; i &lt;= k; ++i)</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;%d\n&quot;</span>, Ans[i]);</span><br><span class="line"></span><br><span class="line">  <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// created by Daniel yuan</span></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">     ________</span></span><br><span class="line"><span class="comment">    /        \</span></span><br><span class="line"><span class="comment">   / /      \ \</span></span><br><span class="line"><span class="comment">  / /        \ \</span></span><br><span class="line"><span class="comment">  \            /</span></span><br><span class="line"><span class="comment">   \  ______  /</span></span><br><span class="line"><span class="comment">    \________/</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"></span><br></pre></td></tr></table></figure><p>但是我们肯定不仅仅满足这个普通的 DP of DP，我们需要更便捷的东西——自动机。</p><p>也就是说我们干脆就直接把 <span class="math inline">\(S\)</span> 看成是一个状态的集合，然后把所有的状态的集合建出一个转移的自动机。一个自动机上面的节点代表着一个状态，而转移边就代表着这个状态加入一个东西后可以转移到哪里。这样我们的 DP 就变成了一个普通的自动机上 DP。</p><p>典型例子是 <a href="https://www.luogu.com.cn/problem/P5279">[ZJOI2019] 麻将</a>，可以结合<a href="https://daniel-yuan.github.io/2021/01/19/%E9%BA%BB%E5%B0%86%E7%9B%B8%E5%85%B3/#more">我的这篇博客</a>把这个题切了。</p><p><del>（不知为何写着写着就变成一个普及 DP of DP 的博客了……）</del></p><link rel="stylesheet" href="/css/spoiler.css" type="text/css"><script src="/js/spoiler.js" type="text/javascript" async></script>]]></content>
    
    
    <summary type="html">&lt;p&gt;做过不少 DP of DP 题，但是考试还是想不到，很气，写个总结记录下。&lt;/p&gt;</summary>
    
    
    
    
    <category term="DP" scheme="http://example.com/tags/DP/"/>
    
    <category term="DP of DP" scheme="http://example.com/tags/DP-of-DP/"/>
    
  </entry>
  
  <entry>
    <title>[ZJOI2019] 麻将 题解</title>
    <link href="http://example.com/2021/01/21/ZJOI2019-%E9%BA%BB%E5%B0%86-%E9%A2%98%E8%A7%A3/"/>
    <id>http://example.com/2021/01/21/ZJOI2019-%E9%BA%BB%E5%B0%86-%E9%A2%98%E8%A7%A3/</id>
    <published>2021-01-21T00:33:52.000Z</published>
    <updated>2021-01-21T01:13:52.612Z</updated>
    
    <content type="html"><![CDATA[<p>首先对于已有的一堆牌，我们应该要能确定它能不能胡。</p><p>这部分具体的可以参考<a href="https://daniel-yuan.github.io/2021/01/19/%E9%BA%BB%E5%B0%86%E7%9B%B8%E5%85%B3/#more">我的另一篇博客</a>，顺带说一句，[ZJOI2019] 麻将的前置知识居然被拿去 [GXOI/GZOI2019] 出了个宝牌一大堆<del>，ZJOI 恐怖如斯</del>。</p><a id="more"></a><p>回到这个题目，对于一个已知状态，我们可以设 <span class="math inline">\(f_{i,0/1/2,0/1/2,0/1}\)</span> 表示前 <span class="math inline">\(i\)</span> 张牌，<span class="math inline">\(i-1\)</span> 开始的顺子有 <span class="math inline">\(0/1/2\)</span> 个，<span class="math inline">\(i\)</span> 开始的顺子有 <span class="math inline">\(0/1/2\)</span> 个，有无雀头的最大面子数。</p><p>但是现在状态是未知的，所以考虑 DP of DP，即把这个 <span class="math inline">\(f\)</span> 压到状态里面去。为了方便，我们把 <span class="math inline">\(f_{0/1/2,0/1/2,0/1}\)</span> （注意到这里已经忽略了 <span class="math inline">\(i\)</span>，因为 <span class="math inline">\(i\)</span> 对转移没有影响）建一个自动机。而自动机上面的信息就是形如 <span class="math inline">\(f_{0,0,0}=x,f_{0,0,1}=y...\)</span> 这样的多元组，因为还有七对子的特殊牌型，所以在自动机上面额外记录一个 <span class="math inline">\(cnt\)</span> 表示对子数。</p><p>乍一看，一共有 <span class="math inline">\(3\times 3\times 2=18\)</span> 个 <span class="math inline">\(f\)</span> 状态，而 <span class="math inline">\(f\)</span> 的取值有 <span class="math inline">\(0/1/2/3/4\)</span> 五种（大于 <span class="math inline">\(4\)</span> 已经没有意义，故可以限制最大值为 <span class="math inline">\(4\)</span>），并且还有一个额外的 <span class="math inline">\(cnt\)</span> 需要记录，自动机上的节点数会达到 <span class="math inline">\(5^{18}\times 8=3.0517578125×10^{13}\)</span>，我们难以承受。但是显然有很多状态不会被涉及到，比如说 <span class="math inline">\(f_{0,0,0}=3\)</span> 的时候任何 <span class="math inline">\(f\)</span> 值都不会小于 <span class="math inline">\(3\)</span>。所以我们可以写一个 BFS 去看看自动机节点数有多少。特别的，如果 <span class="math inline">\(cnt=7\)</span> 或者 <span class="math inline">\(f_{0,0,0}=4\)</span>，那么已经胡牌，我们可以建立一个胡牌节点，与此同时，我们也可以把转移边记录下来，特别的，胡牌节点只有自环。代码形如这样。</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">map &lt;Status, int&gt; mp;</span><br><span class="line">void GetStatus() &#123;</span><br><span class="line">  Status t, nxt; &#x2F;&#x2F; 这是一个定义状态的结构体</span><br><span class="line">  int cnt &#x3D; 0;</span><br><span class="line">  q.push(t), mp[t] &#x3D; ++cnt;</span><br><span class="line">  while (t.cnt !&#x3D; -1) t.Trans(2); &#x2F;&#x2F; 这里是构造一个胡牌节点</span><br><span class="line">  mp[t] &#x3D; ++cnt;</span><br><span class="line">  for (RI i &#x3D; 0; i &lt;&#x3D; 4; ++i)</span><br><span class="line">    child[mp[t]][i] &#x3D; mp[t];</span><br><span class="line">  while (!q.empty()) &#123;</span><br><span class="line">    t &#x3D; q.front(); q.pop();</span><br><span class="line">    for (RI i &#x3D; 0; i &lt;&#x3D; 4; ++i) &#123;</span><br><span class="line">      nxt &#x3D; t, nxt.Trans(i); &#x2F;&#x2F; 更新 f</span><br><span class="line">      if (mp.find(nxt) &#x3D;&#x3D; mp.end())</span><br><span class="line">        q.push(nxt), mp[nxt] &#x3D; ++cnt; &#x2F;&#x2F; 新建节点</span><br><span class="line">      child[mp[t]][i] &#x3D; mp[nxt]; &#x2F;&#x2F; 记录转移边</span><br><span class="line">    &#125;</span><br><span class="line">    if (cnt &gt; 100000) break; &#x2F;&#x2F; protection</span><br><span class="line">  &#125;</span><br><span class="line">  length &#x3D; mp.size();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>至于 <span class="math inline">\(f\)</span> 具体怎么转移大家可以自己推一推。</p><p>然后你会发现搜出来只有 1566 个节点（我也不知道为什么和很多博客上写的都不同，我还怀疑了自己好久……），于是我们就可以根据这个来 DP 了（可以把节点看做是内部的 DP）。</p><p>设 <span class="math inline">\(g_{i,j,k}\)</span> 表示考虑前 <span class="math inline">\(i\)</span> 种牌，当前牌长度为 <span class="math inline">\(j\)</span>，在自动机上面的点 <span class="math inline">\(k\)</span> 的方案数。转移的时候枚举这一种牌有多少张即可，复杂度 <span class="math inline">\(O(n^2\times 1566)\)</span>。因为相同种类的牌是有编号区分的，所以转移的时候一定要乘组合数（被卡了好久）。</p><p>最后再考虑计算答案。对于一个至少 <span class="math inline">\(k\)</span> 次才能胡牌的状态，它对答案的贡献为 <span class="math inline">\(k\)</span>。因为是至少，不好直接求，考虑转化成至多。即改成对于一个至多 <span class="math inline">\(k-1\)</span> 次都不能胡牌的状态，它对答案的贡献为 <span class="math inline">\(k\)</span>。而这个状态在 <span class="math inline">\(1\sim k-1\)</span> 次都不能胡牌。所以我们可以把贡献拆分到 <span class="math inline">\(1\sim k-1\)</span> 上面去，每个部分的权值为 <span class="math inline">\(1\)</span>。（或者说 <span class="math inline">\(k=\sum_{i=1}^k1\)</span>？）。</p><p>那么最终答案就是 <span class="math inline">\(\frac{\sum_{i=14}^{4n}\sum_{j=1}^{len}g_{n,i,j}(4n-i)!(i-13)![\text{ $j$ 不是胡牌节点 }]}{(4n-13)!}+1\)</span>。代码如下。</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br></pre></td><td class="code"><pre><span class="line">#include &lt;bits&#x2F;stdc++.h&gt;</span><br><span class="line">#define debug(...) fprintf(stderr, __VA_ARGS__)</span><br><span class="line">#define RI register int</span><br><span class="line">typedef long long LL;</span><br><span class="line"></span><br><span class="line">#define FILEIO(name) freopen(name&quot;.in&quot;, &quot;r&quot;, stdin), freopen(name&quot;.out&quot;, &quot;w&quot;, stdout);</span><br><span class="line"></span><br><span class="line">using namespace std;</span><br><span class="line"></span><br><span class="line">struct Status &#123; &#x2F;&#x2F; 自动机中的状态</span><br><span class="line">  int f[3][3][2], cnt;</span><br><span class="line">  Status () &#123;</span><br><span class="line">    for (RI i &#x3D; 0; i &lt;&#x3D; 2; ++i)</span><br><span class="line">      for (RI j &#x3D; 0; j &lt;&#x3D; 2; ++j)</span><br><span class="line">        for (RI k &#x3D; 0; k &lt;&#x3D; 1; ++k)</span><br><span class="line">          f[i][j][k] &#x3D; -0x3f3f3f3f;</span><br><span class="line">    cnt &#x3D; f[0][0][0] &#x3D; 0;</span><br><span class="line">  &#125;</span><br><span class="line">  void Trans(int res) &#123; &#x2F;&#x2F; 自动机状态的内部转移</span><br><span class="line">    Status nxt;</span><br><span class="line">    int win &#x3D; 0;</span><br><span class="line">    nxt.cnt &#x3D; cnt + (res &gt;&#x3D; 2);</span><br><span class="line">    win |&#x3D; (nxt.cnt &gt;&#x3D; 7);</span><br><span class="line">    for (RI i &#x3D; 0; i &lt;&#x3D; 2; ++i)</span><br><span class="line">      for (RI j &#x3D; 0; j &lt;&#x3D; 2; ++j)</span><br><span class="line">        for (RI k &#x3D; 0; k &lt;&#x3D; 1; ++k) &#123;</span><br><span class="line">          for (RI lasi &#x3D; 0; lasi &lt;&#x3D; 2; ++lasi)</span><br><span class="line">            for (RI lask &#x3D; 0; lask &lt;&#x3D; k; ++lask) &#123;</span><br><span class="line">              int ned &#x3D; lasi + i + j + 2 * (k - lask);</span><br><span class="line">              if (ned &gt; res) continue;</span><br><span class="line">              nxt.f[i][j][k] &#x3D; min(4, max(nxt.f[i][j][k], f[lasi][i][lask] + j + (res - ned &gt;&#x3D; 3)));</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    for (RI i &#x3D; 0; i &lt;&#x3D; 2; ++i)</span><br><span class="line">      for (RI j &#x3D; 0; j &lt;&#x3D; 2; ++j)</span><br><span class="line">        for (RI k &#x3D; 0; k &lt;&#x3D; 1; ++k)</span><br><span class="line">          if (nxt.f[i][j][k] &lt; 0)</span><br><span class="line">            nxt.f[i][j][k] &#x3D; -0x3f3f3f3f;</span><br><span class="line">    win |&#x3D; (nxt.f[0][0][1] &gt;&#x3D; 4);</span><br><span class="line">    if (win) &#x2F;&#x2F; 判胡牌</span><br><span class="line">      for (RI i &#x3D; 0; i &lt;&#x3D; 2; ++i)</span><br><span class="line">        for (RI j &#x3D; 0; j &lt;&#x3D; 2; ++j)</span><br><span class="line">          for (RI k &#x3D; 0; k &lt;&#x3D; 1; ++k)</span><br><span class="line">            nxt.f[i][j][k] &#x3D; nxt.cnt &#x3D; -1;</span><br><span class="line">    *this &#x3D; nxt;</span><br><span class="line">  &#125;</span><br><span class="line">  bool operator &lt; (const Status &amp;A) const &#123;</span><br><span class="line">    if (cnt !&#x3D; A.cnt) return cnt &lt; A.cnt;</span><br><span class="line">    for (RI i &#x3D; 0; i &lt;&#x3D; 2; ++i)</span><br><span class="line">      for (RI j &#x3D; 0; j &lt;&#x3D; 2; ++j)</span><br><span class="line">        for (RI k &#x3D; 0; k &lt;&#x3D; 1; ++k)</span><br><span class="line">          if (f[i][j][k] !&#x3D; A.f[i][j][k])</span><br><span class="line">            return f[i][j][k] &lt; A.f[i][j][k];</span><br><span class="line">    return 0;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;;</span><br><span class="line">map &lt;Status, int&gt; mp;</span><br><span class="line">queue &lt;Status&gt; q;</span><br><span class="line">int const MAXN &#x3D; 2005, mod &#x3D; 998244353;</span><br><span class="line">int child[MAXN][5];</span><br><span class="line">int f[2][405][MAXN];</span><br><span class="line">int tong[105];</span><br><span class="line">int length;</span><br><span class="line">LL frac[MAXN], invfrac[MAXN];</span><br><span class="line"></span><br><span class="line">LL qpow(LL a, LL k) &#123;</span><br><span class="line">  LL re &#x3D; 1;</span><br><span class="line">  for (; k; k &gt;&gt;&#x3D; 1, a &#x3D; a * a % mod)</span><br><span class="line">    if (k &amp; 1) re &#x3D; re * a % mod;</span><br><span class="line">  return re;</span><br><span class="line">&#125;</span><br><span class="line">void Init(int Max) &#123;</span><br><span class="line">  frac[0] &#x3D; 1;</span><br><span class="line">  for (RI i &#x3D; 1; i &lt;&#x3D; Max; ++i)</span><br><span class="line">    frac[i] &#x3D; frac[i - 1] * i % mod;</span><br><span class="line">  invfrac[Max] &#x3D; qpow(frac[Max], mod - 2);</span><br><span class="line">  for (RI i &#x3D; Max; i &gt;&#x3D; 1; --i)</span><br><span class="line">    invfrac[i - 1] &#x3D; invfrac[i] * i % mod;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">void GetStatus() &#123; &#x2F;&#x2F; 上文已经解释了</span><br><span class="line">  Status t, nxt;</span><br><span class="line">  int cnt &#x3D; 0;</span><br><span class="line">  q.push(t), mp[t] &#x3D; ++cnt;</span><br><span class="line">  while (t.cnt !&#x3D; -1) t.Trans(2);</span><br><span class="line">  mp[t] &#x3D; ++cnt;</span><br><span class="line">  for (RI i &#x3D; 0; i &lt;&#x3D; 4; ++i)</span><br><span class="line">    child[mp[t]][i] &#x3D; mp[t];</span><br><span class="line">  while (!q.empty()) &#123;</span><br><span class="line">    t &#x3D; q.front(); q.pop();</span><br><span class="line">    for (RI i &#x3D; 0; i &lt;&#x3D; 4; ++i) &#123;</span><br><span class="line">      nxt &#x3D; t, nxt.Trans(i);</span><br><span class="line">      if (mp.find(nxt) &#x3D;&#x3D; mp.end())</span><br><span class="line">        q.push(nxt), mp[nxt] &#x3D; ++cnt;</span><br><span class="line">      child[mp[t]][i] &#x3D; mp[nxt];</span><br><span class="line">    &#125;</span><br><span class="line">    if (cnt &gt; 100000) break; &#x2F;&#x2F; protection</span><br><span class="line">  &#125;</span><br><span class="line">  length &#x3D; mp.size();</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">inline void Add(int &amp;x, int y) &#123; x +&#x3D; y - mod; x +&#x3D; (x &gt;&gt; 31) &amp; mod; &#125;</span><br><span class="line"></span><br><span class="line">LL C[10][10];</span><br><span class="line"></span><br><span class="line">int main() &#123;</span><br><span class="line">  </span><br><span class="line">#ifdef LOCAL</span><br><span class="line">  FILEIO(&quot;a&quot;);</span><br><span class="line">#endif</span><br><span class="line"></span><br><span class="line">  GetStatus();</span><br><span class="line">  int n; cin &gt;&gt; n;</span><br><span class="line">  C[0][0] &#x3D; 1;</span><br><span class="line">  C[1][0] &#x3D; C[1][1] &#x3D; 1;</span><br><span class="line">  C[2][0] &#x3D; C[2][2] &#x3D; 1, C[2][1] &#x3D; 2;</span><br><span class="line">  C[3][0] &#x3D; C[3][3] &#x3D; 1, C[3][1] &#x3D; C[3][2] &#x3D; 3;</span><br><span class="line">  C[4][0] &#x3D; C[4][4] &#x3D; 1, C[4][1] &#x3D; C[4][3] &#x3D; 4, C[4][2] &#x3D; 6;</span><br><span class="line">  Init(4 * n);</span><br><span class="line">  for (RI i &#x3D; 1, x, y; i &lt;&#x3D; 13; ++i)</span><br><span class="line">    cin &gt;&gt; x &gt;&gt; y, ++tong[x];</span><br><span class="line">  int cur &#x3D; 0, nxt &#x3D; 1;</span><br><span class="line">  f[nxt][0][1] &#x3D; 1;</span><br><span class="line">  for (RI i &#x3D; 1; i &lt;&#x3D; n; ++i) &#123; &#x2F;&#x2F; 简单 DP</span><br><span class="line">    swap(cur, nxt);</span><br><span class="line">    memset(f[nxt], 0, sizeof(f[nxt]));</span><br><span class="line">    for (RI j &#x3D; 0; j &lt;&#x3D; 4 * (i - 1); ++j)</span><br><span class="line">      for (RI now &#x3D; 1; now &lt;&#x3D; length; ++now)</span><br><span class="line">        for (RI k &#x3D; tong[i]; k &lt;&#x3D; 4; ++k)</span><br><span class="line">          Add(f[nxt][j + k][child[now][k]], 1ll * f[cur][j][now] * C[4 - tong[i]][k - tong[i]] % mod);</span><br><span class="line">  &#125;</span><br><span class="line">  int ans &#x3D; 0;</span><br><span class="line">  for (RI i &#x3D; 14; i &lt;&#x3D; 4 * n; ++i)</span><br><span class="line">    for (RI j &#x3D; 1; j &lt;&#x3D; length; ++j)</span><br><span class="line">      if (j !&#x3D; 2)</span><br><span class="line">        Add(ans, 1ll * f[nxt][i][j] * frac[4 * n - i] % mod * frac[i - 13] % mod);</span><br><span class="line">  ans &#x3D; (1ll * ans * invfrac[4 * n - 13] % mod + 1) % mod;</span><br><span class="line">  cout &lt;&lt; ans &lt;&lt; endl;</span><br><span class="line"></span><br><span class="line">  return 0;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">&#x2F;&#x2F; created by Daniel yuan</span><br><span class="line">&#x2F;*</span><br><span class="line">     ________</span><br><span class="line">    &#x2F;        \</span><br><span class="line">   &#x2F; &#x2F;      \ \</span><br><span class="line">  &#x2F; &#x2F;        \ \</span><br><span class="line">  \            &#x2F;</span><br><span class="line">   \  ______  &#x2F;</span><br><span class="line">    \________&#x2F;</span><br><span class="line">*&#x2F;</span><br><span class="line"></span><br></pre></td></tr></table></figure><link rel="stylesheet" href="/css/spoiler.css" type="text/css"><script src="/js/spoiler.js" type="text/javascript" async></script>]]></content>
    
    
    <summary type="html">&lt;p&gt;首先对于已有的一堆牌，我们应该要能确定它能不能胡。&lt;/p&gt;
&lt;p&gt;这部分具体的可以参考&lt;a href=&quot;https://daniel-yuan.github.io/2021/01/19/%E9%BA%BB%E5%B0%86%E7%9B%B8%E5%85%B3/#more&quot;&gt;我的另一篇博客&lt;/a&gt;，顺带说一句，[ZJOI2019] 麻将的前置知识居然被拿去 [GXOI/GZOI2019] 出了个宝牌一大堆&lt;del&gt;，ZJOI 恐怖如斯&lt;/del&gt;。&lt;/p&gt;</summary>
    
    
    
    
    <category term="DP" scheme="http://example.com/tags/DP/"/>
    
    <category term="自动机" scheme="http://example.com/tags/%E8%87%AA%E5%8A%A8%E6%9C%BA/"/>
    
    <category term="DP of DP" scheme="http://example.com/tags/DP-of-DP/"/>
    
  </entry>
  
  <entry>
    <title>麻将相关</title>
    <link href="http://example.com/2021/01/19/%E9%BA%BB%E5%B0%86%E7%9B%B8%E5%85%B3/"/>
    <id>http://example.com/2021/01/19/%E9%BA%BB%E5%B0%86%E7%9B%B8%E5%85%B3/</id>
    <published>2021-01-19T13:39:20.000Z</published>
    <updated>2021-01-21T00:31:44.002Z</updated>
    
    <content type="html"><![CDATA[<p><del>不会打麻将的 OIer 不是好 ACMer。</del></p><p>虽然看完这篇博客你可能并不会变成雀神，但是你可能看到和麻将有关的题目就不会那么慌了。</p><a id="more"></a><p>麻将的一般规则本文就不再赘述，啥搜索引擎上都有。<del>实在不行下个雀魂玩玩也是可以的。</del></p><p>麻将题一般有两种做法：搜索和 DP。</p><h4 id="搜索">搜索：</h4><p>大多数时候是给出一副牌，看至少需要再摸几张牌才能胡。</p><p>考虑枚举合法终态，然后用牌数的差更新答案。</p><p>因为刻子和雀头都是多张同一个牌，所以这一块可以贪心，即从四张相同到一张相同的牌依次去匹配刻子和雀头，为了方便，可以设 <span class="math inline">\(dp_{i,j,k,l}\)</span> 表示有 <span class="math inline">\(i\)</span> 个四张，<span class="math inline">\(j\)</span> 个三张，<span class="math inline">\(k\)</span> 个二张拼成 <span class="math inline">\(l\)</span> 个面子加上一个雀头最少需要多少张牌，在搜索顺子的同时维护一下 <span class="math inline">\(i,j,k,l\)</span> 的值，然后直接更新答案即可。</p><p>然后考虑怎么搜索顺子，我们事先把所有的顺子预处理出来，共 <span class="math inline">\(27\)</span> 个，然后按层搜索枚举每个顺子有没有。这样复杂度是 <span class="math inline">\(O(27^4)\)</span>，显然不好。实际上，我们枚举的顺子在此刻至少要有两张牌存在于手牌中，因为如果只有一张，那么对额外牌数的贡献为 <span class="math inline">\(2\)</span>，而这张牌形成的刻子贡献的额外牌数也是 <span class="math inline">\(2\)</span>，这样可以把它算到刻子里面。</p><p>实际上这样优化下来判定是十分快的，博主认为其复杂度不会超过 <span class="math inline">\(10^4\)</span>。</p><h4 id="dp">DP：</h4><p>搜索写起来比较方便，但是搜索毕竟复杂度是指数级别的，它的速度还是慢了点，所以再介绍一种 DP 的做法。</p><p>依旧是考虑给出一副牌，看至少需要再摸几张牌才能胡。</p><p>设 <span class="math inline">\(f_{i,0/1/2,0/1/2,0/1/2/3/4,0/1}\)</span> 表示考虑前 <span class="math inline">\(i\)</span> 种牌，以 <span class="math inline">\(i-1\)</span> 开始的顺子有 <span class="math inline">\(0/1/2\)</span> 个，以 <span class="math inline">\(i\)</span> 开始的顺子有 <span class="math inline">\(0/1/2\)</span> 个，面子一共有 <span class="math inline">\(0/1/2/3/4\)</span> 个，有 <span class="math inline">\(0/1\)</span> 个雀头的最小花费。转移的时候枚举下一种牌有几张即可。后面一堆东西看似有 <span class="math inline">\(90\)</span> 个，但是实际上仅有 <span class="math inline">\(50+\)</span> 个，且转移的时候转移边数不会很多。如果在这个上面再用上【搜索中的优化】，效率会更加高。（似乎这里不太严谨，但是跑得很快就对了）</p><p>从这也可以衍生出判定一个牌的集合中存不存在一个胡牌子集的方法，即设 <span class="math inline">\(f_{i,0/1/2,0/1/2,0/1}\)</span> 表示考虑前 <span class="math inline">\(i\)</span> 种牌，以 <span class="math inline">\(i-1\)</span> 开始的顺子有 <span class="math inline">\(0/1/2\)</span> 个，以 <span class="math inline">\(i\)</span> 开始的顺子有 <span class="math inline">\(0/1/2\)</span> 个，有 <span class="math inline">\(0/1\)</span> 个雀头的最大面子数。如果有一个有雀头的状态的面子数到了 <span class="math inline">\(4\)</span>，那么就可行。</p><hr /><p>想必看完之后你就已经会打麻将了，<a href="https://www.luogu.com.cn/problem/P5279">[ZJOI2019] 麻将</a>和<a href="https://www.luogu.com.cn/problem/P5301">[GXOI/GZOI2019]宝牌一大堆</a>自然不在话下（其实后者真心就是只考了上述内容）。</p><link rel="stylesheet" href="/css/spoiler.css" type="text/css"><script src="/js/spoiler.js" type="text/javascript" async></script>]]></content>
    
    
    <summary type="html">&lt;p&gt;&lt;del&gt;不会打麻将的 OIer 不是好 ACMer。&lt;/del&gt;&lt;/p&gt;
&lt;p&gt;虽然看完这篇博客你可能并不会变成雀神，但是你可能看到和麻将有关的题目就不会那么慌了。&lt;/p&gt;</summary>
    
    
    
    
    <category term="DP" scheme="http://example.com/tags/DP/"/>
    
    <category term="搜索" scheme="http://example.com/tags/%E6%90%9C%E7%B4%A2/"/>
    
  </entry>
  
  <entry>
    <title>[ZJOI2019]开关 题解</title>
    <link href="http://example.com/2021/01/19/ZJOI2019-%E5%BC%80%E5%85%B3-%E9%A2%98%E8%A7%A3/"/>
    <id>http://example.com/2021/01/19/ZJOI2019-%E5%BC%80%E5%85%B3-%E9%A2%98%E8%A7%A3/</id>
    <published>2021-01-19T03:43:46.000Z</published>
    <updated>2021-01-19T08:50:34.645Z</updated>
    
    <content type="html"><![CDATA[<p>把初始状态和目标状态交换，题目不变。</p><p>为了方便，设 <span class="math inline">\(p_i\)</span> 为 <span class="math inline">\(i\)</span> 被选的概率，对应到输入即 <span class="math inline">\(\frac{p_i}{\sum_{j=1}^n p_j}\)</span> 。</p><p>设 <span class="math inline">\(f(S)\)</span> 表示从 <span class="math inline">\(S\)</span> 状态开始，期望走 <span class="math inline">\(f(S)\)</span> 步到达全零状态。为了方便，我们定义 <span class="math inline">\(\varnothing\)</span> 表示全零状态。</p><p>那么显然有<a id="more"></a> <span class="math inline">\(f(S)=\begin{cases}0&amp;S=\varnothing\\1+\sum p_if_{S \text{ xor } i}&amp;S\not=\varnothing\end{cases}\)</span>。</p><p>如果把 <span class="math inline">\(f(S)\)</span> 看做是集合幂级数 <span class="math inline">\(F=\sum_S f(S)x^S\)</span>，下半部分的 <span class="math inline">\(\sum\)</span> 可以看做是一个异或卷积（更多有关位运算的卷积，可以参考<a href="https://daniel-yuan.github.io/2021/01/19/FWT-%E5%B0%8F%E7%BB%93/#more">我的另一篇博客</a>），那么我们设另一个集合幂级数 <span class="math inline">\(G=\sum_S g(S)x^S\)</span>，其中 <span class="math inline">\(g(S)\)</span> 在 <span class="math inline">\(S\)</span> 中仅含一个元素 <span class="math inline">\(k\)</span> 的时候为 <span class="math inline">\(p_k\)</span>，否则为 <span class="math inline">\(0\)</span>。那么下半部分的 <span class="math inline">\(\sum\)</span> 就可以看做是 <span class="math inline">\(F*G\)</span>。</p><p>不看 <span class="math inline">\(\varnothing\)</span>，我们有 <span class="math inline">\(F*G+1=F\)</span>，即 <span class="math inline">\(F*(G-1)=-1\)</span>，为了方便，把 <span class="math inline">\(g(S)\)</span> 做一个微调，即 <span class="math inline">\(g(S)=\begin{cases}-1&amp;S=\varnothing\\p_i&amp;|S|=1,S\text{ 中的元素为 }i\\0&amp;|S|&gt;1\end{cases}\)</span>。这样在不考虑 <span class="math inline">\(\varnothing\)</span> 的时候，<span class="math inline">\(F*G=-1\)</span>。</p><p>考虑 <span class="math inline">\(F*G\)</span> 的 <span class="math inline">\(\varnothing\)</span> 项是什么，我们可以知道 <span class="math inline">\(\sum_i(F*G)(i)=\sum_{i,j} F(i)G(j)\)</span>，因为 <span class="math inline">\(\sum_iG(i)=0\)</span>，所以右边为 <span class="math inline">\(0\)</span>，所以 <span class="math inline">\(\sum_i(F*G)(i)=0\)</span>，所以可以推出 <span class="math inline">\((F*G)(\varnothing)=2^n-1\)</span>。</p><p>设 <span class="math inline">\(H=F*G\)</span>，那么就有 <span class="math inline">\(h(S)=\begin{cases}2^n-1&amp;S=\varnothing\\-1&amp;S\not=\varnothing\end{cases}\)</span>。</p><p><span class="math inline">\(G,H\)</span> 我们都知道，考虑反推 <span class="math inline">\(F\)</span>。</p><p>设 <span class="math inline">\(FWTX\)</span> 为集合幂级数 <span class="math inline">\(X\)</span> 在 <span class="math inline">\(FWT\)</span> 之后的结果。根据异或卷积 <span class="math inline">\(FWT\)</span> 的公式（在上面给出的博客有详细介绍）<span class="math inline">\(F(i)=\sum_j(-1)^{|i\text{ and }j|}F(j)\)</span>，不难得到 <span class="math inline">\(FWTG(S)=\begin{cases}0&amp;S=\varnothing\\\sum_{|T|=1}(-1)^{|S\text{ and T|}}p-1&amp;S\not=\varnothing\end{cases}\)</span>，<span class="math inline">\(FWTH(S)=\begin{cases}0&amp;S=\varnothing\\2^n&amp;S\not=\varnothing\end{cases}\)</span>。对于前者，就是照搬式子，然后在 <span class="math inline">\(S=\varnothing\)</span> 处特别展开一下。对于后者，<span class="math inline">\(S=\varnothing\)</span> 的部分是 <span class="math inline">\(H(S)\)</span> 全部相加显然为 <span class="math inline">\(0\)</span>，而其它位置，对 <span class="math inline">\(FWTH(S)\)</span> 贡献为正的 <span class="math inline">\(H(S)\)</span> 和负的 <span class="math inline">\(H(S)\)</span> 应该各占一半，而 <span class="math inline">\(H(\varnothing)\)</span> 的贡献为正，那么剩下的部分相加就应该是 <span class="math inline">\((-1)\times(-1)\)</span>，再加上 <span class="math inline">\(H(\varnothing)\)</span> 就为 <span class="math inline">\(2^n\)</span>。</p><p>那么我们可以很轻易的得到，在 <span class="math inline">\(S\not=\varnothing\)</span> 时， <span class="math inline">\(FWTF(S)=\frac{2^n}{\sum_{|T|=1}(-1)^{|S\text{ and T|}}p-1}\)</span>，而当 <span class="math inline">\(S=\varnothing\)</span> 的时候，<span class="math inline">\(FWTF(S)\)</span> 用除法求就 <span class="math inline">\(\text{nan}\)</span> 了，所以需要特别处理。</p><p>考虑在 <span class="math inline">\(\sum_SFWTF(S)\)</span> 中每个 <span class="math inline">\(F(S)\)</span> 的贡献，假设 <span class="math inline">\(|S|=X\)</span>，枚举 <span class="math inline">\(|S \text{ and } T|\)</span>，那么就有 <span class="math inline">\(\sum_k(-1)^kC_X^k2^{n-X}=2^{n-X}[X=0]\)</span>，其中 <span class="math inline">\(C_x^y\)</span> 表示组合数（后同）。所以 <span class="math inline">\(\sum_S FWTF(S)=2^nF(\varnothing)\)</span>，而上文有 <span class="math inline">\(F(\varnothing)=0\)</span>，所以 <span class="math inline">\(\sum_S FWTF(S)=0\)</span>。所以 <span class="math inline">\(FWTF(\varnothing)\)</span> 就是 <span class="math inline">\(-\sum_{S\not=\varnothing}FWTF(S)\)</span>。</p><p>根据上面推导，我们也可以知道 <span class="math inline">\(F(S)=\frac{1}{2^n}\sum_T(-1)^{|S\text{ and }T|}FWTF(T)\)</span>。（原理也是 <span class="math inline">\(\sum_k(-1)^kC_X^k=[X=0]\)</span>）。</p><p>把 <span class="math inline">\(\varnothing\)</span> 单独考虑，那么就有 <span class="math inline">\(F(S)=\sum_{T\not=\varnothing}(\frac{1}{1-\sum_{|U|=1}(-1)^{|U\text{ and }T|}p}-(-1)^{|S\text{ and }T|}\frac{1}{1-\sum_{|U|=1}(-1)^{|U\text{ and }T|}p})\)</span>。</p><p>把左右相抵的去掉，稍加整理，有 <span class="math inline">\(F(S)=\sum_{(-1)^{T\text{ and } S}=-1}\frac{2}{2\sum_{|U|=1}p[|U\text{ and }T|=1]}\)</span>。</p><p>最后就是一个简单 DP 了<del>（不会吧不会吧，推到这里还不会 DP？）</del>。</p><p>设 <span class="math inline">\(dp_{i,j,0/1}\)</span> 表示前 <span class="math inline">\(i\)</span> 个开关，分子总和为 <span class="math inline">\(j\)</span>，交的奇偶性为 <span class="math inline">\(0/1\)</span> 的方案数。转移显然，总复杂度 <span class="math inline">\(O(n\sum p)\)</span>。</p><p>贴个代码。</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> debug(...) fprintf(stderr, __VA_ARGS__)</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> RI register int</span></span><br><span class="line"><span class="keyword">typedef</span> <span class="keyword">long</span> <span class="keyword">long</span> LL;</span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> FILEIO(name) freopen(name<span class="meta-string">&quot;.in&quot;</span>, <span class="meta-string">&quot;r&quot;</span>, stdin), freopen(name<span class="meta-string">&quot;.out&quot;</span>, <span class="meta-string">&quot;w&quot;</span>, stdout);</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> <span class="keyword">const</span> mod = <span class="number">998244353</span>;</span><br><span class="line"><span class="keyword">int</span> <span class="keyword">const</span> MAXN = <span class="number">105</span>;</span><br><span class="line"><span class="keyword">int</span> p[MAXN], s[MAXN], sum[MAXN];</span><br><span class="line"><span class="keyword">int</span> f[MAXN][<span class="number">50005</span>][<span class="number">2</span>];</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">void</span> <span class="title">Add</span><span class="params">(<span class="keyword">int</span> &amp;x, <span class="keyword">int</span> y)</span> </span>&#123; x += y - mod; x += (x &gt;&gt; <span class="number">31</span>) &amp; mod; &#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">qpow</span><span class="params">(<span class="keyword">int</span> a, <span class="keyword">int</span> k)</span> </span>&#123;</span><br><span class="line">  <span class="keyword">int</span> re = <span class="number">1</span>;</span><br><span class="line">  <span class="keyword">for</span> (; k; k &gt;&gt;= <span class="number">1</span>, a = <span class="number">1l</span>l * a * a % mod)</span><br><span class="line">    <span class="keyword">if</span> (k &amp; <span class="number">1</span>) re = <span class="number">1l</span>l * re * a % mod;</span><br><span class="line">  <span class="keyword">return</span> re;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">  </span><br><span class="line"><span class="meta">#<span class="meta-keyword">ifdef</span> LOCAL</span></span><br><span class="line">  FILEIO(<span class="string">&quot;a&quot;</span>);</span><br><span class="line"><span class="meta">#<span class="meta-keyword">endif</span></span></span><br><span class="line"></span><br><span class="line">  <span class="keyword">int</span> n; <span class="built_in">cin</span> &gt;&gt; n;</span><br><span class="line">  <span class="keyword">for</span> (RI i = <span class="number">1</span>; i &lt;= n; ++i)</span><br><span class="line">    <span class="built_in">cin</span> &gt;&gt; s[i];</span><br><span class="line">  <span class="keyword">for</span> (RI i = <span class="number">1</span>; i &lt;= n; ++i)</span><br><span class="line">    <span class="built_in">cin</span> &gt;&gt; p[i], sum[i] = sum[i - <span class="number">1</span>] + p[i];</span><br><span class="line">  f[<span class="number">0</span>][<span class="number">0</span>][<span class="number">0</span>] = <span class="number">1</span>;</span><br><span class="line">  <span class="keyword">for</span> (RI i = <span class="number">1</span>; i &lt;= n; ++i) &#123;</span><br><span class="line">    <span class="keyword">for</span> (RI j = p[i]; j &lt;= sum[i]; ++j) &#123;</span><br><span class="line">      Add(f[i][j][<span class="number">0</span>], f[i - <span class="number">1</span>][j - p[i]][<span class="number">0</span> ^ s[i]]);</span><br><span class="line">      Add(f[i][j][<span class="number">1</span>], f[i - <span class="number">1</span>][j - p[i]][<span class="number">1</span> ^ s[i]]);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">for</span> (RI j = <span class="number">0</span>; j &lt;= sum[i]; ++j) &#123;</span><br><span class="line">      Add(f[i][j][<span class="number">0</span>], f[i - <span class="number">1</span>][j][<span class="number">0</span>]);</span><br><span class="line">      Add(f[i][j][<span class="number">1</span>], f[i - <span class="number">1</span>][j][<span class="number">1</span>]);</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">int</span> ans = <span class="number">0</span>;</span><br><span class="line">  <span class="keyword">for</span> (RI i = <span class="number">0</span>; i &lt;= sum[n]; ++i)</span><br><span class="line">    Add(ans, <span class="number">1l</span>l * sum[n] * f[n][i][<span class="number">1</span>] % mod * qpow(i, mod - <span class="number">2</span>) % mod);</span><br><span class="line">  <span class="built_in">cout</span> &lt;&lt; ans &lt;&lt; <span class="built_in">endl</span>;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// created by Daniel yuan</span></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">     ________</span></span><br><span class="line"><span class="comment">    /        \</span></span><br><span class="line"><span class="comment">   / /      \ \</span></span><br><span class="line"><span class="comment">  / /        \ \</span></span><br><span class="line"><span class="comment">  \            /</span></span><br><span class="line"><span class="comment">   \  ______  /</span></span><br><span class="line"><span class="comment">    \________/</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"></span><br></pre></td></tr></table></figure><link rel="stylesheet" href="/css/spoiler.css" type="text/css"><script src="/js/spoiler.js" type="text/javascript" async></script>]]></content>
    
    
    <summary type="html">&lt;p&gt;把初始状态和目标状态交换，题目不变。&lt;/p&gt;
&lt;p&gt;为了方便，设 &lt;span class=&quot;math inline&quot;&gt;\(p_i\)&lt;/span&gt; 为 &lt;span class=&quot;math inline&quot;&gt;\(i\)&lt;/span&gt; 被选的概率，对应到输入即 &lt;span class=&quot;math inline&quot;&gt;\(\frac{p_i}{\sum_{j=1}^n p_j}\)&lt;/span&gt; 。&lt;/p&gt;
&lt;p&gt;设 &lt;span class=&quot;math inline&quot;&gt;\(f(S)\)&lt;/span&gt; 表示从 &lt;span class=&quot;math inline&quot;&gt;\(S\)&lt;/span&gt; 状态开始，期望走 &lt;span class=&quot;math inline&quot;&gt;\(f(S)\)&lt;/span&gt; 步到达全零状态。为了方便，我们定义 &lt;span class=&quot;math inline&quot;&gt;\(\varnothing\)&lt;/span&gt; 表示全零状态。&lt;/p&gt;
&lt;p&gt;那么显然有</summary>
    
    
    
    
    <category term="FWT" scheme="http://example.com/tags/FWT/"/>
    
    <category term="多项式" scheme="http://example.com/tags/%E5%A4%9A%E9%A1%B9%E5%BC%8F/"/>
    
    <category term="期望概率" scheme="http://example.com/tags/%E6%9C%9F%E6%9C%9B%E6%A6%82%E7%8E%87/"/>
    
  </entry>
  
  <entry>
    <title>FWT 小结</title>
    <link href="http://example.com/2021/01/19/FWT-%E5%B0%8F%E7%BB%93/"/>
    <id>http://example.com/2021/01/19/FWT-%E5%B0%8F%E7%BB%93/</id>
    <published>2021-01-19T00:58:42.000Z</published>
    <updated>2021-01-21T01:19:24.268Z</updated>
    
    <content type="html"><![CDATA[<p>FWT 是快速求形如 <span class="math inline">\(C(x)=\sum_{i?j=x}A(i)B(j)\)</span> 的算法，其中 <span class="math inline">\(?\)</span> 表示一种二进制的位运算。</p><a id="more"></a><h4 id="原理">原理</h4><p>其实 FWT 背板挺容易的，但是因为考试趋向越来越本质化，所以我们要逐渐开始了解一些原来背板算法的原理。</p><p>类似于 FFT，我们考虑从最本源的地方来了解 FWT——构造一种线性变换 <span class="math inline">\(A\rightarrow A&#39;\)</span>，使得 <span class="math inline">\(C&#39;(x)=A&#39;(x)B&#39;(x)\)</span>，这样去掉线性变换的复杂度，总复杂度是 <span class="math inline">\(O(len)\)</span> 的。需要注意的是，这里的 <span class="math inline">\(A,B,C\)</span> 需要做同一种线性变换。</p><p>因为我们所做的是线性变换（即只存在加减），那么在 <span class="math inline">\(A&#39;\)</span> 中，我们可以把 <span class="math inline">\(A\)</span> 中每个数对它的贡献用一个系数表示，即 <span class="math inline">\(A&#39;(x)=\sum_i f(x,i)A(i)\)</span>。</p><p>那么 <span class="math inline">\(C&#39;(x)=\sum_i f(x,i)C(i)=\sum_if(x,i)\sum_{j?k=i}A(j)B(k)\)</span>，<span class="math inline">\(A&#39;(x)B&#39;(x)=\sum_if(x,i)A(i)\sum_jf(x,j)B(j)\)</span>。整理得 <span class="math inline">\(\sum_i\sum_jf(x,i?j)A(i)B(j)=\sum_i\sum_jf(x,i)f(x,j)A(i)B(j)\)</span>。故有 <span class="math inline">\(f(x,i?j)=f(x,i)f(x,j)\)</span>。</p><p>也就是说我们需要构造 <span class="math inline">\(f(x,i)\)</span>，使得它满足上述需求。</p><p>对于或操作，有 <span class="math inline">\(f(x,i \text{ or }j)=f(x,i)f(x,j)\)</span>，不难发现 <span class="math inline">\(i\text{ or }j\in x\Leftrightarrow i\in x\land j\in x\)</span>，那么设 <span class="math inline">\(f(x,i)=[i\in x]\)</span> 即可。</p><p>对于与操作，有 <span class="math inline">\(f(x,i\text{ and }j)=f(x,i)f(x,j)\)</span>，和或相似的，<span class="math inline">\(x\in i\text{ and }j\Leftrightarrow x\in i\land x\in j\)</span>。<span class="math inline">\(f(x,i)=[x\in i]\)</span>。</p><p>对于异或操作，这可能就有些麻烦。我们需要挖掘一些异或的性质。对于两个数 <span class="math inline">\(x,y\)</span>，显然 <span class="math inline">\(x\)</span> 的 <span class="math inline">\(1\)</span> 的个数加上 <span class="math inline">\(y\)</span> 的 <span class="math inline">\(1\)</span> 的个数的奇偶性和 <span class="math inline">\(x \text{ xor } y\)</span> 的相同。而与和异或有恒等式 <span class="math inline">\((x\text{ xor } y)\text{ and } z=(x\text{ and }z)\text{ xor }(y\text{ and }z)\)</span>（不难证明），所以 <span class="math inline">\(i\text{ and }x\)</span> 的 <span class="math inline">\(1\)</span> 的个数加上 <span class="math inline">\(j\text{ and }x\)</span> 的 <span class="math inline">\(1\)</span> 的个数的奇偶性和 <span class="math inline">\((i\text{ and }x)\text{ xor }(j\text{ and }x)=(i\text{ xor } j)\text{ and } x\)</span> 的相同，而奇偶性的区分加减我们一般用 <span class="math inline">\((-1)^k\)</span> ，所以设 <span class="math inline">\(f(x,i)=(-1)^{|x \text { and }i|}\)</span> 即可。</p><h4 id="实现">实现</h4><p>下面只讨论 FWT，对于 IFWT，其就是 FWT 的逆向过程。</p><p>考虑按位计算贡献。</p><p>设 <span class="math inline">\(f_k(S)\)</span> 表示对于 <span class="math inline">\(S\)</span>，已经计算了前 <span class="math inline">\(k\)</span> 位任意，后面位数严格和 <span class="math inline">\(S\)</span> 相等且暂未考虑其对贡献的影响的贡献。考虑从 <span class="math inline">\(f_k(S)\)</span> 推到 <span class="math inline">\(f_{k+1}(S)\)</span>。</p><p>考虑每个数对 <span class="math inline">\(u,v\)</span> 互相的贡献，其中 <span class="math inline">\(u,v\)</span> 仅在第 <span class="math inline">\(k+1\)</span> 位不同，为了方便，设 <span class="math inline">\(u&lt;v\)</span>。</p><p>对于或，<span class="math inline">\(f_k(u)\)</span> 中存的是后面位数和 <span class="math inline">\(u\)</span> 相等，<span class="math inline">\(1\sim k\)</span> 位是 <span class="math inline">\(u\)</span> 子集的数的贡献，<span class="math inline">\(f_k(v)\)</span> 同理，那么显然考虑了第 <span class="math inline">\(k+1\)</span> 位后，<span class="math inline">\(f_{k+1}(u)=f_k(u)\)</span> ，<span class="math inline">\(f_{k+1}(v)=f_k(u)+f_k(v)\)</span>。</p><p>类似的，对于与，<span class="math inline">\(f_{k+1}(u)=f_k(u)+f_k(v)\)</span> ，<span class="math inline">\(f_{k+1}(v)=f_k(v)\)</span>。</p><p>对于异或，<span class="math inline">\(u\)</span> 在 <span class="math inline">\(k+1\)</span> 位对数的符号没有影响，而 <span class="math inline">\(v\)</span> 在 <span class="math inline">\(k+1\)</span> 位对 <span class="math inline">\(k+1\)</span> 位为 <span class="math inline">\(1\)</span> 的数的符号有一个 <span class="math inline">\(-1\)</span> 的影响（因为之前没有考虑这一位对答案贡献的影响），所以 <span class="math inline">\(f_{k+1}(u)=f_k(u)+f_k(v)\)</span>，<span class="math inline">\(f_{k+1}(v)=f_k(u)-f_k(v)\)</span>。</p><p>这样就能在 <span class="math inline">\(O(len\log len)\)</span> 的时间内对于 <span class="math inline">\(A\)</span> 求得 <span class="math inline">\(A&#39;\)</span>。而逆变化就是正变化的相反操作，在此就不再赘述。</p><link rel="stylesheet" href="/css/spoiler.css" type="text/css"><script src="/js/spoiler.js" type="text/javascript" async></script>]]></content>
    
    
    <summary type="html">&lt;p&gt;FWT 是快速求形如 &lt;span class=&quot;math inline&quot;&gt;\(C(x)=\sum_{i?j=x}A(i)B(j)\)&lt;/span&gt; 的算法，其中 &lt;span class=&quot;math inline&quot;&gt;\(?\)&lt;/span&gt; 表示一种二进制的位运算。&lt;/p&gt;</summary>
    
    
    
    
    <category term="FWT" scheme="http://example.com/tags/FWT/"/>
    
    <category term="多项式" scheme="http://example.com/tags/%E5%A4%9A%E9%A1%B9%E5%BC%8F/"/>
    
  </entry>
  
</feed>
